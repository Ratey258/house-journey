import{c as pt,d as ce}from"./vue-core-cd9800c2.js";import{a as ie,b6 as ft,e as $}from"./vendor-e7c44fa3.js";const gt="modulepreload",ht=function(e,t){return new URL(e,t).href},Qe={},yt=function(t,r,i){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=ht(o,i),o in Qe)return;Qe[o]=!0;const n=o.endsWith(".css"),a=n?'[rel="stylesheet"]':"";if(!!i)for(let g=s.length-1;g>=0;g--){const m=s[g];if(m.href===o&&(!n||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const u=document.createElement("link");if(u.rel=n?"stylesheet":gt,n||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),n)return new Promise((g,m)=>{u.addEventListener("load",g),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o})},L={VALIDATION:"validation",NETWORK:"network",STORAGE:"storage",GAME_LOGIC:"gameLogic",SYSTEM:"system",UNKNOWN:"unknown"},_={FATAL:"fatal",ERROR:"error",WARNING:"warning",INFO:"info"};function vt(e,t=L.UNKNOWN,r=_.ERROR,i={}){const s=new Error(e);return s.type=t,s.severity=r,s.metadata=i,s.timestamp=new Date().toISOString(),s}function He(e,t={}){return vt(e,L.STORAGE,_.ERROR,t)}const Et={common:{confirm:"ç¡®è®¤",cancel:"å–æ¶ˆ",back:"è¿”å›",save:"ä¿å­˜",delete:"åˆ é™¤",loading:"åŠ è½½ä¸­...",yes:"æ˜¯",no:"å¦",ok:"ç¡®å®š",next:"ä¸‹ä¸€æ­¥",previous:"ä¸Šä¸€æ­¥",close:"å…³é—­",edit:"ç¼–è¾‘",create:"åˆ›å»º",update:"æ›´æ–°",remove:"ç§»é™¤",search:"æœç´¢",filter:"ç­›é€‰",sort:"æ’åº",refresh:"åˆ·æ–°",retry:"é‡è¯•",more:"æ›´å¤š"},time:{week:"ç¬¬{week}å‘¨",weeks:"{count}å‘¨",of:"/",remaining:"å‰©ä½™: {weeks}å‘¨",day:"å¤©",hour:"å°æ—¶",minute:"åˆ†é’Ÿ",second:"ç§’"},system:{defaultPlayerName:"ç©å®¶",autoSave:"è‡ªåŠ¨å­˜æ¡£",unknownError:"å‘ç”ŸæœªçŸ¥é”™è¯¯",criticalError:"å‘ç”Ÿä¸¥é‡é”™è¯¯",componentError:"ç»„ä»¶é”™è¯¯",retry:"é‡è¯•",errorLogs:"é”™è¯¯æ—¥å¿—",exportLogs:"å¯¼å‡ºæ—¥å¿—",clearLogs:"æ¸…ç©ºæ—¥å¿—",severity:"ä¸¥é‡ç¨‹åº¦",type:"ç±»å‹",search:"æœç´¢"},currency:"å…ƒ",settings:{title:"æ¸¸æˆè®¾ç½®",game:"æ¸¸æˆè®¾ç½®",display:"æ˜¾ç¤ºè®¾ç½®",audio:"éŸ³é¢‘è®¾ç½®",language:"è¯­è¨€",difficulty:"æ¸¸æˆéš¾åº¦",difficulties:{easy:"ç®€å•",standard:"æ ‡å‡†",hard:"å›°éš¾"},autoSaveInterval:"è‡ªåŠ¨ä¿å­˜é—´éš”",autoSaveIntervals:{1:"æ¯å‘¨",2:"æ¯2å‘¨",5:"æ¯5å‘¨",10:"æ¯10å‘¨"},soundEnabled:"æ¸¸æˆéŸ³æ•ˆ",fullScreen:"å…¨å±æ¨¡å¼",textSpeed:"æ–‡æœ¬é€Ÿåº¦",textSpeeds:{slow:"æ…¢é€Ÿ",normal:"æ­£å¸¸",fast:"å¿«é€Ÿ"},reset:"æ¢å¤é»˜è®¤è®¾ç½®",saveSuccess:"è®¾ç½®å·²ä¿å­˜",resetSuccess:"è®¾ç½®å·²é‡ç½®",description:{difficulty:"è°ƒæ•´æ¸¸æˆçš„æ•´ä½“éš¾åº¦ï¼Œå½±å“ä»·æ ¼æ³¢åŠ¨ã€äº‹ä»¶è§¦å‘æ¦‚ç‡ç­‰",autoSave:"è®¾ç½®æ¸¸æˆè‡ªåŠ¨ä¿å­˜çš„é¢‘ç‡",sound:"å¯ç”¨æˆ–ç¦ç”¨æ¸¸æˆéŸ³æ•ˆ",fullScreen:"ä»¥å…¨å±æ¨¡å¼è¿è¡Œæ¸¸æˆ",textSpeed:"è°ƒæ•´å¯¹è¯å’Œæç¤ºæ–‡æœ¬çš„æ˜¾ç¤ºé€Ÿåº¦",language:"é€‰æ‹©æ¸¸æˆç•Œé¢è¯­è¨€"}},game:{title:"ä¹°æˆ¿è®°",week:"å‘¨æ•°",menu:"èœå•",nextWeek:"è¿›å…¥ä¸‹ä¸€å‘¨",tabs:{market:"å¸‚åœº",inventory:"èƒŒåŒ…",houses:"æˆ¿å±‹"},marketStatus:{bull:"ä¸Šæ¶¨(ç‰›å¸‚)",bear:"ä¸‹è·Œ(ç†Šå¸‚)",stable:"ç¨³å®š",mixed:"æ··åˆ"}},gameMenu:{title:"æ¸¸æˆèœå•",save:"ä¿å­˜æ¸¸æˆ",load:"è¯»å–æ¸¸æˆ",mainMenu:"è¿”å›ä¸»èœå•",settings:"è®¾ç½®",continue:"ç»§ç»­æ¸¸æˆ"},saveDialog:{title:"ä¿å­˜æ¸¸æˆ",namePlaceholder:"è¾“å…¥å­˜æ¡£åç§°"},gameOver:{title:"æ¸¸æˆç»“æŸ",victory:"æ­å–œï¼ä½ æˆåŠŸè´­ä¹°äº†è±ªå®…ï¼",houseVictory:"æ­å–œï¼ä½ å·²è´­ä¹°æˆ¿äº§ï¼Œå®Œæˆæ¸¸æˆä¸»è¦ç›®æ ‡ï¼",timeLimit:"æ—¶é—´å·²åˆ°ï¼",weeksPlayed:"æ¸¸æˆå‘¨æ•°",finalMoney:"æœ€ç»ˆèµ„é‡‘",netWorth:"å‡€èµ„äº§",purchasedHouses:"å·²è´­æˆ¿å±‹",backToMenu:"è¿”å›ä¸»èœå•",continueGame:"ç»§ç»­æ¸¸æˆ",continueDescription:"ä½ å¯ä»¥é€‰æ‹©ç»§ç»­æ¸¸æˆï¼Œç›´åˆ°ç¬¬52å‘¨ç»“æŸï¼Œæˆ–æŸ¥çœ‹å½“å‰æˆç»©",restartGame:"é‡æ–°å¼€å§‹"},recovery:{title:"æ¸¸æˆæ¢å¤",defaultMessage:"æ£€æµ‹åˆ°æ¸¸æˆæ„å¤–ä¸­æ–­ã€‚æˆ‘ä»¬æ‰¾åˆ°äº†æ‚¨çš„æ¸¸æˆè¿›åº¦ï¼Œæ˜¯å¦æ¢å¤ï¼Ÿ",date:"æ—¥æœŸ",gameWeek:"æ¸¸æˆå‘¨",weekNumber:"ç¬¬ {week} å‘¨",playerName:"ç©å®¶åç§°",money:"èµ„é‡‘",recover:"æ¢å¤æ¸¸æˆ",cancel:"æ”¾å¼ƒæ¢å¤",success:"æ¸¸æˆçŠ¶æ€å·²æˆåŠŸæ¢å¤",failed:"æ— æ³•æ¢å¤æ¸¸æˆçŠ¶æ€",noSnapshot:"æ²¡æœ‰å¯ç”¨çš„æ¢å¤ç‚¹",automaticRecovery:"æ¸¸æˆå°†å°è¯•è‡ªåŠ¨æ¢å¤æ‚¨çš„è¿›åº¦",currency:"å…ƒ"},inventory:{title:"èƒŒåŒ…",capacityUsed:"å®¹é‡: {used}/{total}",productName:"å•†å“åç§°",quantity:"æ•°é‡",purchasePrice:"è´­ä¹°ä»·",currentPrice:"å½“å‰ä»·",trend:"è¶‹åŠ¿",profit:"ç›ˆäº",action:"æ“ä½œ",sell:"å‡ºå”®",empty:"èƒŒåŒ…ç©ºç©ºå¦‚ä¹Ÿ",full:"èƒŒåŒ…å·²æ»¡",almostFull:"èƒŒåŒ…å³å°†è£…æ»¡"}},bt={market:{title:"{location}",selectLocation:"é€‰æ‹©åœ°ç‚¹",productName:"å•†å“åç§°",price:"ä»·æ ¼",trend:"è¶‹åŠ¿",change:"æ¶¨è·Œ",action:"æ“ä½œ",buy:"è´­ä¹°",noProducts:"å½“å‰åœ°ç‚¹æ²¡æœ‰å¯è´­ä¹°çš„å•†å“",special:"ç‰¹ä»·å•†å“",viewMode:{table:"è¡¨æ ¼è§†å›¾",card:"å¡ç‰‡è§†å›¾"},priceHistory:"ä»·æ ¼å†å²",priceChart:{title:"ä»·æ ¼èµ°åŠ¿å›¾",weeks:"å‘¨æ•°",price:"ä»·æ ¼",high:"æœ€é«˜ä»·",low:"æœ€ä½ä»·",average:"å¹³å‡ä»·",currentPrice:"å½“å‰ä»·æ ¼",historicalPrices:"å†å²ä»·æ ¼",priceRange:"ä»·æ ¼åŒºé—´",weekRange:"å‘¨æ•°åŒºé—´",noData:"æš‚æ— ä»·æ ¼æ•°æ®"},filter:{all:"å…¨éƒ¨å•†å“",special:"ç‰¹ä»·å•†å“",rising:"ä¸Šæ¶¨å•†å“",falling:"ä¸‹è·Œå•†å“",stable:"ç¨³å®šå•†å“"},sort:{default:"é»˜è®¤æ’åº",priceAsc:"ä»·æ ¼ä»ä½åˆ°é«˜",priceDesc:"ä»·æ ¼ä»é«˜åˆ°ä½",changeAsc:"æ¶¨å¹…ä»ä½åˆ°é«˜",changeDesc:"æ¶¨å¹…ä»é«˜åˆ°ä½",nameAsc:"åç§°æ­£åº",nameDesc:"åç§°å€’åº"},location:{travel:"å‰å¾€",currentLocation:"å½“å‰åœ°ç‚¹",travelCost:"æ—…è¡Œè´¹ç”¨",travelTime:"æ—…è¡Œæ—¶é—´",travelConfirm:"ç¡®è®¤å‰å¾€{location}å—ï¼Ÿ",travelSuccess:"ä½ å·²åˆ°è¾¾{location}",second_hand_market:"äºŒæ‰‹å¸‚åœº",premium_mall:"é«˜ç«¯å•†åŸ",electronics_hub:"ç”µå­ç§‘æŠ€åŸ",black_market:"åœ°ä¸‹é»‘å¸‚",commodity_market:"å¤§å®—å•†å“äº¤æ˜“æ‰€",second_hand_market_desc:"å„ç±»äºŒæ‰‹ç‰©å“å’Œä½ä»·ç”Ÿæ´»å¿…éœ€å“çš„é›†æ•£åœ°ï¼Œä»·æ ¼ä¾¿å®œä½†å“è´¨å‚å·®ä¸é½",premium_mall_desc:"æ±‡èšå„ç±»é«˜ç«¯å“ç‰Œå’Œå¥¢ä¾ˆå“çš„è´­ç‰©ä¸­å¿ƒï¼Œä»·æ ¼æ˜‚è´µä½†å“è´¨ä¼˜è‰¯",electronics_hub_desc:"å„ç±»ç”µå­äº§å“å’Œæ•°ç è®¾å¤‡çš„ä¸“ä¸šäº¤æ˜“å¸‚åœºï¼Œä»·æ ¼é€‚ä¸­ä¸”å“ç§é½å…¨",black_market_desc:"éšè”½çš„éæ³•äº¤æ˜“åœºæ‰€ï¼Œå„ç±»çç¨€æ”¶è—å“å’Œå¥‡ç‰¹å•†å“äº‘é›†ï¼Œé£é™©ä¸æœºé‡å¹¶å­˜",commodity_market_desc:"æ‰¹å‘å¸‚åœºå’Œå¤§å®—å•†å“äº¤æ˜“çš„é›†ä¸­åœ°ï¼Œä»·æ ¼ä½å»‰ä½†éœ€è¦å¤§é‡é‡‡è´­"},houseMarket:{title:"æˆ¿äº§å¸‚åœº",affordable:"å¯è´­ä¹°",purchased:"å·²è´­ä¹°",alreadyOwned:"å·²æ‹¥æœ‰",price:"ä»·æ ¼",level:"ç­‰çº§",size:"é¢ç§¯",location:"ä½ç½®",buyButton:"è´­ä¹°",noHouses:"æ²¡æœ‰å¯è´­ä¹°çš„æˆ¿å±‹",notEnoughMoney:"èµ„é‡‘ä¸è¶³ï¼æ‚¨éœ€è¦Â¥{price}ï¼Œä½†åªæœ‰Â¥{money}ï¼Œè¿˜å·®Â¥{shortfall}",fundsChanged:"æ‚¨çš„èµ„é‡‘å·²å‘ç”Ÿå˜åŒ–ï¼éœ€è¦Â¥{price}ï¼Œä½†åªæœ‰Â¥{money}ï¼Œè¿˜å·®Â¥{shortfall}",significantConfirm:"è¿™ç¬”äº¤æ˜“å°†èŠ±è´¹æ‚¨{percent}%çš„èµ„é‡‘ï¼Œç¡®å®šè¦è´­ä¹°å—ï¼Ÿ",purchaseSuccess:"æ­å–œï¼æ‚¨å·²æˆåŠŸè´­ä¹°{house}",purchaseFailed:"è´­ä¹°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",confirmTitle:"ç¡®è®¤è´­ä¹°æˆ¿äº§",confirmMessage:'æ‚¨ç¡®å®šè¦è´­ä¹°"{house}"å—ï¼Ÿ',yourMoney:"æ‚¨çš„èµ„é‡‘",remaining:"è´­ä¹°åå‰©ä½™",significantWarning:"æ³¨æ„ï¼šè¿™æ˜¯ä¸€ç¬”å¤§é¢äº¤æ˜“ï¼Œå°†è€—è´¹æ‚¨å¤§éƒ¨åˆ†èµ„é‡‘ï¼",victoryPurchase:"æ­å–œï¼æ‚¨å·²æˆåŠŸè´­ä¹°æˆ¿äº§",victoryMessage:`æ­å–œæ‚¨è´­ä¹°äº†æˆ¿äº§ï¼š{house}ï¼

æ‚¨å½“å‰å¤„äºç¬¬{week}å‘¨ï¼Œæ¸¸æˆæ€»å…±æœ‰{maxWeek}å‘¨ã€‚`,continuePrompt:"æ‚¨æƒ³è¦ç»“æŸæ¸¸æˆå¹¶æŸ¥çœ‹ç»“æœï¼Œè¿˜æ˜¯ç»§ç»­æ¸¸æˆäº‰å–æ›´é«˜åˆ†æ•°ï¼Ÿ",continuePlaying:"æ‚¨é€‰æ‹©äº†ç»§ç»­æ¸¸æˆï¼Œäº‰å–æ›´é«˜åˆ†æ•°ï¼æ¸¸æˆå°†ç»§ç»­è¿›è¡Œåˆ°ç¬¬52å‘¨ã€‚",endGameNow:"ç»“æŸæ¸¸æˆå¹¶æŸ¥çœ‹æˆç»©",continueGame:"ç»§ç»­æ¸¸æˆ",details:{title:"æˆ¿å±‹è¯¦æƒ…",price:"ä»·æ ¼",size:"é¢ç§¯",location:"ä½ç½®",type:"ç±»å‹",features:"ç‰¹è‰²",description:"æè¿°"},types:{apartment:"å…¬å¯“",house:"ç‹¬æ ‹åˆ«å¢…",villa:"è±ªååˆ«å¢…",mansion:"è±ªå®…",penthouse:"é¡¶å±‚å…¬å¯“"},features:{garden:"èŠ±å›­",pool:"æ¸¸æ³³æ± ",garage:"è½¦åº“",security:"å®‰ä¿ç³»ç»Ÿ",view:"æ™¯è§‚è§†é‡",central:"ä¸­å¿ƒä½ç½®",quiet:"å®‰é™ç¤¾åŒº",modern:"ç°ä»£è£…ä¿®",classic:"ç»å…¸é£æ ¼",luxury:"è±ªåè£…ä¿®"}}},houses:{small:{name:"å•èº«å…¬å¯“",description:"é€‚åˆå•èº«äººå£«å±…ä½çš„å°å‹å…¬å¯“ï¼Œä½ç½®ä¾¿åˆ©ä½†ç©ºé—´æœ‰é™ã€‚"},medium:{name:"äºŒæ‰‹æ—§æˆ¿",description:"å¹´ä»£è¾ƒä¹…çš„äºŒæ‰‹ä½å®…ï¼Œä»·æ ¼é€‚ä¸­ä½†å¯èƒ½éœ€è¦è£…ä¿®ã€‚ç©ºé—´è¾ƒå¤§ï¼Œéå¸¸é€‚åˆæ”¹é€ æˆç†æƒ³çš„å®¶ã€‚"},large:{name:"é«˜æ¡£å°åŒº",description:"ç°ä»£åŒ–é«˜æ¡£ä½å®…å°åŒºï¼Œç¯å¢ƒä¼˜ç¾ï¼Œé…å¥—è®¾æ–½é½å…¨ã€‚ç¤¾åŒºç¯å¢ƒå®‰å…¨ï¼Œæ˜¯å®¶åº­å±…ä½çš„ç»ä½³é€‰æ‹©ã€‚"},luxury:{name:"ç°ä»£åˆ«å¢…",description:"ç‹¬æ ‹ç°ä»£åˆ«å¢…ï¼Œæ‹¥æœ‰ç§å®¶èŠ±å›­å’Œè½¦åº“ã€‚å®½æ•çš„ç©ºé—´å’Œç²¾è‡´çš„è®¾è®¡ï¼Œå½°æ˜¾ä¸»äººçš„å“å‘³ä¸åœ°ä½ã€‚"},mansion:{name:"ç§äººåº„å›­",description:"å¤§å‹ç§äººåº„å›­ï¼Œå¸¦æœ‰å¤§ç‰‡ç»¿åœ°å’Œå¤šåŠŸèƒ½åŒºåŸŸã€‚æ‹¥æœ‰è¿™æ ·çš„æˆ¿äº§ï¼Œä»£è¡¨ä½ å·²è¾¾åˆ°äººç”Ÿå·…å³°ï¼"}},buyModal:{title:"è´­ä¹° {product}",price:"å•ä»·",availableMoney:"å¯ç”¨èµ„é‡‘",availableSpace:"å¯ç”¨ç©ºé—´",quantity:"è´­ä¹°æ•°é‡",totalCost:"æ€»èŠ±è´¹",maxQuantity:"æœ€å¤§",confirm:"ç¡®è®¤è´­ä¹°",cancel:"å–æ¶ˆ"},sellModal:{title:"å‡ºå”® {product}",purchasePrice:"ä¹°å…¥ä»·",currentPrice:"å½“å‰ä»·",quantity:"æŒæœ‰æ•°é‡",sellQuantity:"å‡ºå”®æ•°é‡",potentialProfit:"é¢„è®¡ç›ˆäº",totalIncome:"æ€»æ”¶å…¥",maxQuantity:"å…¨éƒ¨",confirm:"ç¡®è®¤å‡ºå”®",cancel:"å–æ¶ˆ"},houseModal:{title:"è´­ä¹° {house}",confirmPurchase:"ç¡®è®¤è´­ä¹°æ­¤æˆ¿å±‹å—ï¼Ÿ",price:"æˆ¿å±‹ä»·æ ¼",availableMoney:"å¯ç”¨èµ„é‡‘",remainingMoney:"è´­ä¹°åå‰©ä½™",confirm:"ç¡®è®¤è´­ä¹°",cancel:"å–æ¶ˆ",endGame:"è´­ä¹°æ­¤æˆ¿å±‹å°†ç»“æŸæ¸¸æˆ"},trends:{rising_strong:"ä»·æ ¼æ€¥å‰§ä¸Šæ¶¨",rising:"ä»·æ ¼ä¸Šæ¶¨ä¸­",stable_high:"é«˜ä½ç¨³å®š",stable:"ä»·æ ¼ç¨³å®š",stable_low:"ä½ä½ç¨³å®š",falling:"ä»·æ ¼ä¸‹è·Œä¸­",falling_strong:"ä»·æ ¼æ€¥å‰§ä¸‹è·Œ",volatile:"ä»·æ ¼å‰§çƒˆæ³¢åŠ¨",trendAnalysis:{title:"è¶‹åŠ¿åˆ†æ",shortTerm:"çŸ­æœŸè¶‹åŠ¿",midTerm:"ä¸­æœŸè¶‹åŠ¿",longTerm:"é•¿æœŸè¶‹åŠ¿",prediction:"é¢„æµ‹",confidence:"ç½®ä¿¡åº¦",high:"é«˜",medium:"ä¸­",low:"ä½"}}},kt={playerInfo:{title:"ç©å®¶ä¿¡æ¯",name:"å§“å",money:"èµ„é‡‘",debt:"å€ºåŠ¡",capacity:"èƒŒåŒ…å®¹é‡",week:"å‘¨æ•°",repayDebt:"è¿˜æ¬¾",bank:"é“¶è¡Œ",stats:{title:"ç©å®¶ç»Ÿè®¡",totalProfit:"æ€»åˆ©æ¶¦",transactions:"äº¤æ˜“æ¬¡æ•°",visitedLocations:"å·²è®¿é—®åœ°ç‚¹",eventsTriggered:"è§¦å‘äº‹ä»¶æ•°",highestSingleProfit:"å•ç¬”æœ€é«˜åˆ©æ¶¦",mostProfitableProduct:"æœ€èµšé’±å•†å“",mostVisitedLocation:"æœ€å¸¸å»åœ°ç‚¹"}},inventory:{title:"èƒŒåŒ…",capacityUsed:"å®¹é‡: {used}/{total}",productName:"å•†å“åç§°",quantity:"æ•°é‡",purchasePrice:"ä¹°å…¥ä»·",currentPrice:"å½“å‰ä»·",trend:"è¶‹åŠ¿",profit:"ç›ˆäº",action:"æ“ä½œ",sell:"å‡ºå”®",empty:"èƒŒåŒ…æ˜¯ç©ºçš„",sort:{default:"é»˜è®¤æ’åº",profitDesc:"åˆ©æ¶¦ä»é«˜åˆ°ä½",profitAsc:"åˆ©æ¶¦ä»ä½åˆ°é«˜",quantityDesc:"æ•°é‡ä»å¤šåˆ°å°‘",quantityAsc:"æ•°é‡ä»å°‘åˆ°å¤š",nameAsc:"åç§°æ­£åº",nameDesc:"åç§°å€’åº"},filter:{all:"å…¨éƒ¨å•†å“",profitable:"ç›ˆåˆ©å•†å“",unprofitable:"äºæŸå•†å“"},details:{title:"å•†å“è¯¦æƒ…",purchaseInfo:"è´­ä¹°ä¿¡æ¯",purchaseDate:"è´­ä¹°æ—¥æœŸ",purchaseLocation:"è´­ä¹°åœ°ç‚¹",currentInfo:"å½“å‰ä¿¡æ¯",potentialProfit:"æ½œåœ¨åˆ©æ¶¦",profitPercentage:"åˆ©æ¶¦ç‡"}},repayModal:{title:"å¿è¿˜å€ºåŠ¡",currentDebt:"å½“å‰å€ºåŠ¡",availableMoney:"å¯ç”¨èµ„é‡‘",repayAmount:"è¿˜æ¬¾é‡‘é¢",remainingDebt:"å‰©ä½™å€ºåŠ¡",remainingMoney:"å‰©ä½™èµ„é‡‘",fullRepay:"å…¨éƒ¨è¿˜æ¸…",confirm:"ç¡®è®¤è¿˜æ¬¾",cancel:"å–æ¶ˆ"},debtSystem:{title:"å€ºåŠ¡ç³»ç»Ÿ",currentDebt:"å½“å‰å€ºåŠ¡",interestRate:"åˆ©ç‡",nextInterest:"ä¸‹æ¬¡åˆ©æ¯",paymentDue:"åº”ä»˜é‡‘é¢",warning:{high:"è­¦å‘Šï¼šå€ºåŠ¡è¿‡é«˜",critical:"å±é™©ï¼šå€ºåŠ¡å³å°†è§¦å‘ç ´äº§",bankrupt:"æ‚¨å·²ç ´äº§ï¼"},interestApplied:"å·²æ”¶å–{amount}å…ƒåˆ©æ¯"},bank:{title:"é“¶è¡ŒæœåŠ¡",deposit:"å­˜æ¬¾",withdraw:"å–æ¬¾",loan:"è´·æ¬¾",repay:"è¿˜æ¬¾",currentDeposit:"å½“å‰å­˜æ¬¾",currentLoan:"å½“å‰è´·æ¬¾",interestRate:"åˆ©ç‡",depositInterest:"å­˜æ¬¾åˆ©ç‡",loanInterest:"è´·æ¬¾åˆ©ç‡",maxLoan:"æœ€å¤§è´·æ¬¾é¢åº¦",availableLoan:"å¯è´·æ¬¾é¢åº¦",amountToDeposit:"å­˜æ¬¾é‡‘é¢",amountToWithdraw:"å–æ¬¾é‡‘é¢",amountToLoan:"è´·æ¬¾é‡‘é¢",amountToRepay:"è¿˜æ¬¾é‡‘é¢",confirmDeposit:"ç¡®è®¤å­˜æ¬¾",confirmWithdraw:"ç¡®è®¤å–æ¬¾",confirmLoan:"ç¡®è®¤è´·æ¬¾",confirmRepay:"ç¡®è®¤è¿˜æ¬¾",interestInfo:"æ¯å‘¨ç»“ç®—ä¸€æ¬¡åˆ©æ¯",notEnoughMoney:"èµ„é‡‘ä¸è¶³",depositSuccess:"å­˜æ¬¾æˆåŠŸ",withdrawSuccess:"å–æ¬¾æˆåŠŸ",loanSuccess:"è´·æ¬¾æˆåŠŸ",repaySuccess:"è¿˜æ¬¾æˆåŠŸ",weeklyInterest:"æ¯å‘¨åˆ©æ¯",remainingMoney:"å‰©ä½™èµ„é‡‘",remainingDeposit:"å‰©ä½™å­˜æ¬¾",remainingLoan:"å‰©ä½™è´·æ¬¾",remainingDebt:"å‰©ä½™å€ºåŠ¡"},tutorial:{tips:{welcome:{title:"æ¬¢è¿æ¥åˆ°ã€Šä¹°æˆ¿è®°ã€‹",content:"åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œä½ çš„ç›®æ ‡æ˜¯é€šè¿‡ä¹°å–å•†å“èµšå–å·®ä»·ï¼Œæœ€ç»ˆç§¯ç´¯è¶³å¤Ÿçš„èµ„é‡‘è´­ä¹°æˆ¿äº§ã€‚<br><br>ä½ æœ‰52å‘¨çš„æ—¶é—´æ¥å®ç°è¿™ä¸ªç›®æ ‡ï¼Œç¥ä½ å¥½è¿ï¼"},market_intro:{title:"å¸‚åœºäº¤æ˜“",content:"åœ¨å¸‚åœºæ ‡ç­¾é¡µä¸­ï¼Œä½ å¯ä»¥è´­ä¹°å„ç§å•†å“ã€‚ä¸åŒåœ°ç‚¹æä¾›çš„å•†å“å’Œä»·æ ¼å„ä¸ç›¸åŒã€‚<br><br>å…³æ³¨ä»·æ ¼è¶‹åŠ¿ï¼Œåœ¨ä»·æ ¼ä½æ—¶è´­ä¹°ï¼Œä»·æ ¼é«˜æ—¶å–å‡ºï¼Œèµšå–å·®ä»·ã€‚"},inventory_intro:{title:"åº“å­˜ç®¡ç†",content:"åœ¨åº“å­˜æ ‡ç­¾é¡µä¸­ï¼Œä½ å¯ä»¥æŸ¥çœ‹å·²è´­ä¹°çš„å•†å“ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶æœºå–å‡ºã€‚<br><br>æ³¨æ„èƒŒåŒ…å®¹é‡æœ‰é™ï¼Œåˆç†è§„åˆ’è´­ä¹°çš„å•†å“æ•°é‡ã€‚"},location_change:{title:"åˆ‡æ¢åœ°ç‚¹",content:"ä½ å¯ä»¥åœ¨ä¸åŒåœ°ç‚¹ä¹‹é—´åˆ‡æ¢ï¼Œæ¯ä¸ªåœ°ç‚¹éƒ½æœ‰ä¸åŒçš„å•†å“å’Œä»·æ ¼ã€‚<br><br>åˆ©ç”¨ä¸åŒåœ°ç‚¹ä¹‹é—´çš„ä»·æ ¼å·®å¼‚ï¼Œå¯ä»¥èµšå–æ›´å¤šåˆ©æ¶¦ã€‚"},price_trends:{title:"ä»·æ ¼è¶‹åŠ¿",content:"å•†å“ä»·æ ¼ä¼šéšæ—¶é—´æ³¢åŠ¨ï¼Œå…³æ³¨ä»·æ ¼è¶‹åŠ¿æ˜¯è·åˆ©çš„å…³é”®ã€‚<br><br>ä¸Šæ¶¨è¶‹åŠ¿è¡¨ç¤ºä»·æ ¼å¯èƒ½ç»§ç»­ä¸Šæ¶¨ï¼Œä¸‹è·Œè¶‹åŠ¿è¡¨ç¤ºä»·æ ¼å¯èƒ½ç»§ç»­ä¸‹è·Œã€‚"},special_products:{title:"ç‰¹è‰²å•†å“",content:"æ¯ä¸ªåœ°ç‚¹éƒ½æœ‰ç‰¹è‰²å•†å“ï¼Œä»·æ ¼æ›´ä¼˜æƒ ã€‚ç‰¹è‰²å•†å“åœ¨å•†å“åˆ—è¡¨ä¸­ä¼šæœ‰ç‰¹æ®Šæ ‡è®°ã€‚<br><br>å…³æ³¨ç‰¹è‰²å•†å“å¯ä»¥æé«˜äº¤æ˜“åˆ©æ¶¦ã€‚"},houses:{title:"æˆ¿äº§è´­ä¹°",content:"å½“ä½ ç§¯ç´¯äº†è¶³å¤Ÿçš„èµ„é‡‘åï¼Œå¯ä»¥åœ¨æˆ¿äº§æ ‡ç­¾é¡µä¸­è´­ä¹°æˆ¿å±‹ã€‚<br><br>ä¸åŒæˆ¿å±‹æœ‰ä¸åŒçš„ä»·æ ¼ï¼Œè´­ä¹°ä»»æ„æˆ¿å±‹éƒ½ä¼šç»“æŸæ¸¸æˆã€‚"},mid_game:{title:"æ¸¸æˆè¿›å±•",content:"ä½ å·²ç»å®Œæˆäº†æ¸¸æˆçš„å››åˆ†ä¹‹ä¸€ï¼ç°åœ¨æ˜¯æ—¶å€™åˆ¶å®šæ›´é•¿è¿œçš„è®¡åˆ’äº†ã€‚<br><br>è€ƒè™‘ç§¯ç´¯æ›´å¤šèµ„é‡‘ï¼Œä¸ºè´­ä¹°æˆ¿äº§åšå‡†å¤‡ã€‚"},late_game:{title:"æ¸¸æˆåæœŸ",content:"æ¸¸æˆå·²ç»è¿‡åŠï¼Œç¡®ä¿ä½ çš„èµ„é‡‘å¢é•¿è¶³å¤Ÿå¿«ï¼Œä»¥ä¾¿åœ¨æ¸¸æˆç»“æŸå‰è´­ä¹°ç†æƒ³çš„æˆ¿äº§ã€‚<br><br>å¦‚æœèµ„é‡‘å¢é•¿ç¼“æ…¢ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´äº¤æ˜“ç­–ç•¥æˆ–æ‰¿æ‹…æ›´å¤šé£é™©ã€‚"}},help:{title:"æ¸¸æˆå¸®åŠ©",basics:"æ¸¸æˆåŸºç¡€",trading:"äº¤æ˜“æŠ€å·§",events:"äº‹ä»¶ç³»ç»Ÿ",settings:"æ¸¸æˆè®¾ç½®",gotIt:"çŸ¥é“äº†",dontShowAgain:"ä¸å†æ˜¾ç¤ºæ­¤æç¤º",prev:"ä¸Šä¸€æ¡",next:"ä¸‹ä¸€æ¡",shortcuts:{title:"é”®ç›˜å¿«æ·é”®",space:"è¿›å…¥ä¸‹ä¸€å‘¨",tab:"åˆ‡æ¢æ ‡ç­¾é¡µ",esc:"æ‰“å¼€/å…³é—­èœå•",h:"æ‰“å¼€å¸®åŠ©é¢æ¿"}}}},Pt={event:{title:"äº‹ä»¶",debtIncrease:"å€ºåŠ¡å¢åŠ ",debtDecrease:"å€ºåŠ¡å‡å°‘",gainProduct:"è·å¾—ç‰©å“",loseProduct:"å¤±å»ç‰©å“",moneyGain:"è·å¾—èµ„é‡‘",moneyLoss:"å¤±å»èµ„é‡‘",priceChange:"ä»·æ ¼å˜åŠ¨",capacityChange:"èƒŒåŒ…å®¹é‡å˜åŒ–",specialEvent:"ç‰¹æ®Šäº‹ä»¶",types:{positive:"æ­£é¢äº‹ä»¶",negative:"è´Ÿé¢äº‹ä»¶",neutral:"ä¸­æ€§äº‹ä»¶",mixed:"å¤åˆäº‹ä»¶"},effects:{money:"èµ„é‡‘ {change}",debt:"å€ºåŠ¡ {change}",capacity:"èƒŒåŒ…å®¹é‡ {change}",product:"å•†å“: {product} x {quantity}",price:"{product} ä»·æ ¼ {change}",location:"è§£é”åœ°ç‚¹: {location}"},choices:{accept:"æ¥å—",decline:"æ‹’ç»",option1:"é€‰é¡¹1",option2:"é€‰é¡¹2",option3:"é€‰é¡¹3",continue:"ç»§ç»­"},notifications:{triggered:"è§¦å‘äº‹ä»¶: {name}",completed:"äº‹ä»¶å®Œæˆ: {name}",reward:"è·å¾—å¥–åŠ±: {reward}",penalty:"å—åˆ°æƒ©ç½š: {penalty}",choiceMade:"å·²é€‰æ‹©: {choice}"},common:{marketCrash:"å¸‚åœºå´©ç›˜",marketBoom:"å¸‚åœºç¹è£",robbery:"é­é‡æŠ¢åŠ«",lottery:"ä¸­å½©ç¥¨",backpackUpgrade:"èƒŒåŒ…å‡çº§",backpackDamage:"èƒŒåŒ…æŸå",investmentSuccess:"æŠ•èµ„æˆåŠŸ",investmentFailure:"æŠ•èµ„å¤±è´¥",taxAudit:"ç¨åŠ¡å®¡è®¡",inheritance:"æ„å¤–ç»§æ‰¿",donation:"æ…ˆå–„ææ¬¾",discount:"ç‰¹åˆ«æŠ˜æ‰£",priceHike:"ä»·æ ¼ä¸Šæ¶¨",specialOffer:"ç‰¹åˆ«ä¼˜æƒ ",blackMarket:"é»‘å¸‚äº¤æ˜“"},descriptions:{marketCrash:"å¸‚åœºçªç„¶å´©ç›˜ï¼æ‰€æœ‰å•†å“ä»·æ ¼å¤§å¹…ä¸‹è·Œã€‚",marketBoom:"å¸‚åœºçªç„¶ç¹è£ï¼æ‰€æœ‰å•†å“ä»·æ ¼å¤§å¹…ä¸Šæ¶¨ã€‚",robbery:"ä½ è¢«æŠ¢åŠ«äº†ï¼å¤±å»äº†ä¸€äº›èµ„é‡‘å’Œå•†å“ã€‚",lottery:"æ­å–œä½ ä¸­äº†å½©ç¥¨ï¼è·å¾—é¢å¤–èµ„é‡‘ã€‚",backpackUpgrade:"ä½ æ‰¾åˆ°äº†ä¸€ä¸ªæ›´å¤§çš„èƒŒåŒ…ï¼Œå®¹é‡å¢åŠ ï¼",backpackDamage:"ä½ çš„èƒŒåŒ…ç ´æŸäº†ï¼Œå®¹é‡å‡å°‘ï¼",investmentSuccess:"ä½ çš„æŠ•èµ„è·å¾—äº†æˆåŠŸï¼Œè·å¾—é¢å¤–æ”¶ç›Šã€‚",investmentFailure:"ä½ çš„æŠ•èµ„å¤±è´¥äº†ï¼ŒæŸå¤±äº†ä¸€äº›èµ„é‡‘ã€‚",taxAudit:"ç¨åŠ¡éƒ¨é—¨å¯¹ä½ è¿›è¡Œäº†å®¡è®¡ï¼Œä½ éœ€è¦æ”¯ä»˜ä¸€äº›ç¨æ¬¾ã€‚",inheritance:"ä½ æ„å¤–ç»§æ‰¿äº†ä¸€ç¬”è´¢äº§ï¼Œè·å¾—é¢å¤–èµ„é‡‘ã€‚",donation:"ä½ å†³å®šä¸ºæ…ˆå–„äº‹ä¸šææ¬¾ï¼Œå¤±å»ä¸€äº›èµ„é‡‘ä½†è·å¾—äº†å¥½è¯„ã€‚",discount:"å•†åº—æ¨å‡ºäº†ç‰¹åˆ«æŠ˜æ‰£ï¼ŒæŸäº›å•†å“ä»·æ ¼ä¸‹é™ã€‚",priceHike:"ç”±äºä¾›åº”çŸ­ç¼ºï¼ŒæŸäº›å•†å“ä»·æ ¼ä¸Šæ¶¨ã€‚",specialOffer:"ä½ æ”¶åˆ°äº†ä¸€ä¸ªç‰¹åˆ«ä¼˜æƒ ï¼Œå¯ä»¥ä½ä»·è´­ä¹°æŸäº›å•†å“ã€‚",blackMarket:"ä½ å‘ç°äº†ä¸€ä¸ªé»‘å¸‚äº¤æ˜“æœºä¼šï¼Œå¯ä»¥é«˜ä»·å‡ºå”®æŸäº›å•†å“ã€‚"}},notifications:{error:{inventoryFull:"èƒŒåŒ…ç©ºé—´ä¸è¶³",insufficientStock:"åº“å­˜æ•°é‡ä¸è¶³",houseNotFound:"æ‰¾ä¸åˆ°æŒ‡å®šçš„æˆ¿å±‹",alreadyOwned:"å·²ç»æ‹¥æœ‰æ­¤æˆ¿å±‹",invalidRepayment:"è¿˜æ¬¾é‡‘é¢æ— æ•ˆ",saveFailed:"ä¿å­˜æ¸¸æˆå¤±è´¥",loadFailed:"æ‰¾ä¸åˆ°å­˜æ¡£æˆ–å­˜æ¡£å·²æŸå",insufficientFunds:"èµ„é‡‘ä¸è¶³ï¼Œæ— æ³•è´­ä¹°",autoSaveFailed:"è‡ªåŠ¨ä¿å­˜å¤±è´¥",autoSaveError:"è‡ªåŠ¨ä¿å­˜è¿‡ç¨‹å‡ºé”™"},success:{purchased:"æˆåŠŸè´­ä¹°",sold:"æˆåŠŸå‡ºå”®",housePurchased:"æˆåŠŸè´­ä¹°æˆ¿å±‹",repaid:"æˆåŠŸè¿˜æ¬¾",gameSaved:"æ¸¸æˆå·²ä¿å­˜",gameLoaded:"å·²åŠ è½½æ¸¸æˆ",autoSaved:"è‡ªåŠ¨ä¿å­˜æˆåŠŸ"},info:{endGame:"ä½ é€‰æ‹©äº†ç»“æŸæ¸¸æˆ",timeUp:"æ—¶é—´å·²åˆ°ï¼æ¸¸æˆç»“æŸ",bankrupt:"ä½ å·²ç ´äº§ï¼æ¸¸æˆç»“æŸ",weekProgress:"è¿›å…¥ç¬¬ {week} å‘¨",locationChange:"ä½ å·²åˆ°è¾¾ {location}"},achievement:{earlyGoal:"æå‰è¾¾æˆç›®æ ‡",noDebtHouse:"é›¶è´Ÿå€ºè´­æˆ¿",victory:"æ­å–œï¼ä½ æˆåŠŸè´­ä¹°äº†æœ€è´µçš„æˆ¿äº§ï¼",achieved:"ä½ è¾¾æˆäº†æˆå°±: {name}"}}},_t={ui:{mainMenu:{title:"ä¹°æˆ¿è®°",newGame:"æ–°æ¸¸æˆ",loadGame:"åŠ è½½æ¸¸æˆ",settings:"è®¾ç½®",exit:"é€€å‡º",version:"ç‰ˆæœ¬ {version}",credits:"åˆ¶ä½œå›¢é˜Ÿ"},saveMenu:{title:"å­˜æ¡£ç®¡ç†",newSave:"æ–°å»ºå­˜æ¡£",loadSave:"åŠ è½½å­˜æ¡£",deleteSave:"åˆ é™¤å­˜æ¡£",back:"è¿”å›",noSaves:"æ²¡æœ‰æ‰¾åˆ°å­˜æ¡£",saveDate:"ä¿å­˜æ—¥æœŸ: {date}",saveWeek:"æ¸¸æˆå‘¨: {week}",playerName:"ç©å®¶: {name}",playerMoney:"èµ„é‡‘: {money}",confirmDelete:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­˜æ¡£å—ï¼Ÿ",overwriteConfirm:"å­˜æ¡£å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ",invalidSave:"æ— æ•ˆçš„å­˜æ¡£æ–‡ä»¶"},gameView:{nextWeek:"ä¸‹ä¸€å‘¨",menu:"èœå•",tabs:{market:"å¸‚åœº",inventory:"èƒŒåŒ…",houses:"æˆ¿å±‹"},weekDisplay:"ç¬¬ {current}/{total} å‘¨",moneyDisplay:"{amount} å…ƒ",debtDisplay:"å€ºåŠ¡: {amount} å…ƒ",loading:"åŠ è½½ä¸­...",saving:"ä¿å­˜ä¸­..."},dialogs:{confirm:{title:"ç¡®è®¤",ok:"ç¡®å®š",cancel:"å–æ¶ˆ"},alert:{title:"æç¤º",ok:"ç¡®å®š"},input:{title:"è¾“å…¥",ok:"ç¡®å®š",cancel:"å–æ¶ˆ"},error:{title:"é”™è¯¯",ok:"ç¡®å®š",details:"è¯¦ç»†ä¿¡æ¯"}},toast:{success:"æˆåŠŸ",error:"é”™è¯¯",info:"æç¤º",warning:"è­¦å‘Š"},loading:{initializing:"åˆå§‹åŒ–æ¸¸æˆ...",loadingAssets:"åŠ è½½èµ„æº...",loadingGame:"åŠ è½½æ¸¸æˆ...",savingGame:"ä¿å­˜æ¸¸æˆ...",processingTurn:"å¤„ç†æ¸¸æˆå›åˆ...",generatingWorld:"ç”Ÿæˆæ¸¸æˆä¸–ç•Œ...",ready:"å‡†å¤‡å°±ç»ª"},devTools:{title:"å¼€å‘å·¥å…·",addMoney:"æ·»åŠ èµ„é‡‘",removeMoney:"å‡å°‘èµ„é‡‘",addDebt:"æ·»åŠ å€ºåŠ¡",removeDebt:"å‡å°‘å€ºåŠ¡",skipWeek:"è·³è¿‡å‘¨æ•°",unlockAllLocations:"è§£é”æ‰€æœ‰åœ°ç‚¹",resetPrices:"é‡ç½®ä»·æ ¼",triggerEvent:"è§¦å‘äº‹ä»¶",amount:"æ•°é‡",apply:"åº”ç”¨",cancel:"å–æ¶ˆ",eventType:"äº‹ä»¶ç±»å‹",warning:"è­¦å‘Šï¼šä½¿ç”¨å¼€å‘å·¥å…·å¯èƒ½ä¼šå½±å“æ¸¸æˆå¹³è¡¡å’Œä½“éªŒ"},charts:{title:"å›¾è¡¨",priceHistory:"ä»·æ ¼å†å²",playerNetWorth:"ç©å®¶å‡€èµ„äº§",weeklyProfit:"æ¯å‘¨åˆ©æ¶¦",zoom:"ç¼©æ”¾",period:"å‘¨æœŸ",showAll:"æ˜¾ç¤ºå…¨éƒ¨",last10Weeks:"æœ€è¿‘10å‘¨",last20Weeks:"æœ€è¿‘20å‘¨",custom:"è‡ªå®šä¹‰",noData:"æš‚æ— æ•°æ®",exportData:"å¯¼å‡ºæ•°æ®",importData:"å¯¼å…¥æ•°æ®"},errorHandling:{title:"é”™è¯¯å¤„ç†",message:"å‘ç”Ÿé”™è¯¯",details:"è¯¦ç»†ä¿¡æ¯",stackTrace:"å †æ ˆè·Ÿè¸ª",retry:"é‡è¯•",ignore:"å¿½ç•¥",report:"æŠ¥å‘Šé—®é¢˜",close:"å…³é—­",errorBoundary:{title:"ç»„ä»¶é”™è¯¯",message:"ç»„ä»¶æ¸²æŸ“å‡ºé”™",reset:"é‡ç½®ç»„ä»¶"}}}},St={errors:{defaultError:"å‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯",severity:{fatal:"è‡´å‘½é”™è¯¯",error:"é”™è¯¯",warning:"è­¦å‘Š",info:"æç¤º"},type:{validation:{default:"æ•°æ®éªŒè¯é”™è¯¯: {message}",specific:{required_field:"å¿…å¡«å­—æ®µä¸èƒ½ä¸ºç©º",invalid_format:"æ•°æ®æ ¼å¼ä¸æ­£ç¡®",out_of_range:"æ•°å€¼è¶…å‡ºå…è®¸èŒƒå›´",invalid_type:"æ•°æ®ç±»å‹ä¸æ­£ç¡®",duplicate_entry:"æ•°æ®å·²å­˜åœ¨",too_short:"è¾“å…¥å†…å®¹è¿‡çŸ­",too_long:"è¾“å…¥å†…å®¹è¿‡é•¿"}},network:{default:"ç½‘ç»œé”™è¯¯: {message}",specific:{connection_failed:"è¿æ¥æœåŠ¡å™¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥",timeout:"è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•",server_error:"æœåŠ¡å™¨é”™è¯¯",api_error:"APIé”™è¯¯",invalid_response:"æ— æ•ˆçš„æœåŠ¡å™¨å“åº”",offline:"æ‚¨å½“å‰å¤„äºç¦»çº¿çŠ¶æ€"}},storage:{default:"å­˜å‚¨é”™è¯¯: {message}",specific:{file_not_found:"æ‰¾ä¸åˆ°æ–‡ä»¶",permission_denied:"æ²¡æœ‰è¶³å¤Ÿæƒé™",quota_exceeded:"å­˜å‚¨ç©ºé—´ä¸è¶³",data_corrupt:"æ•°æ®å·²æŸå",unknown:"æœªçŸ¥å­˜å‚¨é”™è¯¯",save_failed:"ä¿å­˜æ¸¸æˆå¤±è´¥",load_failed:"åŠ è½½æ¸¸æˆå¤±è´¥",file_io_error:"æ–‡ä»¶è¯»å†™é”™è¯¯",invalid_format:"æ— æ•ˆçš„æ–‡ä»¶æ ¼å¼",version_mismatch:"ç‰ˆæœ¬ä¸å…¼å®¹"}},game_logic:{default:"æ¸¸æˆé€»è¾‘é”™è¯¯: {message}",specific:{invalid_operation:"æ— æ•ˆçš„æ“ä½œ",insufficient_funds:"èµ„é‡‘ä¸è¶³",inventory_full:"èƒŒåŒ…å·²æ»¡",invalid_state:"æ— æ•ˆçš„æ¸¸æˆçŠ¶æ€",invalid_transition:"æ— æ•ˆçš„çŠ¶æ€è½¬æ¢",out_of_bounds:"è¶…å‡ºè¾¹ç•Œ",dependency_missing:"ç¼ºå°‘ä¾èµ–é¡¹",invalid_parameter:"æ— æ•ˆçš„å‚æ•°",calculation_error:"è®¡ç®—é”™è¯¯",rule_violation:"è¿åæ¸¸æˆè§„åˆ™"}},system:{default:"ç³»ç»Ÿé”™è¯¯: {message}",specific:{initialization_failed:"åˆå§‹åŒ–æ¸¸æˆå¤±è´¥",resource_not_found:"æ‰¾ä¸åˆ°éœ€è¦çš„èµ„æº",memory_error:"å†…å­˜é”™è¯¯",performance_issue:"æ€§èƒ½é—®é¢˜",render_error:"æ¸²æŸ“é”™è¯¯",audio_error:"éŸ³é¢‘é”™è¯¯",plugin_error:"æ’ä»¶é”™è¯¯",compatibility_issue:"å…¼å®¹æ€§é—®é¢˜",unexpected_state:"æ„å¤–çš„ç³»ç»ŸçŠ¶æ€",critical_failure:"ä¸¥é‡æ•…éšœ"}},unknown:{default:"{message}"}},recovery:{title:"é”™è¯¯æ¢å¤",message:"æ¸¸æˆé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ­£åœ¨å°è¯•æ¢å¤...",success:"æ¢å¤æˆåŠŸ",failed:"æ¢å¤å¤±è´¥",options:{retry:"é‡è¯•",reload:"é‡æ–°åŠ è½½",reset:"é‡ç½®æ¸¸æˆ",ignore:"å¿½ç•¥å¹¶ç»§ç»­",report:"æŠ¥å‘Šé—®é¢˜"},autoSave:{corrupted:"è‡ªåŠ¨å­˜æ¡£å·²æŸå",notFound:"æ‰¾ä¸åˆ°è‡ªåŠ¨å­˜æ¡£",incompatible:"è‡ªåŠ¨å­˜æ¡£ä¸å½“å‰ç‰ˆæœ¬ä¸å…¼å®¹",loadFailed:"åŠ è½½è‡ªåŠ¨å­˜æ¡£å¤±è´¥"},stateSnapshot:{restoring:"æ­£åœ¨æ¢å¤æ¸¸æˆçŠ¶æ€...",noValidSnapshot:"æ²¡æœ‰å¯ç”¨çš„æ¸¸æˆçŠ¶æ€å¿«ç…§",partialRestore:"éƒ¨åˆ†æ¸¸æˆçŠ¶æ€å·²æ¢å¤",fullRestore:"æ¸¸æˆçŠ¶æ€å·²å®Œå…¨æ¢å¤"}},errorLog:{title:"é”™è¯¯æ—¥å¿—",empty:"æ²¡æœ‰è®°å½•çš„é”™è¯¯",timestamp:"æ—¶é—´",message:"æ¶ˆæ¯",type:"ç±»å‹",severity:"ä¸¥é‡ç¨‹åº¦",details:"è¯¦ç»†ä¿¡æ¯",actions:{clear:"æ¸…ç©ºæ—¥å¿—",export:"å¯¼å‡ºæ—¥å¿—",filter:"ç­›é€‰æ—¥å¿—",search:"æœç´¢",showDetails:"æ˜¾ç¤ºè¯¦æƒ…",hideDetails:"éšè—è¯¦æƒ…"}}}},Mt={...Et,...bt,...kt,...Pt,..._t,...St};function Lt(){return(navigator.language||navigator.userLanguage).startsWith("zh"),"zh-CN"}function It(){try{const e=localStorage.getItem("userLanguage");if(e)return e}catch(e){R(e,"i18n.getUserLanguage",L.STORAGE,_.INFO),console.warn("æ— æ³•ä»æœ¬åœ°å­˜å‚¨è¯»å–è¯­è¨€è®¾ç½®:",e)}return Lt()}function At(){const e=pt({legacy:!1,locale:It(),fallbackLocale:"zh-CN",messages:{"zh-CN":Mt},datetimeFormats:{"zh-CN":{short:{year:"numeric",month:"2-digit",day:"2-digit"},long:{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}}},numberFormats:{"zh-CN":{currency:{style:"currency",currency:"CNY",notation:"standard"},decimal:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:2},percent:{style:"percent",useGrouping:!1}}}});return e.global.setLanguage=t=>{e.global.availableLocales.includes(t)||(console.warn(`è¯­è¨€ ${t} ä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜è®¤è¯­è¨€`),t=e.global.fallbackLocale.value),e.global.locale.value=t,document.querySelector("html").setAttribute("lang",t);try{localStorage.setItem("userLanguage",t)}catch(r){R(r,"i18n.setLanguage",L.STORAGE,_.INFO),console.warn("æ— æ³•ä¿å­˜è¯­è¨€è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨:",r)}},e.global.getSupportedLanguages=()=>[{code:"zh-CN",name:"ç®€ä½“ä¸­æ–‡",flag:"ğŸ‡¨ğŸ‡³"}],e.global.formatCurrency=t=>e.global.n(t,"currency"),e.global.formatDate=(t,r="long")=>e.global.d(t,r),e.global.formatNumber=t=>e.global.n(t,"decimal"),e.global.formatPercent=t=>e.global.n(t,"percent"),e}const D=At();D.global.t;D.global.d;D.global.n;D.global.setLanguage;const Pr=D.global.getSupportedLanguages;D.global.formatCurrency;D.global.formatDate;D.global.formatNumber;D.global.formatPercent;const Q=ie([]),We=200,Ke="gameRunning",rt="lastGameActivity",Rt=3e5;let $e=null;async function it(){if($e)return $e;const e=3,t=300,r=async(i=0)=>{try{const s=await yt(()=>Promise.resolve().then(()=>Gt),void 0,import.meta.url);if(s&&typeof s.useUiStore=="function"){const o=s.useUiStore();if(o&&typeof o=="object")return $e=o,o;throw new Error("Invalid uiStore instance")}else throw new Error("useUiStore function not found")}catch(s){return console.error(`Failed to import uiStore (attempt ${i+1}/${e}):`,s),i<e-1?(console.log(`Retrying in ${t}ms...`),await new Promise(o=>setTimeout(o,t)),r(i+1)):null}};return r()}function R(e,t,r=L.UNKNOWN,i=_.ERROR){const s={message:e.message||"æœªçŸ¥é”™è¯¯",context:t,type:r,severity:i,timestamp:new Date().toISOString(),stack:e.stack,metadata:e.metadata||{}};return wt(s),i===_.FATAL||i===_.ERROR?xt(s):i===_.WARNING&&Ct(s),window.electronAPI&&window.electronAPI.logError?window.electronAPI.logError(s):ft.error(`[${r}][${t}]`,e),s}function wt(e){Q.value.unshift(e),Q.value.length>We&&(Q.value=Q.value.slice(0,We));try{const t=JSON.stringify(Q.value);localStorage.setItem("errorLogs",t)}catch(t){console.error("Failed to save error logs to localStorage:",t)}}function Ot(){return new Promise(e=>{try{const t=localStorage.getItem("errorLogs");if(t){const r=JSON.parse(t);Q.value=r,Q.value.length>We&&(Q.value=Q.value.slice(0,We))}e([...Q.value])}catch(t){console.error("Failed to load error logs from localStorage:",t),e([])}})}function Pe(e){try{const t=`errors.${e.type}.specific.${e.message.toLowerCase().replace(/\s+/g,"_").replace(/[^\w]/g,"")}`,r=`errors.${e.type}.default`,i="å‘ç”Ÿé”™è¯¯";return D.global&&D.global.te&&D.global.te(t)?D.global.t(t):D.global&&D.global.te&&D.global.te(r)?D.global.t(r,{message:e.message}):e.message||i}catch(t){return console.error("Error getting localized error message:",t),e.message||"å‘ç”Ÿé”™è¯¯"}}async function xt(e){try{const t=await it();t&&typeof t.showErrorDialog=="function"?t.showErrorDialog({title:e.severity===_.FATAL?"ä¸¥é‡é”™è¯¯":"é”™è¯¯",message:Pe(e),details:void 0,timestamp:e.timestamp,context:e.context}):(console.error("UI Storeä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨é”™è¯¯æç¤º"),alert(Pe(e)))}catch(t){console.error("Error showing error dialog:",t),alert(Pe(e))}}async function Ct(e){try{const t=await it();t&&typeof t.showToast=="function"?t.showToast({type:"error",message:Pe(e),duration:5e3}):console.warn(Pe(e))}catch(t){console.warn("Error showing toast:",t)}}async function De(e,t,r=L.UNKNOWN,i=_.ERROR){try{return await e()}catch(s){throw R(s,t,r,i),s}}function _r(e){if(!e||!e.config){console.warn("æ— æ³•è®¾ç½®å…¨å±€é”™è¯¯å¤„ç†ï¼šappå®ä¾‹æ— æ•ˆ");return}e.config.errorHandler=(t,r,i)=>{let s="Unknown";try{r&&r.$options&&r.$options.name?s=r.$options.name:r&&r.$root&&(s="Root Component")}catch{s="Error getting component name"}R(t,`Vueç»„ä»¶: ${s}`,L.COMPONENT,_.ERROR)},window.addEventListener("unhandledrejection",t=>{R(t.reason||new Error("æœªå¤„ç†çš„Promiseå¼‚å¸¸"),"Promise",L.ASYNC,_.ERROR)}),window.addEventListener("error",t=>{t.error&&R(t.error,"å…¨å±€å¼‚å¸¸",L.RUNTIME,_.ERROR)}),Ot(),window.addEventListener("beforeunload",()=>{Tt()})}function Sr(){try{localStorage.setItem(Ke,"true"),Wt()}catch(e){console.warn("Failed to set game running flag:",e)}}function Tt(){try{localStorage.removeItem(Ke)}catch(e){console.warn("Failed to clear game running flag:",e)}}function Mr(){try{if(!(localStorage.getItem(Ke)==="true"))return!1;const t=localStorage.getItem(rt);if(t){const r=parseInt(t,10);if(Date.now()-r<Rt)return!0}return!1}catch(e){return console.warn("Failed to check game running flag:",e),!1}}function Wt(){try{localStorage.setItem(rt,Date.now().toString())}catch(e){console.warn("Failed to update game activity timestamp:",e)}}function Nt(e){if(!e||e==="undefined"||e==="null")return"./resources/assets/images/house_1.jpeg";const t={apartment:"./resources/assets/images/house_1.jpeg",second_hand:"./resources/assets/images/house_2.jpeg",highend:"./resources/assets/images/house_3.jpeg",villa:"./resources/assets/images/house_4.jpeg",mansion:"./resources/assets/images/house_5.jpeg"};if(!isNaN(parseInt(e))){const r=parseInt(e);return`./resources/assets/images/house_${r?Math.max(1,Math.min(5,r%5||1)):1}.jpeg`}return t[e]||"./resources/assets/images/house_1.jpeg"}const ke=ce("ui",()=>{const e=ie(!1),t=ie(null),r=ie([]),i=ie({}),s=ie(!1),o=ie(null),n=ie(!1),a=ie(null);function c(S){t.value=S,e.value=!0}function u(){e.value=!1,setTimeout(()=>{t.value=null},300)}function g({type:S="info",message:x="",duration:T=3e3,action:A=null,actionText:C="ç¡®å®š",actionCallback:F=null}){const N=r.value.find(q=>q.message===x);N&&m(N.id);const V=Date.now()+Math.random().toString(36).substring(2,10),ee={id:V,type:S,message:x,action:A,actionText:C,actionCallback:F};if(r.value.unshift(ee),r.value.length>5){const q=r.value.pop();i.value[q.id]&&(clearTimeout(i.value[q.id]),delete i.value[q.id])}return i.value[V]=setTimeout(()=>{m(V)},3e3),V}function m(S){const x=r.value.findIndex(T=>T.id===S);x!==-1&&(r.value.splice(x,1),i.value[S]&&(clearTimeout(i.value[S]),delete i.value[S]))}function p({snapshot:S,message:x,title:T,allowCancel:A=!0,onRecover:C,onCancel:F}){o.value={snapshot:S,message:x||"æ£€æµ‹åˆ°æ¸¸æˆæ„å¤–ä¸­æ–­ã€‚æ˜¯å¦æ¢å¤ä¸Šæ¬¡ä¿å­˜çš„æ¸¸æˆçŠ¶æ€ï¼Ÿ",title:T||"æ¸¸æˆæ¢å¤",allowCancel:A,onRecover:C||(()=>f()),onCancel:F||(()=>f())},s.value=!0}function f(){s.value=!1,setTimeout(()=>{o.value=null},300)}function y(S){a.value=S,n.value=!0}function k(){n.value=!1,setTimeout(()=>{a.value=null},300)}function I({type:S="info",message:x="",duration:T=3e3}){return g({type:S,message:x,duration:T})}function b(){r.value.forEach(S=>{m(S.id)})}return{errorDialogVisible:e,errorDialogData:t,showErrorDialog:c,closeErrorDialog:u,toasts:r,addToast:g,removeToast:m,showToast:I,closeToast:b,recoveryDialogVisible:s,recoveryDialogData:o,showRecoveryDialog:p,closeRecoveryDialog:f,dialogVisible:n,dialogData:a,showDialog:y,closeDialog:k}}),Gt=Object.freeze(Object.defineProperty({__proto__:null,useUiStore:ke},Symbol.toStringTag,{value:"Module"})),Ht=ce("settings",{state:()=>({difficulty:"normal",tutorialEnabled:!0,autoSave:!0,autoSaveInterval:5,soundEnabled:!0,soundVolume:.7,musicEnabled:!0,musicVolume:.5,language:"zh-CN",theme:"light",uiScale:1,animationsEnabled:!0,graphicsQuality:"medium",currentScene:"menu"}),actions:{updateSetting(e,t){e in this.$state&&(this[e]=t,this.saveSettings())},updateSettings(e){Object.entries(e).forEach(([t,r])=>{t in this.$state&&(this[t]=r)}),this.saveSettings()},resetSettings(){this.$reset(),this.saveSettings()},saveSettings(){try{const e=JSON.stringify(this.$state);localStorage.setItem("house-journey-settings",e)}catch(e){R(e,"SettingsStore",L.STORAGE,_.WARNING),console.error("ä¿å­˜è®¾ç½®å¤±è´¥:",e)}},loadSettings(){try{const e=localStorage.getItem("house-journey-settings");if(e){const t=JSON.parse(e);this.updateSettings(t)}}catch(e){R(e,"SettingsStore",L.STORAGE,_.WARNING),console.error("åŠ è½½è®¾ç½®å¤±è´¥:",e)}},setCurrentScene(e){this.currentScene=e,window.gameAudio&&this.musicEnabled&&window.gameAudio.playBGM(e)}}}),Lr=Object.freeze(Object.defineProperty({__proto__:null,useSettingsStore:Ht},Symbol.toStringTag,{value:"Module"})),G=ce("player",{state:()=>({name:"",money:2e3,debt:5e3,loanPrincipal:5e3,capacity:100,inventoryUsed:0,inventory:[],purchasedHouses:[],initialized:!1,bankDeposit:0,maxLoanAmount:2e4,statistics:{weekCount:1,transactionCount:0,totalProfit:0,maxMoney:2e3,visitedLocations:[],housePurchases:[],firstHousePurchaseWeek:null,mostExpensiveHouse:null,highestLevelHouse:null}}),actions:{addInventoryItem(e){return console.log("PlayerStore - ç›´æ¥æ·»åŠ ç‰©å“:",e),!e||!e.productId||!e.quantity?(console.error("PlayerStore - æ— æ•ˆçš„ç‰©å“å¯¹è±¡:",e),!1):(this.inventory.push(e),this.inventoryUsed+=e.quantity,console.log("PlayerStore - èƒŒåŒ…æ›´æ–°å:",{inventoryCount:this.inventory.length,inventoryUsed:this.inventoryUsed}),!0)},initializePlayer(e){return console.log("PlayerStore - åˆå§‹åŒ–ç©å®¶:",e),new Promise(t=>{setTimeout(()=>{this.name=e||D.global.t("system.defaultPlayerName"),this.money=2e3,this.debt=5e3,this.loanPrincipal=5e3,this.capacity=100,this.inventoryUsed=0,this.inventory=[],console.log("PlayerStore - åˆå§‹åŒ–èƒŒåŒ…:",{capacity:this.capacity,inventoryUsed:this.inventoryUsed,inventory:this.inventory}),this.purchasedHouses=[],this.initialized=!0,this.bankDeposit=0,this.maxLoanAmount=2e4,this.statistics={weekCount:1,transactionCount:0,totalProfit:0,maxMoney:2e3,visitedLocations:[],housePurchases:[],firstHousePurchaseWeek:null,mostExpensiveHouse:null,highestLevelHouse:null},console.log("PlayerStore - ç©å®¶åˆå§‹åŒ–å®Œæˆ"),t()},400)})},updateWeeklyPlayerState(e){if(this.statistics.weekCount=e,this.debt>0){const t=Math.floor(this.debt*.005);this.debt+=t}if(this.bankDeposit>0){const t=Math.floor(this.bankDeposit*.003);this.bankDeposit+=t}this.money>this.statistics.maxMoney&&(this.statistics.maxMoney=this.money)},addMoney(e){return e<=0?!1:(this.money+=e,this.money>this.statistics.maxMoney&&(this.statistics.maxMoney=this.money),!0)},spendMoney(e){return e<=0||e>this.money?!1:(this.money-=e,!0)},repayDebt(e){return e<=0||e>this.money?!1:(e>this.debt&&(e=this.debt),this.money-=e,this.debt-=e,e<=this.loanPrincipal?this.loanPrincipal-=e:this.loanPrincipal=0,!0)},addVisitedLocation(e){return this.statistics.visitedLocations.includes(e)?!1:(this.statistics.visitedLocations.push(e),!0)},purchaseHouse(e){if(!e||typeof e!="object")return console.error("æ— æ•ˆçš„æˆ¿å±‹å¯¹è±¡ä¼ é€’ç»™purchaseHouse"),!1;const t=["id","name","level","price"];for(const o of t)if(!(o in e))return console.error(`è´­ä¹°æˆ¿å±‹å¤±è´¥ï¼šæˆ¿å±‹å¯¹è±¡ç¼ºå°‘å¿…éœ€å±æ€§ ${o}`),!1;if(e.price>this.money)return console.warn(`è´­ä¹°å¤±è´¥ï¼šèµ„é‡‘ä¸è¶³ (æ‹¥æœ‰: ${this.money}, éœ€è¦: ${e.price}, å·®é¢: ${e.price-this.money})`),!1;if(this.purchasedHouses.some(o=>o.houseId===e.id))return console.warn(`è´­ä¹°å¤±è´¥ï¼šå·²æ‹¥æœ‰IDä¸º ${e.id} çš„æˆ¿å±‹`),!1;this.money-=e.price;const i=K().currentWeek,s={houseId:e.id,name:e.name,level:e.level,purchasePrice:e.price,purchaseWeek:i,description:e.description||`${e.level}çº§æˆ¿äº§`,purchaseDate:new Date().toISOString()};return this.purchasedHouses.push(s),this.statistics.housePurchases||(this.statistics.housePurchases=[]),this.statistics.housePurchases.push({houseId:e.id,name:e.name,level:e.level,price:e.price,week:i}),this.statistics.firstHousePurchaseWeek===null&&(this.statistics.firstHousePurchaseWeek=i),(!this.statistics.mostExpensiveHouse||e.price>this.statistics.mostExpensiveHouse.price)&&(this.statistics.mostExpensiveHouse={id:e.id,name:e.name,price:e.price,level:e.level,week:i}),(!this.statistics.highestLevelHouse||e.level>this.statistics.highestLevelHouse.level)&&(this.statistics.highestLevelHouse={id:e.id,name:e.name,price:e.price,level:e.level,week:i}),console.log(`æˆåŠŸè´­ä¹°æˆ¿äº§: ${e.name} - Â¥${e.price} (ç¬¬${i}å‘¨)`),!0},depositToBank(e){return e<=0||e>this.money?!1:(this.money-=e,this.bankDeposit+=e,!0)},withdrawFromBank(e){return e<=0||e>this.bankDeposit?!1:(this.bankDeposit-=e,this.money+=e,!0)},takeLoan(e){const t=this.availableLoanAmount;return e<=0||e>t?!1:(this.debt+=e,this.loanPrincipal+=e,this.money+=e,!0)}},getters:{netWorth:e=>{const t=e.inventory.reduce((i,s)=>i+s.quantity*s.purchasePrice,0),r=e.purchasedHouses.reduce((i,s)=>i+s.purchasePrice,0);return e.money+e.bankDeposit+t+r-e.debt},totalMoney:e=>{const t=e.inventory.reduce((r,i)=>r+i.quantity*i.purchasePrice,0);return e.money+t},hasHighestHouse:e=>e.purchasedHouses.some(t=>t.level>=5),mostExpensiveHouse:e=>e.purchasedHouses.length===0?null:e.purchasedHouses.reduce((t,r)=>r.purchasePrice>t.purchasePrice?r:t,e.purchasedHouses[0]),availableCapacity:e=>e.capacity-e.inventoryUsed,availableLoanAmount:e=>{e.loanPrincipal===void 0&&(e.loanPrincipal=e.debt);const t=e.maxLoanAmount;return Math.max(0,Math.floor(t-e.loanPrincipal))},depositInterestRate:()=>.003,loanInterestRate:()=>.005}}),ot=()=>{const e=G();return{addToInventory:(a,c,u)=>{if(console.log("InventoryActions - addToInventoryå¼€å§‹ - å‚æ•°:",{product:a?{id:a.id,name:a.name,category:a.category}:"null",quantity:c,price:u}),console.log("InventoryActions - å½“å‰èƒŒåŒ…çŠ¶æ€:",{inventoryUsed:e.inventoryUsed,capacity:e.capacity,inventoryCount:e.inventory.length}),!a||c<=0||u<0)return console.error("InventoryActions - å‚æ•°æ— æ•ˆ:",{product:a,quantity:c,price:u}),{success:!1,message:"æ— æ•ˆçš„äº§å“æ•°æ®"};if(!a.id)return console.error("InventoryActions - äº§å“å¯¹è±¡ç¼ºå°‘idå±æ€§:",a),{success:!1,message:"äº§å“å¯¹è±¡ç¼ºå°‘idå±æ€§"};console.log("InventoryActions - äº§å“å¯¹è±¡è¯¦æƒ…:",{id:a.id,name:a.name,hasToString:typeof a.toString=="function",prototype:Object.getPrototypeOf(a),ownProperties:Object.keys(a)});const g=c;if(e.inventoryUsed+g>e.capacity)return console.error(`InventoryActions - èƒŒåŒ…å®¹é‡ä¸è¶³: å½“å‰å·²ç”¨=${e.inventoryUsed}, éœ€è¦=${g}, æ€»å®¹é‡=${e.capacity}`),{success:!1,message:"èƒŒåŒ…å®¹é‡ä¸è¶³"};const m=a.id;console.log("InventoryActions - æŸ¥æ‰¾å•†å“ID:",m,"ç±»å‹:",typeof m);const p=e.inventory.findIndex(k=>k.productId===m||typeof m=="number"&&Number(k.productId)===m||String(k.productId)===String(m));console.log(`InventoryActions - æŸ¥æ‰¾ç»“æœ: ${p!==-1?"æ‰¾åˆ°":"æœªæ‰¾åˆ°"}, ç´¢å¼•=${p}`);const f=u*c;if(p!==-1){const k=e.inventory[p];console.log("InventoryActions - æ›´æ–°å·²æœ‰ç‰©å“:",{existingItem:{productId:k.productId,name:k.name,quantity:k.quantity,purchasePrice:k.purchasePrice}});const I=k.totalValue||k.purchasePrice*k.quantity,b=k.quantity+c,S=I+u*c,x=Math.round(S/b);console.log("InventoryActions - è®¡ç®—æ–°ä»·æ ¼:",{oldTotalValue:I,newTotalQuantity:b,newTotalValue:S,newAveragePrice:x}),e.inventory[p].quantity=b,e.inventory[p].purchasePrice=x,e.inventory[p].totalValue=S,console.log("InventoryActions - å·²æ›´æ–°ç‰©å“:",e.inventory[p])}else{let k=m;typeof m=="string"&&!isNaN(Number(m))&&(k=Number(m));const I={productId:k,name:a.name||`å•†å“${k}`,quantity:c,purchasePrice:u,totalValue:f,size:1};console.log("InventoryActions - æ·»åŠ æ–°ç‰©å“:",I),e.inventory.push(I),console.log("InventoryActions - æ·»åŠ åèƒŒåŒ…ç‰©å“æ•°é‡:",e.inventory.length),console.log("InventoryActions - æ·»åŠ åèƒŒåŒ…ç‰©å“åˆ—è¡¨:",e.inventory.map(b=>({productId:b.productId,name:b.name,quantity:b.quantity})))}const y=e.inventoryUsed;return e.inventoryUsed+=g,console.log(`InventoryActions - æ›´æ–°èƒŒåŒ…å®¹é‡: ${y} -> ${e.inventoryUsed}`),console.log("InventoryActions - å½“å‰èƒŒåŒ…ç‰©å“:",e.inventory.map(k=>({productId:k.productId,name:k.name,quantity:k.quantity}))),console.log("InventoryActions - èƒŒåŒ…æœ€ç»ˆçŠ¶æ€æ£€æŸ¥:",{inventoryArray:e.inventory,isArray:Array.isArray(e.inventory),length:e.inventory.length,isReactive:typeof e.inventory=="object"&&e.inventory.__v_isReactive}),Array.isArray(e.inventory)&&(e.inventory=[...e.inventory]),{success:!0}},removeFromInventory:(a,c)=>{if(a<0||a>=e.inventory.length)return{success:!1,message:"æ— æ•ˆçš„ç‰©å“ç´¢å¼•"};const u=e.inventory[a];if(c<=0||c>u.quantity)return{success:!1,message:"æ— æ•ˆçš„ç§»é™¤æ•°é‡"};const g=c,m={...u,quantity:c};return u.quantity-=c,u.quantity<=0&&e.inventory.splice(a,1),e.inventoryUsed-=g,{success:!0,product:m}},findByProductId:a=>e.inventory.filter(c=>c.productId===a),getTotalQuantity:a=>e.inventory.filter(c=>c.productId===a).reduce((c,u)=>c+u.quantity,0),getTotalValue:()=>e.inventory.reduce((a,c)=>a+c.quantity*c.purchasePrice,0),clearInventory:()=>{e.inventory=[],e.inventoryUsed=0}}},O={DAILY:"DAILY",FOOD:"FOOD",ELECTRONICS:"ELECTRONICS",LUXURY:"LUXURY",COLLECTIBLE:"COLLECTIBLE"};class $t{constructor({id:t,name:r,description:i="",basePrice:s,minPrice:o,maxPrice:n,volatility:a=5,category:c=O.DAILY,size:u=1,icon:g="box",availableAt:m=[]}){this.id=t,this.name=r,this.description=i,this.basePrice=s,this.minPrice=o,this.maxPrice=n,this.volatility=Math.min(Math.max(a,1),10),this.category=c,this.size=u,this.icon=g,this.availableAt=m}getPriceRange(){return{min:this.minPrice,max:this.maxPrice,range:this.maxPrice-this.minPrice}}isValidPrice(t){return t>=this.minPrice&&t<=this.maxPrice}adjustPriceToRange(t){return Math.max(this.minPrice,Math.min(t,this.maxPrice))}}function st(e){return new $t(e)}const nt=[{id:101,name:"å«ç”Ÿçº¸",description:"æ—¥å¸¸å¿…å¤‡ç”¨å“",basePrice:15,minPrice:10,maxPrice:30,volatility:2,category:O.DAILY,size:3,icon:"paper",availableAt:["commodity_market"]},{id:102,name:"æ´—å‘æ°´",description:"æ—¥å¸¸æ´—æŠ¤ç”¨å“",basePrice:35,minPrice:20,maxPrice:50,volatility:2,category:O.DAILY,size:1,icon:"bottle",availableAt:["commodity_market"]},{id:103,name:"ç‰™è†",description:"æ—¥å¸¸æ´—æŠ¤ç”¨å“",basePrice:8,minPrice:5,maxPrice:15,volatility:2,category:O.DAILY,size:1,icon:"hygiene",availableAt:["commodity_market"]},{id:104,name:"è‚¥çš‚",description:"æ—¥å¸¸æ´—æŠ¤ç”¨å“",basePrice:6,minPrice:3,maxPrice:12,volatility:2,category:O.DAILY,size:1,icon:"soap",availableAt:["commodity_market"]},{id:105,name:"æ¯›å·¾",description:"æ—¥å¸¸æ´—æŠ¤ç”¨å“",basePrice:25,minPrice:15,maxPrice:40,volatility:2,category:O.DAILY,size:2,icon:"towel",availableAt:["commodity_market"]},{id:106,name:"äºŒæ‰‹iPhone",description:"äºŒæ‰‹è‹¹æœæ‰‹æœºï¼Œæ€§ä»·æ¯”é«˜ï¼Œç‰ˆæœ¬å„å¼‚",basePrice:2e3,minPrice:1e3,maxPrice:4e3,volatility:5,category:O.ELECTRONICS,size:1,icon:"phone",availableAt:["second_hand_market"]},{id:107,name:"äºŒæ‰‹ç¬”è®°æœ¬",description:"äºŒæ‰‹ç¬”è®°æœ¬ç”µè„‘ï¼Œä»·æ ¼å®æƒ ä½†é…ç½®å„å¼‚",basePrice:2500,minPrice:1200,maxPrice:5e3,volatility:5,category:O.ELECTRONICS,size:5,icon:"laptop",availableAt:["second_hand_market"]},{id:108,name:"å¤å¤ç›¸æœº",description:"èƒ¶ç‰‡ç›¸æœºï¼Œæœ‰ä¸€å®šæ”¶è—ä»·å€¼",basePrice:500,minPrice:300,maxPrice:1200,volatility:6,category:O.ELECTRONICS,size:3,icon:"camera",availableAt:["second_hand_market"]},{id:109,name:"äºŒæ‰‹æ¸¸æˆæœº",description:"å„ç±»æ¸¸æˆä¸»æœºï¼Œä»·æ ¼å®æƒ ",basePrice:800,minPrice:500,maxPrice:1800,volatility:4,category:O.ELECTRONICS,size:4,icon:"game",availableAt:["second_hand_market"]},{id:110,name:"æ—§ä¹¦ç±",description:"äºŒæ‰‹ä¹¦ç±ï¼ŒçŸ¥è¯†çš„è½½ä½“ï¼Œä»·æ ¼ä¾¿å®œ",basePrice:20,minPrice:5,maxPrice:50,volatility:2,category:O.DAILY,size:2,icon:"book",availableAt:["second_hand_market"]},{id:201,name:"é¸¡è›‹",description:"æ–°é²œé£Ÿå“ï¼Œä»·æ ¼æ³¢åŠ¨è¾ƒå¤§",basePrice:15,minPrice:8,maxPrice:25,volatility:4,category:O.FOOD,size:2,icon:"egg",availableAt:["commodity_market"]},{id:202,name:"å¤§ç±³",description:"ä¸»é£Ÿï¼Œä»·æ ¼ç›¸å¯¹ç¨³å®š",basePrice:50,minPrice:30,maxPrice:80,volatility:4,category:O.FOOD,size:5,icon:"rice",availableAt:["commodity_market"]},{id:203,name:"é£Ÿç”¨æ²¹",description:"çƒ¹é¥ªå¿…å¤‡ï¼Œä»·æ ¼æ³¢åŠ¨é€‚ä¸­",basePrice:70,minPrice:40,maxPrice:120,volatility:4,category:O.FOOD,size:3,icon:"oil",availableAt:["commodity_market"]},{id:204,name:"æ–°é²œè”¬èœ",description:"æ—¶ä»¤è”¬èœï¼Œä»·æ ¼æ³¢åŠ¨è¾ƒå¤§",basePrice:30,minPrice:15,maxPrice:50,volatility:4,category:O.FOOD,size:4,icon:"vegetable",availableAt:["commodity_market"]},{id:205,name:"æ°´æœ",description:"æ—¶ä»¤æ°´æœï¼Œä»·æ ¼æ³¢åŠ¨è¾ƒå¤§",basePrice:35,minPrice:20,maxPrice:60,volatility:4,category:O.FOOD,size:4,icon:"fruit",availableAt:["commodity_market"]},{id:301,name:"æ‰‹æœº",description:"æ™ºèƒ½æ‰‹æœºï¼Œä»·æ ¼æ³¢åŠ¨é€‚ä¸­",basePrice:1800,minPrice:1e3,maxPrice:3e3,volatility:6,category:O.ELECTRONICS,size:1,icon:"phone",availableAt:["electronics_hub","premium_mall"]},{id:302,name:"ç”µè§†",description:"å®¶ç”¨ç”µè§†ï¼Œä»·æ ¼æ³¢åŠ¨é€‚ä¸­",basePrice:3500,minPrice:2e3,maxPrice:6e3,volatility:6,category:O.ELECTRONICS,size:15,icon:"tv",availableAt:["electronics_hub"]},{id:303,name:"ç¬”è®°æœ¬ç”µè„‘",description:"ä¾¿æºå¼ç”µè„‘ï¼Œä»·æ ¼æ³¢åŠ¨é€‚ä¸­",basePrice:4500,minPrice:3e3,maxPrice:8e3,volatility:6,category:O.ELECTRONICS,size:5,icon:"laptop",availableAt:["electronics_hub"]},{id:304,name:"å¹³æ¿ç”µè„‘",description:"è§¦å±å¹³æ¿è®¾å¤‡ï¼Œä»·æ ¼æ³¢åŠ¨é€‚ä¸­",basePrice:2e3,minPrice:1200,maxPrice:3500,volatility:6,category:O.ELECTRONICS,size:3,icon:"tablet",availableAt:["electronics_hub"]},{id:305,name:"æ™ºèƒ½æ‰‹è¡¨",description:"å¯ç©¿æˆ´è®¾å¤‡ï¼Œä»·æ ¼æ³¢åŠ¨è¾ƒå¤§",basePrice:1500,minPrice:800,maxPrice:2500,volatility:7,category:O.ELECTRONICS,size:1,icon:"watch",availableAt:["electronics_hub","premium_mall"]},{id:401,name:"åç‰Œæ‰‹è¡¨",description:"å¥¢ä¾ˆå“ï¼Œä»·æ ¼æ˜‚è´µä½†ä¿å€¼",basePrice:12e3,minPrice:8e3,maxPrice:2e4,volatility:8,category:O.LUXURY,size:1,icon:"luxury-watch",availableAt:["premium_mall"]},{id:402,name:"é’»çŸ³é¡¹é“¾",description:"å¥¢ä¾ˆå“ï¼Œä»·æ ¼æ˜‚è´µä¸”æ³¢åŠ¨è¾ƒå¤§",basePrice:15e3,minPrice:1e4,maxPrice:25e3,volatility:8,category:O.LUXURY,size:1,icon:"diamond",availableAt:["premium_mall"]},{id:403,name:"è®¾è®¡å¸ˆåŒ…åŒ…",description:"é«˜æ¡£æ‰‹è¢‹ï¼Œæœ‰ä¸€å®šä¿å€¼èƒ½åŠ›",basePrice:8e3,minPrice:5e3,maxPrice:15e3,volatility:7,category:O.LUXURY,size:2,icon:"bag",availableAt:["premium_mall"]},{id:404,name:"é«˜çº§é¦™æ°´",description:"çŸ¥åå“ç‰Œé¦™æ°´ï¼Œä»·æ ¼é€‚ä¸­",basePrice:1200,minPrice:800,maxPrice:2e3,volatility:5,category:O.LUXURY,size:1,icon:"perfume",availableAt:["premium_mall"]},{id:501,name:"å¤è‘£èŠ±ç“¶",description:"æ”¶è—å“ï¼Œä»·æ ¼æ³¢åŠ¨éå¸¸å¤§",basePrice:9e3,minPrice:4e3,maxPrice:2e4,volatility:9,category:O.COLLECTIBLE,size:4,icon:"vase",availableAt:["black_market"]},{id:502,name:"é‚®ç¥¨",description:"æ”¶è—é‚®ç¥¨ï¼Œä»·æ ¼æ³¢åŠ¨æå¤§",basePrice:3e3,minPrice:1e3,maxPrice:1e4,volatility:10,category:O.COLLECTIBLE,size:1,icon:"stamp",availableAt:["black_market"]},{id:503,name:"å¤ç”»",description:"è‰ºæœ¯æ”¶è—å“ï¼Œä»·æ ¼æ³¢åŠ¨æå¤§",basePrice:2e4,minPrice:1e4,maxPrice:5e4,volatility:10,category:O.COLLECTIBLE,size:8,icon:"painting",availableAt:["black_market"]},{id:504,name:"è€å¼ç›¸æœº",description:"å¤è‘£ç›¸æœºï¼Œæ”¶è—ä»·å€¼é«˜",basePrice:4500,minPrice:2e3,maxPrice:1e4,volatility:8,category:O.COLLECTIBLE,size:3,icon:"camera",availableAt:["black_market","electronics_hub"]},{id:505,name:"çºªå¿µå¸",description:"é™é‡å‘è¡Œçš„çºªå¿µå¸ï¼Œæ”¶è—ä»·å€¼é«˜",basePrice:2500,minPrice:1e3,maxPrice:8e3,volatility:9,category:O.COLLECTIBLE,size:1,icon:"coin",availableAt:["black_market"]}];function _e(){return nt.map(e=>st(e))}function Dt(e){const t=nt.find(r=>r.id==e);return t?st(t):null}class Ut{constructor({id:t,name:r,description:i="",availableProducts:s=[],specialProducts:o=[],modifiers:n={priceFactor:1},icon:a="map-marker",image:c="",eventProbability:u=.3}){this.id=t,this.name=r,this.description=i,this.availableProducts=s,this.specialProducts=o,this.modifiers=n,this.icon=a,this.image=c,this.eventProbability=u}getPriceFactor(){return this.modifiers.priceFactor||1}isSpecialProduct(t){return this.specialProducts.includes(t)}hasProduct(t){return this.availableProducts.includes(t)||this.specialProducts.includes(t)}applyPriceModifiers(t,r){let i=t*this.getPriceFactor();return this.isSpecialProduct(r)&&(i*=.85),Math.round(i)}}function jt(e){return new Ut(e)}const Ft=[{id:"commodity_market",name:"å¤§å®—å•†å“äº¤æ˜“æ‰€",description:"æ‰¹å‘å¸‚åœºå’Œå¤§å®—å•†å“äº¤æ˜“çš„é›†ä¸­åœ°ï¼Œä»·æ ¼ä½å»‰ä½†éœ€è¦å¤§é‡é‡‡è´­ã€‚è¿™é‡Œé€‚åˆå¤§é‡è¿›è´§è·å–æ›´å¥½çš„ä»·æ ¼ä¼˜åŠ¿ã€‚",modifiers:{priceFactor:.75},specialProducts:[202,203],availableProducts:["bulk_rice","bulk_goods","industrial_materials"],eventProbability:.2,icon:"commodity.png",image:"commodity_market.jpg"},{id:"second_hand_market",name:"äºŒæ‰‹å¸‚åœº",description:"å„ç±»äºŒæ‰‹å•†å“çš„é›†æ•£åœ°ï¼Œå°¤å…¶ä»¥äºŒæ‰‹æ•°ç äº§å“ä¸ºç‰¹è‰²ã€‚è¿™é‡Œå¯ä»¥æ·˜åˆ°ä»·æ ¼å®æƒ çš„ç”µå­äº§å“å’Œå„ç±»äºŒæ‰‹ç‰©å“ï¼Œä½†å“è´¨å‚å·®ä¸é½ã€‚",modifiers:{priceFactor:.8},specialProducts:[],availableProducts:["used_electronics","retro_games","collectibles","books","used_items"],eventProbability:.3,icon:"second-hand.png",image:"second_hand_market.jpg"},{id:"premium_mall",name:"é«˜ç«¯å•†åŸ",description:"æ±‡èšå„ç±»é«˜ç«¯å“ç‰Œå’Œå¥¢ä¾ˆå“çš„è´­ç‰©ä¸­å¿ƒï¼Œä»·æ ¼æ˜‚è´µä½†å“è´¨ä¼˜è‰¯ã€‚è¿™é‡Œæ˜¯è´­ä¹°ç å®ã€æ‰‹è¡¨ç­‰é«˜ç«¯å•†å“çš„åœ°æ–¹ã€‚",modifiers:{priceFactor:1.3},specialProducts:[401,404],availableProducts:["jewelry","watch","designer_clothes"],eventProbability:.25,icon:"premium.png",image:"premium_mall.jpg"},{id:"electronics_hub",name:"ç”µå­ç§‘æŠ€åŸ",description:"å„ç±»ç”µå­äº§å“å’Œæ•°ç è®¾å¤‡çš„ä¸“ä¸šäº¤æ˜“å¸‚åœºï¼Œä»·æ ¼é€‚ä¸­ä¸”å“ç§é½å…¨ã€‚è¿™é‡Œæ˜¯è´­ä¹°æ‰‹æœºã€ç”µè„‘ç­‰ç”µå­äº§å“çš„ç†æƒ³ä¹‹åœ°ã€‚",modifiers:{priceFactor:.95},specialProducts:[301,305],availableProducts:["phone","laptop","tablet","camera"],eventProbability:.3,icon:"electronics.png",image:"electronics_hub.jpg"},{id:"black_market",name:"åœ°ä¸‹é»‘å¸‚",description:"éšè”½çš„éæ³•äº¤æ˜“åœºæ‰€ï¼Œå„ç±»çç¨€æ”¶è—å“å’Œå¥‡ç‰¹å•†å“äº‘é›†ã€‚é£é™©ä¸æœºé‡å¹¶å­˜ï¼Œæ˜¯å¯»æ‰¾ç¨€æœ‰ç‰©å“çš„ç»ä½³åœ°ç‚¹ã€‚",modifiers:{priceFactor:1.1},specialProducts:[502,503],availableProducts:["stamp","antique","artwork","rare_coin"],eventProbability:.35,icon:"black-market.png",image:"black_market.jpg"}];function Vt(){return Ft.map(e=>jt(e))}class qt{constructor({id:t,name:r,price:i,level:s=1,description:o="",specialFeature:n="",purchaseCondition:a="",image:c=""}){this.id=t,this.name=r,this.price=i,this.level=s,this.description=o,this.specialFeature=n,this.purchaseCondition=a||`éœ€è¦${i}å…ƒç°é‡‘`,this.image=c||Bt(t)}canBePurchasedWith(t){return t>=this.price}getValueRating(){return this.price<4e5?7:this.price<8e5?6:this.price<15e5?5:this.price<25e5?4:3}}function zt(e){return new qt(e)}function Bt(e){try{return!e||e==="undefined"||e==="null"?"/resources/assets/images/house_1.jpeg":Nt(e)}catch(t){console.warn("è·å–æˆ¿å±‹å›¾ç‰‡è·¯å¾„æ—¶å‡ºé”™:",t);const r={apartment:"/resources/assets/images/house_1.jpeg",second_hand:"/resources/assets/images/house_2.jpeg",highend:"/resources/assets/images/house_3.jpeg",villa:"/resources/assets/images/house_4.jpeg",mansion:"/resources/assets/images/house_5.jpeg"};if(!isNaN(parseInt(e))){const i=parseInt(e);return`/resources/assets/images/house_${i?Math.max(1,Math.min(5,i%5||1)):1}.jpeg`}return r[e]||"/resources/assets/images/house_1.jpeg"}}const Yt=[{id:"apartment",name:"å•èº«å…¬å¯“",price:35e4,level:1,description:"é€‚åˆå•èº«äººå£«å±…ä½çš„å°å‹å…¬å¯“ï¼Œä½ç½®ä¾¿åˆ©ä½†ç©ºé—´æœ‰é™ã€‚è¿™æ˜¯è¿ˆå‘æˆ¿äº§é˜¶æ¢¯çš„ç¬¬ä¸€æ­¥ï¼",specialFeature:"äº¤é€šä¾¿åˆ©ï¼Œæœˆä¾›è¾ƒä½ï¼Œé¦–æ¬¡ç½®ä¸šçš„ç†æƒ³é€‰æ‹©",image:"/resources/assets/images/house_1.jpeg"},{id:"second_hand",name:"äºŒæ‰‹æ—§æˆ¿",price:58e4,level:2,description:"å¹´ä»£è¾ƒä¹…çš„äºŒæ‰‹ä½å®…ï¼Œä»·æ ¼é€‚ä¸­ä½†å¯èƒ½éœ€è¦è£…ä¿®ã€‚ç©ºé—´è¾ƒå¤§ï¼Œéå¸¸é€‚åˆæ”¹é€ æˆç†æƒ³çš„å®¶ã€‚",specialFeature:"ç©ºé—´è¾ƒå¤§ï¼Œå‘¨è¾¹é…å¥—å®Œå–„ï¼Œæ€§ä»·æ¯”è¾ƒé«˜",image:"/resources/assets/images/house_2.jpeg"},{id:"highend",name:"é«˜æ¡£å°åŒº",price:8e5,level:3,description:"ç°ä»£åŒ–é«˜æ¡£ä½å®…å°åŒºï¼Œç¯å¢ƒä¼˜ç¾ï¼Œé…å¥—è®¾æ–½é½å…¨ã€‚ç¤¾åŒºç¯å¢ƒå®‰å…¨ï¼Œæ˜¯å®¶åº­å±…ä½çš„ç»ä½³é€‰æ‹©ã€‚",specialFeature:"ç¯å¢ƒä¼˜ç¾ï¼Œç‰©ä¸šç®¡ç†å®Œå–„ï¼Œç¤¾åŒºæ´»åŠ¨ä¸°å¯Œ",image:"/resources/assets/images/house_3.jpeg"},{id:"villa",name:"ç°ä»£åˆ«å¢…",price:15e5,level:4,description:"ç‹¬æ ‹ç°ä»£åˆ«å¢…ï¼Œæ‹¥æœ‰ç§å®¶èŠ±å›­å’Œè½¦åº“ã€‚å®½æ•çš„ç©ºé—´å’Œç²¾è‡´çš„è®¾è®¡ï¼Œå½°æ˜¾ä¸»äººçš„å“å‘³ä¸åœ°ä½ã€‚",specialFeature:"ç‹¬ç«‹ç©ºé—´ï¼Œå±…ä½å“è´¨é«˜ï¼Œæ˜¯æˆåŠŸäººå£«çš„æ ‡å¿—",image:"/resources/assets/images/house_4.jpeg"},{id:"mansion",name:"ç§äººåº„å›­",price:3e6,level:5,description:"å¤§å‹ç§äººåº„å›­ï¼Œå¸¦æœ‰å¤§ç‰‡ç»¿åœ°å’Œå¤šåŠŸèƒ½åŒºåŸŸã€‚æ‹¥æœ‰è¿™æ ·çš„æˆ¿äº§ï¼Œä»£è¡¨ä½ å·²è¾¾åˆ°äººç”Ÿå·…å³°ï¼",specialFeature:"ç»ˆæè±ªå®…ï¼Œç§å¯†æ€§æä½³ï¼Œç¤¾ä¼šåœ°ä½çš„è±¡å¾",image:"/resources/assets/images/house_5.jpeg"}];function Ue(){return Yt.map(e=>zt(e))}const P={RISING_STRONG:"rising_strong",RISING:"rising",STABLE_HIGH:"stable_high",STABLE:"stable",STABLE_LOW:"stable_low",FALLING:"falling",FALLING_STRONG:"falling_strong",VOLATILE:"volatile"},Te=new Map;function fe(e){if(e=e%(2*Math.PI),e===0||e===Math.PI)return 0;if(e===Math.PI/2)return 1;if(e===3*Math.PI/2)return-1;const t=e*e,r=t*e,i=r*t,s=i*t;return e-r/6+i/120-s/5040}function Kt(e,t,r,i,s){const o=`${e.id}_${t}_${(r==null?void 0:r.price)||0}_${i}_${JSON.stringify(s)}`;if(Te.has(o))return Te.get(o);const n=Jt(e,t,r,i,s);return Te.set(o,n),n}function Ze(){Te.clear(),console.log("ä»·æ ¼è®¡ç®—ç¼“å­˜å·²æ¸…é™¤")}function Jt(e,t,r=null,i=1,s={}){var Ie,Ae,Re,we,Oe,xe;const o=(r==null?void 0:r.price)||e.basePrice,n=(r==null?void 0:r.trend)||P.STABLE,a=e.id,c=e.minPrice,u=e.maxPrice,g=e.volatility,m=e.category,p=t&1023,f=.6+g*.15,y={[P.RISING]:.05,[P.RISING_STRONG]:.08,[P.FALLING]:-.12,[P.FALLING_STRONG]:-.15,[P.STABLE]:-.01,[P.STABLE_HIGH]:-.04,[P.STABLE_LOW]:.02,[P.VOLATILE]:-.02},I=(a*1e3+t)%997/997,b=Math.random();let S;I<.3?S=b<.75?y[n]||0:(Math.random()-.35)*.08:S=b<.75?y[n]||0:(Math.random()-.65)*.08;const x=(()=>{console.log("è®¡ç®—ç±»åˆ«å‘¨æœŸå› å­:",{category:m,weekMod:p});let z=0;switch(m){case"DAILY":z=fe(p*.077)*.1-.03;break;case"FOOD":z=fe(p*.167)*.2-.05;break;case"ELECTRONICS":z=fe(p*.1)*.15-.08;break;case"LUXURY":z=fe(p*.067)*.25-.03;break;case"COLLECTIBLE":const w=fe(p*.125)*.3-.04,W=Math.cos(p*.2)*.15-.02;z=w+W;break;default:z=0}const M=(a%10-5)*.01;return z+=M,console.log("ç±»åˆ«å‘¨æœŸå› å­ç»“æœ:",z),z})(),T=a%10*.1,A=fe((p+T)*.1+(a&15)*.01)*.12-.03,C=i||1,F=(Ie=s.specialProducts)!=null&&Ie.includes(a)?.8:1,V=.9+(Math.sin(a*t*.01)*.5+.5)*.16,ee=s.globalPriceModifier||1,q=((Ae=s.categoryModifiers)==null?void 0:Ae[m])||1,ue=((Re=s.productModifiers)==null?void 0:Re[a])||1,le=s.currentLocationId;let de=1,me=1;le&&(de=((we=s.locationModifiers)==null?void 0:we[le])||1,(xe=(Oe=s.locationProductModifiers)==null?void 0:Oe[le])!=null&&xe[a]&&(me=s.locationProductModifiers[le][a]),(de!==1||me!==1)&&console.log(`åº”ç”¨åœ°åŒºä»·æ ¼ä¿®æ­£ - åœ°åŒº: ${le}, å•†å“: ${a}, åœ°åŒºä¿®æ­£: ${de.toFixed(2)}, åœ°åŒºå•†å“ä¿®æ­£: ${me.toFixed(2)}`));const Me=f*(1+S)*(1+x)*(1+A)*C*F*V*ee*q*ue*de*me,Le=.005;let ye=Me;Math.abs(Me-1)<Le&&(ye=1+(a*t%2===0?1:-1)*(Le+Math.random()*.01),console.log(`å•†å“ ${a} ä»·æ ¼å˜åŒ–å¤ªå°ï¼Œå¼ºåˆ¶è°ƒæ•´ä¸º ${((ye-1)*100).toFixed(2)}%`));let te=o*ye;te=Xt(te,o,e,s),te=Math.max(c,Math.min(te,u));const ve=(te-e.basePrice)/e.basePrice,Ne=Qt(ve,te,c,u);return{price:Math.round(te),trend:Ne,changePercent:parseFloat((ve*100).toFixed(1)),originalPricePercent:ve}}function Xt(e,t,r,i){const s=r.volatility/10,o=i.volatilityMultiplier||1,a=.2*(1+s)*o,c=t*(1+a),u=t*(1-a),g=t*.005;if(Math.abs(e-t)<g){const y=r.id%2===0?1:-1;e=t*(1+y*(.005+Math.random()*.01))}let m=Math.max(u,Math.min(e,c));const p=r.minPrice+(r.maxPrice-r.minPrice)*.5,f=Math.abs(m-p)/(r.maxPrice-r.minPrice);if(f>.4){const y=(f-.4)*.05,k=m>p?-1:1,I=y*(r.maxPrice-r.minPrice)*k;m+=I}return m}function Qt(e,t,r,i){if(e>.15)return P.RISING_STRONG;if(e>.05)return P.RISING;if(e<-.15)return P.FALLING_STRONG;if(e<-.05)return P.FALLING;const c=i-r;if(c<=0)return P.STABLE;const u=(t-r)/c;return u>.8?P.STABLE_HIGH:u<.2?P.STABLE_LOW:P.STABLE}function Zt(e,t,r={},i={}){console.time("BatchPriceUpdate"),i.currentLocation&&(i.currentLocationId=i.currentLocation.id);const s={},o=e.length;console.log(`æ‰¹é‡æ›´æ–°ä»·æ ¼ - å•†å“æ€»æ•°: ${o}, å½“å‰å‘¨æ•°: ${t}, å¸‚åœºä¿®æ­£å› å­:`,{global:i.globalPriceModifier||1,categories:Object.keys(i.categoryModifiers||{}).length,products:Object.keys(i.productModifiers||{}).length,locations:Object.keys(i.locationModifiers||{}).length,locationProducts:Object.keys(i.locationProductModifiers||{}).reduce((n,a)=>n+Object.keys(i.locationProductModifiers[a]||{}).length,0),currentLocationId:i.currentLocationId});for(let n=0;n<o;n++){const a=e[n],c=a.id,u=r[c]||null;try{s[c]=Kt(a,t,u,1,i)}catch(g){console.error(`æ›´æ–°å•†å“ ${c} ä»·æ ¼æ—¶å‡ºé”™:`,g),s[c]={price:a.basePrice,trend:"stable",changePercent:0}}}return console.timeEnd("BatchPriceUpdate"),s}function er(e){return{[P.RISING_STRONG]:"å¤§å¹…ä¸Šæ¶¨",[P.RISING]:"ä¸Šæ¶¨",[P.STABLE_HIGH]:"é«˜ä½ç¨³å®š",[P.STABLE]:"ç¨³å®š",[P.STABLE_LOW]:"ä½ä½ç¨³å®š",[P.FALLING]:"ä¸‹è·Œ",[P.FALLING_STRONG]:"å¤§å¹…ä¸‹è·Œ",[P.VOLATILE]:"å‰§çƒˆæ³¢åŠ¨"}[e]||"æœªçŸ¥"}function tr(e){return{[P.RISING_STRONG]:"â†‘â†‘",[P.RISING]:"â†‘",[P.STABLE_HIGH]:"â†—",[P.STABLE]:"â†’",[P.STABLE_LOW]:"â†˜",[P.FALLING]:"â†“",[P.FALLING_STRONG]:"â†“â†“",[P.VOLATILE]:"â†•"}[e]||"â†’"}function rr(e){return{[P.RISING_STRONG]:"#e53935",[P.RISING]:"#f44336",[P.STABLE_HIGH]:"#ff9800",[P.STABLE]:"#9e9e9e",[P.STABLE_LOW]:"#8bc34a",[P.FALLING]:"#4caf50",[P.FALLING_STRONG]:"#2e7d32",[P.VOLATILE]:"#9c27b0"}[e]||"#9e9e9e"}const ir=()=>{const e=B();return{updateProductPrices:o=>{console.log("å¼€å§‹æ›´æ–°äº§å“ä»·æ ¼ï¼Œå½“å‰å‘¨æ•°:",o);const n=e.products;console.log("äº§å“æ€»æ•°:",n.length);const a={...e.productPrices},c=e.marketModifiers;console.log("å¸‚åœºä¿®æ­£å› å­:",c),Ze();const u=Zt(n,o,a,c);console.log("æ‰¹é‡æ›´æ–°åçš„æ–°ä»·æ ¼æ•°é‡:",Object.keys(u).length),Object.keys(u).forEach(g=>{var k,I;const m=a[g]||{price:0,history:[]},p=u[g],f=m.price||((k=n.find(b=>b.id===Number(g)))==null?void 0:k.basePrice)||0;if(!(Math.abs(p.price-f)>=1)||Math.abs(p.changePercent)<1){const S=parseInt(g)||0,x=o||0,T=(S*31+x)%100,A=T<30?1:-1,C=Math.abs(Math.sin(T*.1))*12,F=Math.max(3,C),N=1+A*F/100;p.price=Math.round(f*N),console.log(`å¼ºåˆ¶ä»·æ ¼æ³¢åŠ¨ - å•†å“ID: ${g}, åŸä»·: ${f}, æ–°ä»·: ${p.price}, æ–¹å‘: ${A>0?"ä¸Šæ¶¨":"ä¸‹è·Œ"}, å˜åŒ–å¹…åº¦: ${F.toFixed(1)}%`)}if(p.changePercent===0&&f>0){const b=((I=n.find(S=>S.id===Number(g)))==null?void 0:I.basePrice)||f;p.changePercent=(p.price-b)/b*100,p.changePercent=parseFloat(p.changePercent.toFixed(1))}e.productPrices[g]={price:p.price,prevPrice:f,trend:p.trend,changePercent:p.changePercent,originalPricePercent:p.originalPricePercent,history:[...m.history||[],p.price].slice(-20)};const y=n.find(b=>b.id===Number(g));if(y){console.log(`å•†å“ ${y.name}(ID:${g}) ä»·æ ¼æ›´æ–° - åŸºç¡€ä»·æ ¼: ${y.basePrice}, å½“å‰ä»·æ ¼: ${p.price}, å†å²: [${e.productPrices[g].history.join(", ")}]`);const{trend:b,changePercent:S}=e.calculateLongTermTrend(g,y.basePrice);e.productPrices[g].trend=b,e.productPrices[g].changePercent=S,console.log(`å•†å“ ${y.name}(ID:${g}) è¶‹åŠ¿æ›´æ–° - è¶‹åŠ¿: ${b}, å˜åŒ–ç™¾åˆ†æ¯”: ${S}%`)}}),e.updateLocationProducts(),console.log("ä»·æ ¼æ›´æ–°å®Œæˆ")},getProductTrendInfo:o=>{const n=e.getProductPriceTrend(o);return{text:er(n),icon:tr(n),color:rr(n)}},getPriceChangeText:o=>{const n=e.productPrices[o];if(!n||n.changePercent===void 0)return"0%";const a=n.changePercent;return`${a>0?"+":""}${a.toFixed(1)}%`},measurePricePerformance:(o,n)=>null,clearPriceCache:Ze}},B=ce("market",{state:()=>({locations:[],currentLocation:null,productPrices:{},products:[],availableProducts:[],houses:[],marketModifiers:{globalPriceModifier:1,categoryModifiers:{},productModifiers:{},locationModifiers:{},locationProductModifiers:{},weeksSinceLastGlobalChange:0,categoryUnchangedWeeks:{},productUnchangedWeeks:{},locationUnchangedWeeks:{},locationProductUnchangedWeeks:{}},initialized:!1}),actions:{initializeMarket(){return new Promise((e,t)=>{try{setTimeout(()=>{this.locations=Vt(),this.products=_e(),console.log("MarketStore - åˆå§‹åŒ–äº§å“æ•°é‡:",this.products.length),console.log("MarketStore - äº§å“ç¤ºä¾‹:",this.products.slice(0,2).map(r=>({id:r.id,name:r.name,category:r.category}))),this.houses=Ue(),this.initializeProductPrices(),this.marketModifiers={globalPriceModifier:1,categoryModifiers:{},productModifiers:{},locationModifiers:{},locationProductModifiers:{},weeksSinceLastGlobalChange:0,categoryUnchangedWeeks:{},productUnchangedWeeks:{},locationUnchangedWeeks:{},locationProductUnchangedWeeks:{}},this.locations.length>0&&(this.changeLocation(this.locations[0].id),this.updateLocationProducts()),this.initialized=!0,console.log("MarketStore - å¸‚åœºåˆå§‹åŒ–å®Œæˆ"),console.log("å¯ç”¨å•†å“æ•°é‡:",this.availableProducts.length),e()},500)}catch(r){R(r,"marketState (market)",L.UNKNOWN,_.ERROR),console.error("MarketStore - åˆå§‹åŒ–å¸‚åœºå¤±è´¥:",r),t(r)}})},initializeProductPrices(){this.productPrices={},this.products.forEach(e=>{const t=Math.floor(Math.random()*(e.maxPrice-e.minPrice)+e.minPrice);this.productPrices[e.id]={price:t,trend:P.STABLE,history:[t],changePercent:0}})},updateMarketState(e){console.log("MarketStore - æ›´æ–°å¸‚åœºçŠ¶æ€, å½“å‰å‘¨æ•°:",e),this.updateMarketModifiers();try{const{updateProductPrices:t}=ir();if(typeof t!="function"){console.error("MarketStore - updateProductPrices ä¸æ˜¯ä¸€ä¸ªå‡½æ•°");return}this.currentLocation&&(this.marketModifiers.currentLocation=this.currentLocation),t(e),console.log("MarketStore - å•†å“ä»·æ ¼å·²æ›´æ–°")}catch(t){console.error("MarketStore - æ›´æ–°å•†å“ä»·æ ¼æ—¶å‡ºé”™:",t)}this.updateLocationProducts()},updateMarketModifiers(){const e=this.marketModifiers;if(console.log("MarketStore - æ›´æ–°å¸‚åœºè°ƒæ•´å› å­"),e.weeksSinceLastGlobalChange++,e.weeksSinceLastGlobalChange>=Math.max(4,Math.floor(Math.random()*5)+4)&&(e.weeksSinceLastGlobalChange=0,Math.random()<.7)){const r=e.globalPriceModifier,i=(Math.random()-.5)*.2;e.globalPriceModifier=Math.max(.8,Math.min(1.2,r+i)),console.log(`MarketStore - å…¨å±€ä»·æ ¼ä¿®æ­£å› å­å·²æ›´æ–°: ${r.toFixed(2)} -> ${e.globalPriceModifier.toFixed(2)}`)}if(["food","electronics","luxury","daily","collectible"].forEach(r=>{if(e.categoryUnchangedWeeks[r]=(e.categoryUnchangedWeeks[r]||0)+1,e.categoryUnchangedWeeks[r]>=4||Math.random()<.3){e.categoryUnchangedWeeks[r]=0;const i=e.categoryModifiers[r]||1,s=(Math.random()-.5)*.3;e.categoryModifiers[r]=Math.max(.7,Math.min(1.3,i+s)),console.log(`MarketStore - ${r}ç±»åˆ«ä»·æ ¼ä¿®æ­£å› å­å·²æ›´æ–°: ${i.toFixed(2)} -> ${e.categoryModifiers[r].toFixed(2)}`)}}),Math.random()<.15){const r=Math.floor(Math.random()*3)+1,i=Object.keys(this.productPrices);for(let s=0;s<r&&i.length>0;s++){const o=Math.floor(Math.random()*i.length),n=i[o];e.productUnchangedWeeks[n]=0;const a=e.productModifiers[n]||1,c=(Math.random()-.5)*.6;e.productModifiers[n]=Math.max(.5,Math.min(1.5,a+c));const u=this.products.find(g=>g.id===Number(n));console.log(`MarketStore - å•†å“ä»·æ ¼ä¿®æ­£å› å­å·²æ›´æ–°: ${(u==null?void 0:u.name)||n} ${a.toFixed(2)} -> ${e.productModifiers[n].toFixed(2)}`)}}if(Math.random()<.2){const r=Math.floor(Math.random()*2)+1,i=this.locations.map(s=>s.id);for(let s=0;s<r&&i.length>0;s++){const o=Math.floor(Math.random()*i.length),n=i[o];e.locationUnchangedWeeks[n]=0;const a=e.locationModifiers[n]||1,c=(Math.random()-.5)*.4;e.locationModifiers[n]=Math.max(.6,Math.min(1.4,a+c));const u=this.locations.find(g=>g.id===n);console.log(`MarketStore - åœ°åŒºä»·æ ¼ä¿®æ­£å› å­å·²æ›´æ–°: ${(u==null?void 0:u.name)||n} ${a.toFixed(2)} -> ${e.locationModifiers[n].toFixed(2)}`)}}if(Math.random()<.1){const r=this.locations.map(a=>a.id),i=Math.floor(Math.random()*r.length),s=r[i],o=Math.floor(Math.random()*3)+1,n=Object.keys(this.productPrices);e.locationProductModifiers[s]||(e.locationProductModifiers[s]={}),e.locationProductUnchangedWeeks[s]||(e.locationProductUnchangedWeeks[s]={});for(let a=0;a<o&&n.length>0;a++){const c=Math.floor(Math.random()*n.length),u=n[c];e.locationProductUnchangedWeeks[s][u]=0;const g=e.locationProductModifiers[s][u]||1,m=(Math.random()-.5)*.8;e.locationProductModifiers[s][u]=Math.max(.4,Math.min(1.6,g+m));const p=this.products.find(y=>y.id===Number(u)),f=this.locations.find(y=>y.id===s);console.log(`MarketStore - åœ°åŒºå†…å•†å“ä»·æ ¼ä¿®æ­£å› å­å·²æ›´æ–°: ${(f==null?void 0:f.name)||s} çš„ ${(p==null?void 0:p.name)||u} ${g.toFixed(2)} -> ${e.locationProductModifiers[s][u].toFixed(2)}`)}}(e.globalPriceModifier<.8||e.globalPriceModifier>1.2)&&(e.globalPriceModifier=1)},changeLocation(e){const t=this.locations.find(r=>r.id===e);return t?(this.currentLocation=t,this.updateLocationProducts(),!0):!1},updateLocationProducts(){if(console.log("MarketStore - æ›´æ–°å½“å‰åœ°ç‚¹å¯ç”¨å•†å“"),!this.currentLocation){console.warn("MarketStore - æ›´æ–°å¯ç”¨å•†å“å¤±è´¥: å½“å‰åœ°ç‚¹æœªè®¾ç½®"),this.availableProducts=[];return}try{const e=this.getLocationAvailableProducts(this.currentLocation);console.log("MarketStore - å½“å‰åœ°ç‚¹å¯ç”¨å•†å“ID:",e),this.availableProducts=this.products.filter(t=>e.includes(t.id)).map(t=>{const r=this.getCurrentProductPrice(t.id),i=this.isSpecialProduct(t.id),{trend:s,changePercent:o}=this.calculateLongTermTrend(t.id,t.basePrice);return this.productPrices[t.id]&&(this.productPrices[t.id].trend=s,this.productPrices[t.id].changePercent=o),console.log(`å•†å“ ${t.name} - ä»·æ ¼: ${r}, è¶‹åŠ¿: ${s}, å˜åŒ–ç™¾åˆ†æ¯”: ${o}%`),{...t,currentPrice:r,trend:s,changePercent:o,isSpecial:i}}),console.log(`MarketStore - æ›´æ–°å®Œæˆï¼Œå¯ç”¨å•†å“æ•°é‡: ${this.availableProducts.length}`)}catch(e){R(e,"marketState (market)",L.UNKNOWN,_.ERROR),console.error("MarketStore - æ›´æ–°å½“å‰åœ°ç‚¹å¯ç”¨å•†å“æ—¶å‡ºé”™:",e),this.availableProducts=[]}},calculateLongTermTrend(e,t){const r=this.productPrices[e];if(!r||!r.history||r.history.length===0)return console.log(`å•†å“ ${e} æ²¡æœ‰ä»·æ ¼å†å²æ•°æ®ï¼Œä½¿ç”¨é»˜è®¤è¶‹åŠ¿`),{trend:P.STABLE,changePercent:0};const i=r.history,s=i[i.length-1],o=(s-t)/t*100;console.log(`å•†å“ ${e} è¶‹åŠ¿è®¡ç®— - åŸºç¡€ä»·æ ¼: ${t}, å½“å‰ä»·æ ¼: ${s}, å†å²è®°å½•: [${i.join(", ")}], å˜åŒ–ç™¾åˆ†æ¯”: ${o.toFixed(1)}%`);let n;if(o>15)n=P.RISING_STRONG;else if(o>5)n=P.RISING;else if(o<-15)n=P.FALLING_STRONG;else if(o<-5)n=P.FALLING;else{const a=this.products.find(c=>c.id===Number(e));if(!a)console.log(`å•†å“ ${e} æœªæ‰¾åˆ°äº§å“ä¿¡æ¯ï¼Œä½¿ç”¨é»˜è®¤è¶‹åŠ¿`),n=P.STABLE;else{const c=a.minPrice,u=a.maxPrice,g=u-c;if(g<=0)console.log(`å•†å“ ${e} ä»·æ ¼èŒƒå›´ä¸º0ï¼Œä½¿ç”¨é»˜è®¤è¶‹åŠ¿`),n=P.STABLE;else{const m=(s-c)/g;console.log(`å•†å“ ${e} ç›¸å¯¹ä½ç½®è®¡ç®— - æœ€ä½ä»·: ${c}, æœ€é«˜ä»·: ${u}, ç›¸å¯¹ä½ç½®: ${(m*100).toFixed(1)}%`),m>.8?n=P.STABLE_HIGH:m<.2?n=P.STABLE_LOW:n=P.STABLE}}}if(i.length>=3){const a=i.slice(-3),c=this.calculateVolatility(a);console.log(`å•†å“ ${e} æ³¢åŠ¨æ€§è®¡ç®— - æœ€è¿‘ä»·æ ¼: [${a.join(", ")}], æ³¢åŠ¨æ€§: ${c.toFixed(3)}`),c>.1&&(n=P.VOLATILE)}return console.log(`å•†å“ ${e} æœ€ç»ˆè¶‹åŠ¿: ${n}, å˜åŒ–ç™¾åˆ†æ¯”: ${o.toFixed(1)}%`),{trend:n,changePercent:parseFloat(o.toFixed(1))}},calculateVolatility(e){if(!e||e.length<2)return 0;let t=0;for(let r=1;r<e.length;r++){const i=e[r-1],s=e[r];if(i>0){const o=Math.abs((s-i)/i);t+=o}}return t/(e.length-1)},getLocationAvailableProducts(e){if(!e)return[];try{const t=this.products.filter(r=>r.availableAt&&r.availableAt.includes(e.id)).map(r=>r.id);return e.specialProducts&&e.specialProducts.length>0&&e.specialProducts.forEach(r=>{t.includes(r)||t.push(r)}),t}catch(t){return console.error("è·å–åœ°ç‚¹å¯ç”¨å•†å“åˆ—è¡¨å‡ºé”™:",t),[]}},isSpecialProduct(e){return!this.currentLocation||!this.currentLocation.specialProducts?!1:this.currentLocation.specialProducts.includes(e)},getCurrentProductPrice(e){if(!e)return console.warn(`MarketStore - getCurrentProductPrice: æ— æ•ˆçš„å•†å“ID: ${e}`),0;const t=String(e);if(!this.productPrices||!this.productPrices[t]){console.warn(`MarketStore - getCurrentProductPrice: æ‰¾ä¸åˆ°å•†å“ä»·æ ¼ (ID: ${t})`);const r=this.products.find(i=>String(i.id)===t);return r?(console.log(`MarketStore - ä½¿ç”¨å•†å“åŸºç¡€ä»·æ ¼: ${r.basePrice}`),r.basePrice||0):0}return this.productPrices[t].price||0},getProductPriceHistory(e){var t;return((t=this.productPrices[e])==null?void 0:t.history)||[]},getProductPriceTrend(e){var t;return((t=this.productPrices[e])==null?void 0:t.trend)||P.STABLE},addMarketModifier(e,t){switch(e){case"global":this.marketModifiers.globalPriceModifier=t.value;break;case"category":this.marketModifiers.categoryModifiers[t.category]=t.value;break;case"product":this.marketModifiers.productModifiers[t.productId]=t.value;break;case"location":this.marketModifiers.locationModifiers[t.locationId]=t.value;break;case"locationProduct":this.marketModifiers.locationProductModifiers[t.locationId]||(this.marketModifiers.locationProductModifiers[t.locationId]={}),this.marketModifiers.locationProductModifiers[t.locationId][t.productId]=t.value;break}},loadProducts(e){if(console.log("MarketStore - åŠ è½½äº§å“æ•°æ®:",e),!Array.isArray(e)){console.warn("MarketStore - åŠ è½½äº§å“æ•°æ®æ—¶ä¼ å…¥çš„ä¸æ˜¯æ•°ç»„:",e);return}if(this.products.length===0&&(this.products=_e()),e.length>0&&typeof e[0]=="string"){const t=_e();this.products=t.filter(r=>e.includes(r.id)),console.log("MarketStore - å·²åŠ è½½æŒ‡å®šäº§å“:",this.products.length)}this.updateLocationProducts()},loadHouses(e){if(console.log("MarketStore - åŠ è½½æˆ¿å±‹æ•°æ®:",e),!Array.isArray(e)){console.warn("MarketStore - åŠ è½½æˆ¿å±‹æ•°æ®æ—¶ä¼ å…¥çš„ä¸æ˜¯æ•°ç»„:",e);return}if(this.houses.length===0&&(this.houses=Ue()),e.length>0&&typeof e[0]=="string"){const t=Ue();this.houses=t.filter(r=>e.includes(r.id)),console.log("MarketStore - å·²åŠ è½½æŒ‡å®šæˆ¿å±‹:",this.houses.length)}}},getters:{availableHouses(e){return e.houses},currentLocationInfo(e){return e.currentLocation?{id:e.currentLocation.id,name:e.currentLocation.name,description:e.currentLocation.description,modifiers:e.currentLocation.modifiers,hasSpecialProducts:e.currentLocation.specialProducts&&e.currentLocation.specialProducts.length>0}:null},marketStatus(e){const t=e.marketModifiers.globalPriceModifier;let r="neutral";t>1.1?r="bull":t<.9&&(r="bear");const i=e.products.filter(n=>e.productPrices[n.id]),s=i.filter(n=>(e.productPrices[n.id].price-n.minPrice)/(n.maxPrice-n.minPrice)>.7),o=i.filter(n=>(e.productPrices[n.id].price-n.minPrice)/(n.maxPrice-n.minPrice)<.3);return{status:r,globalModifier:t,highPriceProductsRatio:i.length>0?s.length/i.length:0,lowPriceProductsRatio:i.length>0?o.length/i.length:0,activeModifiersCount:Object.keys(e.marketModifiers.categoryModifiers).length+Object.keys(e.marketModifiers.productModifiers).length}}}}),h={RANDOM:"random",STORY:"story",LOCATION:"location",MARKET:"market",PERSONAL:"personal",TUTORIAL:"tutorial"};let qe=class{constructor({id:t,title:r,description:i,options:s=[],conditions:o={},repeatable:n=!1,type:a=h.RANDOM,weight:c=1,imageUrl:u=null}){this.id=t,this.title=r,this.description=i,this.options=s,this.conditions=o,this.repeatable=n,this.type=a,this.weight=c,this.imageUrl=null}canTrigger(t,r=[]){var s,o;const i=this.conditions;if(!this.repeatable&&r.includes(this.id)||i.minWeek!==null&&t.currentWeek<i.minWeek||i.maxWeek!==null&&t.currentWeek>i.maxWeek||i.locations!==null&&!i.locations.includes((s=t.currentLocation)==null?void 0:s.id))return!1;if(i.playerMoney!==null){const n=t.player.money;if(i.playerMoney.min!==void 0&&n<i.playerMoney.min||i.playerMoney.max!==void 0&&n>i.playerMoney.max)return!1}if(i.playerDebt!==null){const n=t.player.debt;if(i.playerDebt.min!==void 0&&n<i.playerDebt.min||i.playerDebt.max!==void 0&&n>i.playerDebt.max)return!1}if(i.inventoryItems!==null)for(const n of i.inventoryItems){const a=t.player.inventory.find(u=>u.productId===n.productId),c=a?a.quantity:0;if(n.minQuantity!==void 0&&c<n.minQuantity||n.maxQuantity!==void 0&&c>n.maxQuantity)return!1}if(i.attributes!==null)for(const[n,a]of Object.entries(i.attributes)){const c=((o=t.player.attributes)==null?void 0:o[n])||0;if(a.min!==void 0&&c<a.min||a.max!==void 0&&c>a.max)return!1}if(i.requiredEvents!==null){for(const n of i.requiredEvents)if(!r.includes(n))return!1}if(i.excludedEvents!==null){for(const n of i.excludedEvents)if(r.includes(n))return!1}return i.customCondition!==null&&!i.customCondition(t)?!1:Math.random()<=(i.probability||1)}getAvailableOptions(t){return this.options.filter(r=>r.condition===null||r.condition(t))}};class ze{constructor({text:t,result:r,effects:i,condition:s=null}){this.text=t,this.result=r,this.effects=i,this.condition=s}isAvailable(t){return this.condition===null||this.condition(t)}}class or{constructor({money:t=0,debt:r=0,inventory:i=[],attributes:s={},market:o=null,forceLocationChange:n=!1,targetLocation:a=null,capacity:c=0,nextEvent:u=null,gameState:g=null}){this.money=t,this.debt=r,this.inventory=i,this.attributes=s,this.market=o,this.forceLocationChange=n,this.targetLocation=a,this.capacity=c,this.nextEvent=u,this.gameState=g}}class sr{constructor({minWeek:t=null,maxWeek:r=null,locations:i=null,probability:s=1,playerMoney:o=null,playerDebt:n=null,inventoryItems:a=null,attributes:c=null,requiredEvents:u=null,excludedEvents:g=null,customCondition:m=null}){this.minWeek=t,this.maxWeek=r,this.locations=i,this.probability=s,this.playerMoney=o,this.playerDebt=n,this.inventoryItems=a,this.attributes=c,this.requiredEvents=u,this.excludedEvents=g,this.customCondition=m}}function v(e){if(typeof e=="object"&&!Array.isArray(e))return new qe(e);{const[t,r,i,s,o,n,a,c,u]=arguments;return new qe({id:t,title:r,description:i,options:s,conditions:o,repeatable:n,type:a,weight:c,imageUrl:u})}}const l=(e,t,r,i=null)=>new ze({text:e,result:t,effects:r,condition:i}),d=e=>new or(e),E=e=>new sr(e),nr=[v("market_boom","å±€éƒ¨å¸‚åœºç¹è£","æœ€æ–°ç»æµæŠ¥é“ï¼šé«˜ç«¯å•†åŸå’Œç”µå­ç§‘æŠ€åŸè¿æ¥æ¶ˆè´¹çƒ­æ½®ï¼Œå•†å“ä»·æ ¼æ™®éä¸Šæ¶¨ï¼è¿™å¯èƒ½æ˜¯è°ƒæ•´è´­ä¹°ç­–ç•¥çš„å¥½æ—¶æœºã€‚",[l("æŠ“ä½æœºä¼šåœ¨çƒ­é—¨åœ°åŒºé‡‡è´­","ä½ å†³å®šå‰å¾€è¿™äº›ç¹è£åœ°åŒºé‡‡è´­æ›´å¤šå•†å“ï¼Œå¸Œæœ›èƒ½ä»ä»·æ ¼æ³¢åŠ¨ä¸­è·ç›Šã€‚",d({market:{locationModifiers:{premium_mall:1.25,electronics_hub:1.15},duration:2}})),l("è§‚æœ›å¸‚åœºèµ°åŠ¿","ä½ å†³å®šä¿æŒè§‚æœ›æ€åº¦ï¼Œä¸åšä»»ä½•ç‰¹åˆ«çš„æ“ä½œã€‚",d({})),l("è¶é«˜ä»·å‡ºå”®ç›¸å…³åº“å­˜å•†å“","ä½ å†³å®šåˆ©ç”¨è¿™äº›åœ°åŒºä»·æ ¼ä¸Šæ¶¨çš„æœºä¼šå‡ºå”®ä¸€äº›åº“å­˜å•†å“ã€‚",d({market:{locationModifiers:{premium_mall:1.2,electronics_hub:1.1},duration:1}}),e=>e.player.inventoryUsed>0)],E({minWeek:5,probability:.2}),!0,h.MARKET,1.5,"/assets/images/events/market_boom.jpg"),v("market_crash","å±€éƒ¨å¸‚åœºå´©ç›˜","çªå‘æ¶ˆæ¯ï¼šäºŒæ‰‹å¸‚åœºå’Œåœ°ä¸‹é»‘å¸‚çˆ†å‘å®‰å…¨äº‹ä»¶ï¼Œå¯¼è‡´è¿™äº›åœ°åŒºäº¤æ˜“èç¼©ï¼Œå•†å“ä»·æ ¼å¤§å¹…ä¸‹è·Œï¼ä½ éœ€è¦å†³å®šæ˜¯å¦åˆ©ç”¨è¿™æ¬¡ä½ä»·æœºä¼šã€‚",[l("æŠ„åº•è´­ä¹°","ä½ å†³å®šè¶ä½ä»·å‰å¾€å—å½±å“åœ°åŒºå¤§é‡è´­å…¥å•†å“ï¼Œå¸Œæœ›èƒ½åœ¨ä»·æ ¼å›å‡æ—¶è·åˆ©ã€‚",d({market:{locationModifiers:{second_hand_market:.65,black_market:.7},duration:3}})),l("ç­‰å¾…å¸‚åœºç¨³å®š","ä½ å†³å®šç­‰å¾…å¸‚åœºç¨³å®šåå†è¡ŒåŠ¨ï¼Œé¿å…åœ¨åŠ¨è¡æ—¶æœŸå†’é™©ã€‚",d({})),l("æå‰å–å‡ºæŒæœ‰å•†å“","ä½ æ‹…å¿ƒå…¶ä»–åœ°åŒºä¹Ÿä¼šå—å½±å“ï¼Œå†³å®šç«‹å³å‡ºå”®éƒ¨åˆ†å•†å“å‡å°‘å¯èƒ½çš„æŸå¤±ã€‚",d({market:{locationModifiers:{second_hand_market:.75,black_market:.8},duration:1}}),e=>e.player.inventoryUsed>0)],E({minWeek:10,probability:.15}),!0,h.MARKET,1.5,"/assets/images/events/market_crash.jpg"),v("lucky_money","æ„å¤–ä¹‹è´¢","ä½ åœ¨è·¯ä¸Šæ¡åˆ°äº†ä¸€ä¸ªé’±åŒ…ï¼Œé‡Œé¢æœ‰ä¸€äº›ç°é‡‘å’Œå¤±ä¸»çš„è”ç³»æ–¹å¼ã€‚è¿™æ˜¯ä¸ªè€ƒéªŒä½ è¯šä¿¡çš„æ—¶åˆ»ã€‚",[l("å½’è¿˜é’±åŒ…","ä½ è”ç³»äº†å¤±ä¸»å¹¶å½’è¿˜äº†é’±åŒ…ï¼Œå¯¹æ–¹éå¸¸æ„Ÿè°¢å¹¶ç»™äº†ä½ 500å…ƒé…¬é‡‘ã€‚",d({money:500,attributes:{creditRating:1,reputation:1}})),l("æ®ä¸ºå·±æœ‰","ä½ å†³å®šæŠŠé’±åŒ…é‡Œçš„é’±æ®ä¸ºå·±æœ‰ï¼Œè·å¾—äº†2000å…ƒï¼Œä½†æ„Ÿåˆ°æœ‰äº›æ„§ç–šã€‚",d({money:2e3,attributes:{creditRating:-2,reputation:-2}}))],E({probability:.1,minWeek:3}),!1,h.PERSONAL,1,"/assets/images/events/lucky_money.jpg"),v("health_problem","å¥åº·é—®é¢˜","ä½ çªç„¶æ„Ÿåˆ°èº«ä½“ä¸é€‚ï¼ŒåŒ»ç”Ÿå»ºè®®ä½ åŠæ—¶å°±åŒ»ã€‚ä¸åŠæ—¶å¤„ç†å¯èƒ½ä¼šå½±å“åˆ°ä½ çš„æ—¥å¸¸å·¥ä½œå’Œç”Ÿæ´»ã€‚",[l("ç«‹å³å°±åŒ»","ä½ é€‰æ‹©ç«‹å³å»åŒ»é™¢æ£€æŸ¥æ²»ç–—ï¼ŒèŠ±è´¹äº†ä¸€äº›åŒ»ç–—è´¹ï¼Œä½†è¿…é€Ÿæ¢å¤äº†å¥åº·ã€‚",d({money:-800,attributes:{health:1}})),l("æš‚æ—¶å¿è€","ä½ å†³å®šå…ˆå¿ç€ï¼Œå¸Œæœ›ç—‡çŠ¶ä¼šè‡ªè¡Œå¥½è½¬ï¼Œçœä¸‹åŒ»ç–—è´¹ç”¨ã€‚ä½†è¿™å¯¼è‡´ä½ çš„å¥åº·çŠ¶å†µæœ‰æ‰€ä¸‹é™ã€‚",d({attributes:{health:-1}})),l("å¯»æ±‚ä¸­è¯è°ƒç†","ä½ é€‰æ‹©è´­ä¹°ä¸€äº›ä¸­è¯è¿›è¡Œè°ƒç†ï¼ŒèŠ±è´¹è¾ƒå°‘ä½†æ•ˆæœæ¸©å’Œã€‚",d({money:-300,attributes:{health:.5}}))],E({probability:.15,minWeek:8}),!0,h.PERSONAL,1,"/assets/images/events/health_problem.jpg"),v("market_raid","é»‘å¸‚çªè¢­","è­¦æ–¹çªç„¶çªè¢­äº†åœ°ä¸‹é»‘å¸‚ï¼æ‰€æœ‰äººéƒ½åœ¨æ…Œä¹±ä¸­é€ƒçªœï¼Œä½ éœ€è¦å¿«é€Ÿåšå‡ºå†³å®šã€‚",[l("è¿…é€Ÿç¦»å¼€","ä½ è¿…é€Ÿé€ƒç¦»äº†ç°åœºï¼Œè™½ç„¶æ²¡èƒ½å®Œæˆäº¤æ˜“ï¼Œä½†é¿å…äº†ä¸å¿…è¦çš„éº»çƒ¦ã€‚",d({forceLocationChange:!0,targetLocation:"commodity_market"})),l("å†’é™©å®Œæˆäº¤æ˜“","ä½ å†’é™©ç•™ä¸‹æ¥å®Œæˆäº¤æ˜“ï¼Œè·å¾—äº†ä½ä»·å•†å“ï¼Œä½†å·®ç‚¹è¢«æ‰§æ³•äººå‘˜æŠ“ä½ã€‚",d({money:-2e3,items:[{productId:502,quantity:1,price:1e3},{productId:505,quantity:2,price:500}],attributes:{businessSkill:1,risk_tolerance:1}}),e=>e.player.money>=2e3&&e.player.capacity-e.player.inventoryUsed>=3)],E({locations:["black_market"],probability:.25}),!0,h.LOCATION,1.5,"/assets/images/events/market_raid.jpg"),v("celebrity_appearance","åäººç°èº«","ä¸€ä½çŸ¥åæ˜æ˜Ÿåœ¨é«˜ç«¯å•†åŸç°èº«è´­ç‰©ï¼Œå¼•èµ·ä¸€é˜µè½°åŠ¨ã€‚äººæµæ¿€å¢ï¼Œå•†å®¶çº·çº·è°ƒé«˜ä»·æ ¼ã€‚",[l("è¶æœºæé«˜å”®ä»·","ä½ æŠ“ä½æœºä¼šåœ¨é™„è¿‘è®¾æ‘Šï¼Œä»¥ç•¥é«˜çš„ä»·æ ¼å‡ºå”®å¥¢ä¾ˆå“ï¼Œèµšäº†ä¸€ç¬”ã€‚",d({money:e=>{const t=e.player.inventory.filter(r=>{const i=e.products.find(s=>s.id===r.productId);return i&&i.category==="LUXURY"});if(t.length>0){const r=t[0],i=e.products.find(n=>n.id===r.productId),s=Math.min(r.quantity,1);return(i?i.basePrice*1.5:1500)*s}return 1500},items:e=>{const t=e.player.inventory.filter(r=>{const i=e.products.find(s=>s.id===r.productId);return i&&i.category==="LUXURY"});return t.length>0?[{productId:t[0].productId,quantity:-1}]:[]},market:{globalPriceModifier:1.2,duration:1}}),e=>e.player.inventoryUsed>0),l("å°è¯•æ¥è¿‘åäºº","ä½ è¯•å›¾æ¥è¿‘åäººè·å–åˆå½±ï¼Œç»“æœä¸å°å¿ƒè¢«ä¿å®‰æ¨æ¡ï¼Œæ‰‹æœºæ‘”åäº†ã€‚",d({money:-500}))],E({locations:["premium_mall"],probability:.2}),!0,h.LOCATION,1,"/assets/images/events/celebrity.jpg"),v("debt_relief","å€ºåŠ¡å‡å…","é“¶è¡Œæ¨å‡ºäº†å€ºåŠ¡é‡ç»„è®¡åˆ’ï¼Œä½ æ”¶åˆ°äº†å‚ä¸æœºä¼šã€‚è¿™å¯èƒ½æ˜¯å‡è½»å€ºåŠ¡è´Ÿæ‹…çš„å¥½æœºä¼šã€‚",[l("ç”³è¯·å‚ä¸","ä½ æˆåŠŸç”³è¯·äº†å€ºåŠ¡å‡å…è®¡åˆ’ï¼Œå€ºåŠ¡å‡å°‘äº†20%ã€‚",d({debt:-.2})),l("æ”¾å¼ƒæœºä¼š","ä½ è®¤ä¸ºè¿™å¯èƒ½æœ‰éšè—æ¡æ¬¾ï¼Œå†³å®šæ”¾å¼ƒè¿™ä¸ªæœºä¼šã€‚",d({}))],E({minWeek:15,playerDebt:{min:5e3},probability:.3}),!1,h.PERSONAL,1,"/assets/images/events/debt_relief.jpg"),v("electronics_discount","ç”µå­äº§å“ä¿ƒé”€","ç”µå­äº§å“å¸‚åœºæ¨å‡ºå¤§è§„æ¨¡ä¿ƒé”€æ´»åŠ¨ï¼Œä»·æ ¼å¤§å¹…ä¸‹é™ï¼è¿™æ˜¯å›¤ç§¯ç”µå­äº§å“çš„å¥½æ—¶æœºã€‚",[l("è´­ä¹°ç”µå­äº§å“","ä½ è¶æœºè´­ä¹°äº†ä¸€äº›ç”µå­äº§å“ï¼Œä»·æ ¼æ¯”å¹³æ—¶ä¾¿å®œå¾ˆå¤šã€‚",d({money:-3e3,items:[{productId:301,quantity:1,price:1500},{productId:305,quantity:1,price:800}],market:{categoryModifiers:{ELECTRONICS:.7},duration:2}}),e=>e.player.money>=3e3&&e.player.capacity-e.player.inventoryUsed>=2),l("ä¸æ„Ÿå…´è¶£","ä½ å¯¹ç”µå­äº§å“ä¸æ„Ÿå…´è¶£ï¼Œå†³å®šå¿½ç•¥è¿™æ¬¡ä¿ƒé”€ã€‚",d({}))],E({probability:.15,minWeek:5}),!0,h.MARKET,1,"/assets/images/events/electronics_sale.jpg"),v("luxury_tax","å¥¢ä¾ˆå“å¾ç¨","æ”¿åºœå®£å¸ƒå¯¹å¥¢ä¾ˆå“å¾æ”¶é¢å¤–ç¨è´¹ï¼Œå¯¼è‡´å¥¢ä¾ˆå“ä»·æ ¼å…¨é¢ä¸Šæ¶¨ã€‚",[l("æå‰å›¤è´§","ä½ å†³å®šåœ¨ç¨æ”¶æ”¿ç­–å®æ–½å‰å›¤ç§¯ä¸€äº›å¥¢ä¾ˆå“ï¼Œä»¥å¤‡åç»­é«˜ä»·å‡ºå”®ã€‚",d({market:{categoryModifier:"LUXURY",modifier:1.1,duration:1},nextEvent:"luxury_tax_aftermath"})),l("è§‚æœ›å¸‚åœº","ä½ å†³å®šç­‰å¾…çœ‹çœ‹å¸‚åœºå¦‚ä½•ååº”ï¼Œé¿å…åšå‡ºå†’é™©å†³ç­–ã€‚",d({market:{categoryModifier:"LUXURY",modifier:1.3,duration:4}}))],E({probability:.1,minWeek:12,excludedEvents:["luxury_tax","luxury_tax_aftermath"]}),!1,h.MARKET,1,"/assets/images/events/luxury_tax.jpg"),v("luxury_tax_aftermath","å¥¢ä¾ˆå“ä»·æ ¼é£™å‡","å¥¢ä¾ˆå“å¾ç¨æ”¿ç­–æ­£å¼å®æ–½ï¼Œå¸‚åœºä»·æ ¼å¦‚é¢„æœŸèˆ¬å¤§å¹…ä¸Šæ¶¨ã€‚ä½ ä¹‹å‰çš„å‡†å¤‡æ˜¯å¦å……åˆ†ï¼Ÿ",[l("é«˜ä»·å‡ºå”®å›¤è´§","ä½ å°†ä¹‹å‰å›¤ç§¯çš„å¥¢ä¾ˆå“ä»¥é«˜ä»·å‡ºå”®ï¼Œè·å¾—äº†å¯è§‚åˆ©æ¶¦ã€‚",d({money:3e3,market:{categoryModifier:"LUXURY",modifier:1.4,duration:3}}),e=>e.player.inventory.some(t=>{const r=e.products.find(i=>i.id===t.productId);return r&&r.category==="LUXURY"})),l("ç»§ç»­æŒæœ‰","ä½ è®¤ä¸ºä»·æ ¼è¿˜ä¼šè¿›ä¸€æ­¥ä¸Šæ¶¨ï¼Œå†³å®šç»§ç»­æŒæœ‰å›¤ç§¯çš„å•†å“ã€‚",d({market:{categoryModifier:"LUXURY",modifier:1.3,duration:3}}))],E({requiredEvents:["luxury_tax"]}),!1,h.MARKET,1,"/assets/images/events/luxury_price_rise.jpg"),v("storage_expansion","å­˜å‚¨ç©ºé—´æ‰©å±•","ä½ å‘ç°ä¸€ä¸ªå¯ä»¥æ‰©å±•èƒŒåŒ…å®¹é‡çš„å¥½æœºä¼šï¼Œä½†éœ€è¦æŠ•å…¥ä¸€äº›èµ„é‡‘ã€‚",[l("è´­ä¹°æ–°èƒŒåŒ…","ä½ èŠ±é’±è´­ä¹°äº†ä¸€ä¸ªæ›´å¤§çš„èƒŒåŒ…ï¼Œæå‡äº†å­˜å‚¨å®¹é‡ã€‚",d({money:-1500,capacity:20})),l("ç§Ÿç”¨ä»“åº“ç©ºé—´","ä½ ç§Ÿäº†ä¸€ä¸ªå°å‹ä»“åº“ç©ºé—´ï¼ŒèŠ±è´¹è¾ƒä½ä½†å®¹é‡æå‡æœ‰é™ã€‚",d({money:-500,capacity:10})),l("æ”¾å¼ƒæœºä¼š","ä½ è®¤ä¸ºå½“å‰å®¹é‡å¤Ÿç”¨ï¼Œå†³å®šèŠ‚çº¦èµ„é‡‘ä¸è¿›è¡Œæ‰©å±•ã€‚",d({}))],E({probability:.15,minWeek:10,playerMoney:{min:500},inventoryUsed:{min:.7}}),!0,h.PERSONAL,1,"/assets/images/events/storage_expansion.jpg"),v("tutorial_trading","äº¤æ˜“å…¥é—¨","æ¬¢è¿æ¥åˆ°ã€Šä¹°æˆ¿è®°ã€‹ï¼åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œä½ çš„ç›®æ ‡æ˜¯é€šè¿‡ä¹°å–å•†å“èµšå–å·®ä»·ï¼Œæœ€ç»ˆç§¯ç´¯è¶³å¤Ÿçš„èµ„é‡‘è´­ä¹°ç†æƒ³çš„æˆ¿äº§ã€‚",[l("äº†è§£åŸºæœ¬äº¤æ˜“","ä½ å­¦ä¹ äº†åŸºæœ¬çš„äº¤æ˜“çŸ¥è¯†ï¼Œæ˜ç™½äº†å¦‚ä½•åœ¨ä¸åŒåœ°ç‚¹ä¹‹é—´ä¹°å–å•†å“èµšå–å·®ä»·ã€‚",d({nextEvent:"tutorial_market"}))],E({minWeek:1,maxWeek:1}),!1,h.TUTORIAL,1,"/assets/images/events/tutorial.jpg"),v("tutorial_market","å¸‚åœºè§£æ","ä¸åŒåœ°ç‚¹çš„å•†å“ä»·æ ¼ä¼šæœ‰å·®å¼‚ï¼ŒåŒæ—¶è¿˜ä¼šéšæ—¶é—´æ³¢åŠ¨ã€‚å…³æ³¨ä»·æ ¼è¶‹åŠ¿æ˜¯è·åˆ©çš„å…³é”®ï¼",[l("ç»§ç»­å­¦ä¹ ","ä½ äº†è§£äº†ä»·æ ¼è¶‹åŠ¿ç³»ç»Ÿï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨ä»·æ ¼æ³¢åŠ¨è·åˆ©ã€‚",d({nextEvent:"tutorial_goal"}))],E({requiredEvents:["tutorial_trading"]}),!1,h.TUTORIAL,1,"/assets/images/events/tutorial_market.jpg"),v("tutorial_goal","æ¸¸æˆç›®æ ‡","æ¸¸æˆä¸­ä½ æœ‰52å‘¨çš„æ—¶é—´æ¥ç§¯ç´¯è´¢å¯Œã€‚æœ€ç»ˆç›®æ ‡æ˜¯è´­ä¹°ä¸€å¥—ç†æƒ³ä½æˆ¿ï¼Œæˆ¿å±‹ç§ç±»ä»ä¾¿å®œçš„å°å…¬å¯“åˆ°è±ªååˆ«å¢…ä¸ç­‰ã€‚ç¥ä½ å¥½è¿ï¼",[l("å¼€å§‹æ¸¸æˆ","ä½ å·²ç»äº†è§£äº†æ¸¸æˆçš„åŸºæœ¬è§„åˆ™ï¼Œç°åœ¨å¯ä»¥å¼€å§‹ä½ çš„ä¹°æˆ¿ä¹‹æ—…äº†ï¼",d({attributes:{businessSkill:1}}))],E({requiredEvents:["tutorial_market"]}),!1,h.TUTORIAL,1,"/assets/images/events/tutorial_goal.jpg"),v("unexpected_inheritance","æ„å¤–ç»§æ‰¿","ä½ æ”¶åˆ°ä¸€ä»½å¾‹å¸ˆå‡½ï¼Œä¸€ä½è¿œæˆ¿äº²æˆšå»ä¸–åå°†ä¸€ç¬”èµ„é‡‘ç•™ç»™äº†ä½ ã€‚è¿™æ˜¯ä¸ªæ„å¤–ä¹‹å–œï¼",[l("æ¥å—ç»§æ‰¿","ä½ æ¥å—äº†è¿™ç¬”æ„å¤–ä¹‹è´¢ï¼Œè·å¾—äº†ä¸€ç¬”å¯è§‚çš„èµ„é‡‘ã€‚",d({money:5e3,attributes:{happiness:1}})),l("æèµ ä¸€éƒ¨åˆ†","ä½ å†³å®šå°†ä¸€éƒ¨åˆ†ç»§æ‰¿çš„é’±æç»™æ…ˆå–„æœºæ„ï¼Œæ„Ÿè§‰å¿ƒæƒ…èˆ’ç•…ã€‚",d({money:3500,attributes:{happiness:2,reputation:2}}))],E({probability:.05,minWeek:15}),!1,h.PERSONAL,.8,"/assets/images/events/inheritance.jpg"),v("business_training","å•†ä¸šåŸ¹è®­","ä½ å‘ç°ä¸€ä¸ªå•†ä¸šæŠ€èƒ½åŸ¹è®­ç­çš„å¹¿å‘Šï¼Œå‚åŠ å¯èƒ½ä¼šæå‡ä½ çš„äº¤æ˜“èƒ½åŠ›ï¼Œä½†éœ€è¦ä»˜å‡ºä¸€å®šè´¹ç”¨å’Œæ—¶é—´ã€‚",[l("å‚åŠ åŸ¹è®­","ä½ æŠ•å…¥æ—¶é—´å’Œé‡‘é’±å‚åŠ äº†åŸ¹è®­ï¼Œå•†ä¸šæŠ€èƒ½å¾—åˆ°äº†æå‡ã€‚",d({money:-1e3,attributes:{businessSkill:2}})),l("è‡ªå­¦å•†ä¸šçŸ¥è¯†","ä½ å†³å®šé€šè¿‡ä¹¦ç±å’Œç½‘ç»œè‡ªå­¦å•†ä¸šçŸ¥è¯†ï¼ŒèŠ±è´¹è¾ƒå°‘ä½†æ•ˆæœæœ‰é™ã€‚",d({money:-200,attributes:{businessSkill:1}})),l("å¿½ç•¥è¿™ä¸ªæœºä¼š","ä½ è®¤ä¸ºå®è·µå‡ºçœŸçŸ¥ï¼Œå†³å®šæŠŠæ—¶é—´å’Œé‡‘é’±ç”¨åœ¨å®é™…äº¤æ˜“ä¸Šã€‚",d({}))],E({probability:.15,minWeek:4,playerMoney:{min:1e3}}),!0,h.PERSONAL,1,"/assets/images/events/business_training.jpg"),v("social_networking","ç¤¾äº¤æœºä¼š","ä½ è¢«é‚€è¯·å‚åŠ ä¸€ä¸ªå•†ä¸šäººå£«çš„ç¤¾äº¤èšä¼šï¼Œè¿™å¯èƒ½æ˜¯ç»“è¯†äººè„‰ã€è·å–ä¿¡æ¯çš„å¥½æœºä¼šã€‚",[l("ç§¯æå‚ä¸","ä½ åœ¨èšä¼šä¸Šç§¯æç¤¾äº¤ï¼Œç»“è¯†äº†å‡ ä½æœ‰ä»·å€¼çš„å•†ä¸šä¼™ä¼´ï¼Œè·å¾—äº†ä¸€äº›å¸‚åœºå†…å¹•ã€‚",d({money:-300,attributes:{socialSkill:1,businessSkill:.5},market:{insiderInfo:!0,duration:2}})),l("ç®€å•å‡ºå¸­","ä½ ä½è°ƒåœ°å‚åŠ äº†èšä¼šï¼Œæ²¡æœ‰ç‰¹åˆ«çš„æ”¶è·ï¼Œä½†ä¹Ÿå¼€é˜”äº†çœ¼ç•Œã€‚",d({money:-300,attributes:{socialSkill:.5}})),l("å©‰æ‹’é‚€è¯·","ä½ å› ä¸ºå¿™äºå…¶ä»–äº‹åŠ¡å©‰æ‹’äº†é‚€è¯·ï¼Œé”™è¿‡äº†è¿™æ¬¡ç¤¾äº¤æœºä¼šã€‚",d({}))],E({probability:.12,minWeek:8,playerMoney:{min:300}}),!0,h.PERSONAL,1,"/assets/images/events/social_networking.jpg"),v("investment_opportunity","æŠ•èµ„æœºä¼š","ä¸€ä¸ªæœ‹å‹å‘ä½ æ¨èäº†ä¸€ä¸ªå°å‹åˆ›ä¸šå…¬å¸çš„æŠ•èµ„æœºä¼šï¼Œå£°ç§°æœ‰é«˜å›æŠ¥ï¼Œä½†é£é™©æœªçŸ¥ã€‚",[l("å¤§ç¬”æŠ•èµ„","ä½ å†³å®šæŠ•å…¥ä¸€å¤§ç¬”èµ„é‡‘ï¼Œå¸Œæœ›è·å¾—é«˜å›æŠ¥ã€‚",d({money:-4e3,nextEvent:"investment_result_big"})),l("å°é¢æŠ•èµ„","ä½ è°¨æ…åœ°æŠ•å…¥ä¸€å°ç¬”èµ„é‡‘ï¼Œé™ä½å¯èƒ½çš„é£é™©ã€‚",d({money:-1500,nextEvent:"investment_result_small"})),l("æ‹’ç»æŠ•èµ„","ä½ å¯¹è¿™ä¸ªæœºä¼šæŒæ€€ç–‘æ€åº¦ï¼Œå†³å®šä¸å†’é™©æŠ•èµ„ã€‚",d({}))],E({probability:.1,minWeek:20,playerMoney:{min:4e3}}),!1,h.PERSONAL,1,"/assets/images/events/investment_opportunity.jpg"),v("investment_result_big","æŠ•èµ„ç»“æœ","å‡ å‘¨åï¼Œä½ æŠ•èµ„çš„åˆ›ä¸šå…¬å¸æœ‰äº†æ–°è¿›å±•...",[l("æŸ¥çœ‹ç»“æœ","ä½ æ»¡æ€€æœŸå¾…åœ°æŸ¥çœ‹æŠ•èµ„ç»“æœ...",d({money:Math.random()>.3?8e3:-2e3,attributes:{businessSkill:1}}))],E({requiredEvents:["investment_opportunity"]}),!1,h.PERSONAL,1,"/assets/images/events/investment_result.jpg"),v("investment_result_small","æŠ•èµ„ç»“æœ","å‡ å‘¨åï¼Œä½ æŠ•èµ„çš„åˆ›ä¸šå…¬å¸æœ‰äº†æ–°è¿›å±•...",[l("æŸ¥çœ‹ç»“æœ","ä½ æ»¡æ€€æœŸå¾…åœ°æŸ¥çœ‹æŠ•èµ„ç»“æœ...",d({money:Math.random()>.2?2500:-500,attributes:{businessSkill:.5}}))],E({requiredEvents:["investment_opportunity"]}),!1,h.PERSONAL,1,"/assets/images/events/investment_result.jpg"),v("clothing_fashion_trend","æ—¶å°šæ½®æµ","ä¸€è‚¡æ–°çš„æ—¶å°šæ½®æµå¸­å·å…¨åŸï¼Œæœè£…ç±»äº§å“çš„éœ€æ±‚çªç„¶å¢åŠ ï¼",[l("å›¤ç§¯æœè£…ç±»å•†å“","ä½ é¢„è§åˆ°è¿™æ˜¯ä¸€ä¸ªå•†æœºï¼Œå†³å®šå¤§é‡è´­å…¥æœè£…ç±»å•†å“ã€‚",d({market:{categoryModifier:"CLOTHING",modifier:1.3,duration:3}})),l("è§‚æœ›å¸‚åœºå˜åŒ–","ä½ å¯¹æ—¶å°šæ½®æµæŒè§‚æœ›æ€åº¦ï¼Œå†³å®šç»§ç»­å…³æ³¨å¸‚åœºå˜åŒ–å†åšå†³å®šã€‚",d({})),l("å‡ºå”®ç°æœ‰æœè£…åº“å­˜","ä½ å†³å®šè¶æœºå‡ºå”®æ‰‹ä¸­çš„æœè£…ç±»å•†å“ï¼Œè·å¾—ä¸€å®šåˆ©æ¶¦ã€‚",d({money:e=>{const t=e.player.inventory.filter(i=>{const s=e.products.find(o=>o.id===i.productId);return s&&s.category==="CLOTHING"});let r=0;return t.forEach(i=>{const s=e.products.find(o=>o.id===i.productId);if(s){const o=Math.max(i.purchasePrice*1.2,s.basePrice*1.1);r+=o*Math.min(i.quantity,1)}}),r>0?r:800},items:[{category:"CLOTHING",quantity:-1}]}),e=>e.player.inventory.some(t=>{const r=e.products.find(i=>i.id===t.productId);return r&&r.category==="CLOTHING"}))],E({probability:.15,minWeek:4}),!0,h.MARKET,1,"/assets/images/events/fashion_trend.jpg"),v("food_shortage","é£Ÿå“çŸ­ç¼º","ç”±äºæ¶åŠ£å¤©æ°”å½±å“ï¼Œå¸‚åœºä¸Šå‡ºç°äº†é£Ÿå“çŸ­ç¼ºçš„æƒ…å†µï¼Œä»·æ ¼å¼€å§‹ä¸Šæ¶¨ã€‚",[l("å¤§é‡è´­å…¥é£Ÿå“","ä½ é¢„è®¡ä»·æ ¼ä¼šè¿›ä¸€æ­¥ä¸Šæ¶¨ï¼Œå†³å®šè¶ç°åœ¨å¤§é‡è´­å…¥é£Ÿå“ç±»å•†å“ã€‚",d({money:-2e3,items:[{productId:201,quantity:5,price:200},{productId:202,quantity:2,price:250}],market:{categoryModifiers:{FOOD:1.4},productModifiers:{201:1.6,202:1.5,204:1.7},duration:4}}),e=>e.player.money>=2e3&&e.player.capacity-e.player.inventoryUsed>=7),l("å¯»æ‰¾æ›¿ä»£é£Ÿå“æ¥æº","ä½ å¼€å§‹å¯»æ‰¾æ›¿ä»£çš„é£Ÿå“æ¥æºï¼Œé¿å…å—åˆ°ä»·æ ¼æ³¢åŠ¨çš„å½±å“ã€‚",d({market:{categoryModifiers:{FOOD:1.2},productModifiers:{201:1.3,202:1.25},duration:2}}))],E({probability:.12,minWeek:8,excludedEvents:["food_shortage"]}),!0,h.MARKET,1,"/assets/images/events/food_shortage.jpg"),v("tech_innovation","ç§‘æŠ€åˆ›æ–°","ä¸€é¡¹çªç ´æ€§çš„ç§‘æŠ€åˆ›æ–°å¼•èµ·äº†å¸‚åœºå…³æ³¨ï¼Œç›¸å…³ç”µå­äº§å“éœ€æ±‚æ¿€å¢ã€‚",[l("æŠ•èµ„ç§‘æŠ€äº§å“","ä½ å†³å®šè´­å…¥ä¸€æ‰¹æœ€æ–°çš„ç§‘æŠ€äº§å“ï¼Œå¸Œæœ›èƒ½å¤Ÿè·å¾—é«˜é¢åˆ©æ¶¦ã€‚",d({money:-5e3,items:[{productId:301,quantity:1,price:2500},{productId:305,quantity:1,price:1500}],market:{categoryModifiers:{ELECTRONICS:1.25},productModifiers:{301:1.4,303:1.35,305:1.45},locationModifiers:{electronics_hub:1.15},duration:3}}),e=>e.player.money>=5e3&&e.player.capacity-e.player.inventoryUsed>=2),l("ç»§ç»­å…³æ³¨ä¼ ç»Ÿäº§å“","ä½ è®¤ä¸ºç§‘æŠ€åˆ›æ–°åªæ˜¯çŸ­æœŸæ•ˆåº”ï¼Œå†³å®šç»§ç»­ä¸“æ³¨äºä¼ ç»Ÿäº§å“ã€‚",d({market:{productModifiers:{301:1.2,305:1.25},duration:2}}))],E({probability:.15,minWeek:6}),!0,h.MARKET,1,"/assets/images/events/tech_innovation.jpg"),v("supply_chain_disruption","ä¾›åº”é“¾ä¸­æ–­","å…¨çƒä¾›åº”é“¾å‡ºç°ä¸¥é‡ä¸­æ–­ï¼Œå¤šç§å•†å“çš„ä¾›åº”å—åˆ°å½±å“ï¼Œä»·æ ¼å¼€å§‹æ³¢åŠ¨ã€‚",[l("å›¤ç§¯å—å½±å“å•†å“","ä½ å†³å®šè¶ä»·æ ¼è¿˜æœªå¤§å¹…ä¸Šæ¶¨å‰ï¼Œå›¤ç§¯ä¸€æ‰¹å—å½±å“çš„å•†å“ã€‚",d({market:{globalPriceModifier:1.15,duration:5}})),l("è½¬å‘æœ¬åœ°äº§å“","ä½ å†³å®šè½¬å‘é‡‡è´­æœ¬åœ°ç”Ÿäº§çš„å•†å“ï¼Œå‡å°‘å¯¹å…¨çƒä¾›åº”é“¾çš„ä¾èµ–ã€‚",d({market:{globalPriceModifier:1.1,duration:3}})),l("å»¶è¿Ÿé‡‡è´­è®¡åˆ’","ä½ å†³å®šæš‚æ—¶å»¶è¿Ÿé‡‡è´­è®¡åˆ’ï¼Œç­‰å¾…ä¾›åº”é“¾æ¢å¤æ­£å¸¸ã€‚",d({nextEvent:"supply_chain_recovery"}))],E({probability:.1,minWeek:15}),!1,h.MARKET,1.2,"/assets/images/events/supply_chain.jpg"),v("supply_chain_recovery","å…¨çƒä¾›åº”é“¾é€æ­¥æ¢å¤","ç»è¿‡ä¸€æ®µæ—¶é—´çš„è°ƒæ•´ï¼Œå…¨çƒä¾›åº”é“¾å¼€å§‹é€æ­¥æ¢å¤ï¼Œä½†ä¸åŒåœ°åŒºå’Œå•†å“çš„æ¢å¤é€Ÿåº¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚",[l("æŠŠæ¡æ¢å¤æœºä¼š","ä½ åˆ†æäº†å¸‚åœºæ¢å¤è¶‹åŠ¿ï¼Œå†³å®šæœ‰é€‰æ‹©åœ°æŠ•èµ„äºä»·æ ¼å¼€å§‹æ¢å¤æ­£å¸¸çš„å•†å“ã€‚",d({market:{globalPriceModifier:.95,locationModifiers:{commodity_market:.9,electronics_hub:1.1,black_market:.85},locationProductModifiers:{commodity_market:{202:.85,203:.9},electronics_hub:{301:1.2,305:1.15},black_market:{502:.7,503:.75}},duration:3}})),l("ç¨³å¥ç­–ç•¥","ä½ å†³å®šé‡‡å–ç¨³å¥ç­–ç•¥ï¼Œå¹³è¡¡è°ƒæ•´ä½ çš„åº“å­˜å’Œäº¤æ˜“è®¡åˆ’ã€‚",d({market:{globalPriceModifier:.98,locationModifiers:{commodity_market:.95,premium_mall:.95,second_hand_market:.95},duration:2}}))],E({requiredEvents:["supply_chain_disruption","old_supply_chain_disruption"]}),!1,h.MARKET,1,"/assets/images/events/supply_recovery.jpg"),v("seasonal_sales","å­£èŠ‚æ€§ä¿ƒé”€","å¹´åº¦å¤§ä¿ƒé”€æ´»åŠ¨å¼€å§‹äº†ï¼Œå„å¤§å•†å®¶çº·çº·é™ä»·å¸å¼•é¡¾å®¢ã€‚è¿™æ˜¯å›¤è´§çš„å¥½æ—¶æœºï¼",[l("å¤§é‡é‡‡è´­","ä½ å†³å®šåˆ©ç”¨ä¿ƒé”€æ´»åŠ¨å¤§é‡é‡‡è´­å„ç±»å•†å“ï¼Œä¸ºæœªæ¥çš„é”€å”®åšå‡†å¤‡ã€‚",d({market:{globalPriceModifier:.75,duration:2}})),l("é€‰æ‹©æ€§é‡‡è´­","ä½ æœ‰é€‰æ‹©åœ°è´­ä¹°ä¸€äº›ç‰¹ä»·å•†å“ï¼Œé¿å…èµ„é‡‘è¿‡åº¦å ç”¨ã€‚",d({market:{globalPriceModifier:.85,duration:1}})),l("è·³è¿‡ä¿ƒé”€","ä½ è®¤ä¸ºä¿ƒé”€å•†å“è´¨é‡å¯èƒ½ä¸é«˜ï¼Œå†³å®šè·³è¿‡è¿™æ¬¡æ´»åŠ¨ã€‚",d({}))],E({probability:.2,minWeek:12,maxWeek:40}),!0,h.MARKET,1,"/assets/images/events/seasonal_sales.jpg"),v("market_discount","å¤§å®—äº¤æ˜“ä¼˜æƒ ","å¤§å®—å•†å“äº¤æ˜“æ‰€ä»Šå¤©æ¨å‡ºç‰¹åˆ«ä¼˜æƒ ï¼Œæ‰€æœ‰å•†å“éƒ½æœ‰é¢å¤–æŠ˜æ‰£ï¼",[l("å¤§é‡é‡‡è´­","ä½ å†³å®šåˆ©ç”¨è¿™ä¸ªæœºä¼šå¤§é‡é‡‡è´­å„ç±»å•†å“ï¼Œä¸ºæœªæ¥çš„é”€å”®åšå‡†å¤‡ã€‚",d({market:{locationModifiers:{commodity_market:.8},categoryModifiers:{FOOD:.75,DAILY:.7},productModifiers:{201:.6,202:.65,101:.6},duration:1},forceLocationChange:!0,targetLocation:"commodity_market"})),l("æœ‰é€‰æ‹©åœ°è´­ä¹°","ä½ ä»”ç»†æŒ‘é€‰ï¼Œåªè´­ä¹°é‚£äº›çœŸæ­£åˆ’ç®—çš„å•†å“ã€‚",d({market:{locationModifiers:{commodity_market:.9},productModifiers:{202:.7,203:.75},duration:1},forceLocationChange:!0,targetLocation:"commodity_market"})),l("æ”¾å¼ƒæ­¤æ¬¡æœºä¼š","ä½ è§‰å¾—ä»·æ ¼ä¼˜æƒ å¹…åº¦ä¸å¤Ÿå¤§ï¼Œå†³å®šä¸å‚ä¸æ­¤æ¬¡ä¼˜æƒ æ´»åŠ¨ã€‚",d({market:{locationModifiers:{commodity_market:.95},duration:1}}))],E({locations:["commodity_market"],probability:.25}),!0,h.LOCATION,1,"/assets/images/events/wholesale_discount.jpg"),v("mall_event","å•†åŸåäººæ´»åŠ¨","é«˜ç«¯å•†åŸä¸¾åŠäº†ä¸€åœºåäººè§é¢ä¼šï¼Œå¸å¼•äº†å¤§é‡äººæµã€‚å•†åœºå†…çš„å•†å“ä»·æ ¼ä¸´æ—¶ä¸Šè°ƒã€‚",[l("è¶æœºè®¾æ‘Šé”€å”®","ä½ åœ¨å•†åŸå¤–è®¾ç½®ä¸´æ—¶æ‘Šä½ï¼Œåˆ©ç”¨äººæµé‡å¢åŠ é”€å”®é¢ã€‚",d({money:1200,inventory:[{productId:"random",quantity:-5}]}),e=>e.player.inventoryUsed>=5),l("é¿å¼€äººç¾¤","ä½ å†³å®šé¿å¼€æ‹¥æŒ¤çš„äººç¾¤ï¼Œæ”¹å¤©å†æ¥è´­ç‰©ã€‚",d({forceLocationChange:!0}))],E({locations:["premium_mall"],probability:.2}),!0,h.LOCATION,1,"/assets/images/events/mall_celebrity.jpg"),v("electronics_expo","ç”µå­ç§‘æŠ€åŸå±•é”€ä¼š","ç”µå­ç§‘æŠ€åŸä¸¾åŠå¤§å‹æ•°ç äº§å“å±•é”€ä¼šï¼Œæœ€æ–°æ¬¾æ‰‹æœºå’Œæ™ºèƒ½æ‰‹è¡¨éƒ½æœ‰ç‰¹åˆ«ä¼˜æƒ ï¼è¿™æ˜¯é‡‡è´­ç”µå­äº§å“çš„ç»ä½³æ—¶æœºã€‚",[l("å‚è§‚å±•ä¼š","ä½ èŠ±è´¹ä¸€äº›æ—¶é—´å‚è§‚å±•é”€ä¼šï¼Œäº†è§£æœ€æ–°çš„ç§‘æŠ€è¶‹åŠ¿ã€‚",d({money:-100,market:{locationModifiers:{electronics_hub:.95},duration:1}})),l("é‡‡è´­ç‰¹ä»·ç”µå­äº§å“","ä½ å†³å®šæŠ•èµ„è´­ä¹°å±•ä¼šä¸Šçš„ç‰¹ä»·æ‰‹æœºå’Œæ™ºèƒ½æ‰‹è¡¨ï¼ŒæœŸæœ›èƒ½åœ¨ä»·æ ¼ä¸Šæ¶¨å‰è½¬å”®è·åˆ©ã€‚",d({money:-2e3,market:{locationProductModifiers:{electronics_hub:{301:.7,305:.75}},duration:2}}),e=>e.player.money>=2e3)],E({locations:["electronics_hub"],probability:.3}),!0,h.LOCATION,1,"/assets/images/events/electronics_expo.jpg"),v("market_inspection","å¸‚åœºæ£€æŸ¥","å¸‚åœºç®¡ç†äººå‘˜çªç„¶æ¥åˆ°æŠ˜æ‰£å¸‚åœºè¿›è¡Œæ£€æŸ¥ï¼ŒæŸ¥éªŒæ‘Šä½åˆè§„æ€§ï¼ä½ éœ€è¦å¿«é€Ÿå†³å®šå¦‚ä½•åº”å¯¹ã€‚",[l("é…åˆæ£€æŸ¥","ä½ ä¸»åŠ¨é…åˆæ£€æŸ¥ï¼Œå±•ç¤ºè‡ªå·±çš„åˆè§„ç»è¥ï¼Œè·å¾—äº†ç®¡ç†äººå‘˜çš„å¥½æ„Ÿã€‚",d({money:-50,attributes:{businessSkill:1}})),l("æš‚æ—¶ç¦»åœº","ä½ å†³å®šæš‚æ—¶æ”¶æ‘Šç¦»åœºï¼Œé¿å¼€è¿™æ¬¡æ£€æŸ¥ï¼Œä½†æŸå¤±äº†ä¸€å¤©çš„ç”Ÿæ„ã€‚",d({money:-300,attributes:{businessSkill:-1}}))],E({locations:["discount_market"],probability:.25}),!0,h.LOCATION,1,"/assets/images/events/market_inspection.jpg"),v("business_competition","å•†ä¸šç«èµ›","å½“åœ°ä¸¾åŠäº†ä¸€åœºå•†ä¸šæŠ€èƒ½ç«èµ›ï¼Œæµ‹è¯•å‚èµ›è€…çš„å•†ä¸šå¤´è„‘å’Œå†³ç­–èƒ½åŠ›ã€‚è¿™å¯èƒ½æ˜¯å±•ç¤ºä½ å®åŠ›çš„å¥½æœºä¼šï¼",[l("å…¨åŠ›å‚èµ›","ä½ å†³å®šå…¨åŠ›ä»¥èµ´å‚åŠ æ¯”èµ›ï¼Œå¸Œæœ›èƒ½è·å¾—å¥½åæ¬¡ã€‚",d({money:e=>{const t=e.player.attributes.businessSkill||0;return t>=8?5e3:t>=5?2e3:t>=3?500:0},attributes:{businessSkill:1,reputation:1}})),l("éšä¾¿å‚ä¸","ä½ æŠ±ç€å­¦ä¹ çš„æ€åº¦å‚åŠ æ¯”èµ›ï¼Œä¸æœŸæœ›è·å¥–ã€‚",d({money:200,attributes:{businessSkill:.5}})),l("æ”¾å¼ƒå‚èµ›","ä½ è®¤ä¸ºè‡ªå·±è¿˜æ²¡å‡†å¤‡å¥½ï¼Œå†³å®šæ”¾å¼ƒè¿™æ¬¡æ¯”èµ›æœºä¼šã€‚",d({}))],E({probability:.08,minWeek:25}),!1,h.PERSONAL,1,"/assets/images/events/business_competition.jpg"),v("market_insider_info","å†…å¹•æ¶ˆæ¯","ä½ çš„ä¸€ä¸ªæœ‹å‹é€éœ²ç»™ä½ ä¸€ä¸ªå¸‚åœºå†…å¹•æ¶ˆæ¯ï¼Œæš—ç¤ºæŸç±»å•†å“å³å°†å¤§æ¶¨ä»·ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå‘è´¢çš„å¥½æœºä¼šï¼",[l("ç›¸ä¿¡æ¶ˆæ¯å¹¶è¡ŒåŠ¨","ä½ ç›¸ä¿¡è¿™ä¸ªå†…å¹•æ¶ˆæ¯ï¼Œå†³å®šæŠ•å…¥å¤§é‡èµ„é‡‘è´­ä¹°ç›¸å…³å•†å“ã€‚",d({nextEvent:"insider_info_result"})),l("å°è§„æ¨¡è¯•æ°´","ä½ ä¸ç¡®å®šæ¶ˆæ¯çš„å¯é æ€§ï¼Œå†³å®šå°è§„æ¨¡æŠ•èµ„ä»¥é™ä½é£é™©ã€‚",d({nextEvent:"insider_info_result_small"})),l("å¿½ç•¥æ¶ˆæ¯","ä½ å¯¹è¿™ç§å†…å¹•æ¶ˆæ¯æŒæ€€ç–‘æ€åº¦ï¼Œå†³å®šä¸é‡‡å–ä»»ä½•è¡ŒåŠ¨ã€‚",d({}))],E({probability:.1,minWeek:15,playerMoney:{min:3e3}}),!1,h.MARKET,1,"/assets/images/events/insider_info.jpg"),v("insider_info_result","å†…å¹•æ¶ˆæ¯ç»“æœ","ä¸€å‘¨åï¼Œä½ ç­‰å¾…çœ‹åˆ°å†…å¹•æ¶ˆæ¯çš„ç»“æœ...",[l("æŸ¥çœ‹ç»“æœ","ä½ æ»¡æ€€æœŸå¾…åœ°æŸ¥çœ‹å¸‚åœºå˜åŒ–ã€‚",d({market:Math.random()>.3?{categoryModifier:["LUXURY","ELECTRONICS","CLOTHING"][Math.floor(Math.random()*3)],modifier:1.8,duration:2}:{globalPriceModifier:.9,duration:1}}))],E({requiredEvents:["market_insider_info"]}),!1,h.MARKET,1,"/assets/images/events/insider_result.jpg"),v("insider_info_result_small","å†…å¹•æ¶ˆæ¯å°è§„æ¨¡è¯•æ°´ç»“æœ","ä¸€å‘¨åï¼Œä½ ç­‰å¾…çœ‹åˆ°å†…å¹•æ¶ˆæ¯çš„ç»“æœ...",[l("æŸ¥çœ‹ç»“æœ","ä½ æŸ¥çœ‹å°è§„æ¨¡æŠ•èµ„çš„ç»“æœã€‚",d({market:Math.random()>.3?{categoryModifier:["LUXURY","ELECTRONICS","CLOTHING"][Math.floor(Math.random()*3)],modifier:1.5,duration:1}:{globalPriceModifier:.95,duration:1}}))],E({requiredEvents:["market_insider_info"]}),!1,h.MARKET,1,"/assets/images/events/insider_result.jpg"),v("real_estate_opportunity","æˆ¿äº§æœºä¼š","ä½ å¶ç„¶å¬è¯´æœ‰ä¸€å¤„æˆ¿äº§å³å°†ä»¥ä½äºå¸‚åœºä»·çš„ä»·æ ¼å‡ºå”®ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªéš¾å¾—çš„ä¹°æˆ¿æœºä¼šã€‚",[l("ç«‹å³è€ƒå¯Ÿ","ä½ å†³å®šç«‹å³å»è€ƒå¯Ÿè¿™å¤„æˆ¿äº§ï¼Œçœ‹çœ‹æ˜¯å¦å€¼å¾—è´­ä¹°ã€‚",d({nextEvent:"real_estate_inspection"})),l("å’¨è¯¢ä¸“ä¸šäººå£«","ä½ å†³å®šå…ˆå’¨è¯¢ä¸€ä½æˆ¿äº§ä¸“å®¶ï¼Œè·å–ä¸“ä¸šæ„è§ã€‚",d({money:-500,nextEvent:"real_estate_expert_advice"}),e=>e.player.money>=500),l("å¿½ç•¥è¿™ä¸ªæ¶ˆæ¯","ä½ è®¤ä¸ºç›®å‰è¿˜æ²¡æœ‰å‡†å¤‡å¥½è´­æˆ¿ï¼Œå†³å®šå¿½ç•¥è¿™ä¸ªæ¶ˆæ¯ã€‚",d({}))],E({probability:.1,minWeek:30,playerMoney:{min:5e4}}),!1,h.STORY,1,"/assets/images/events/real_estate_opportunity.jpg"),v("real_estate_inspection","æˆ¿äº§è€ƒå¯Ÿ","ä½ ä»”ç»†è€ƒå¯Ÿäº†è¿™å¤„æˆ¿äº§ï¼Œå‘ç°å®ƒç¡®å®ä½äºå¸‚åœºä»·ï¼Œä½†éœ€è¦ä¸€äº›ç»´ä¿®ã€‚",[l("ä»¥ä¼˜æƒ ä»·è´­ä¹°","ä½ å†³å®šæŠ“ä½è¿™ä¸ªæœºä¼šï¼Œä»¥ä¼˜æƒ ä»·æ ¼è´­ä¹°è¿™å¤„æˆ¿äº§ã€‚",d({money:-6e4,attributes:{housingValue:8e4}}),e=>e.player.money>=6e4),l("ç»§ç»­ç­‰å¾…æ›´å¥½çš„æœºä¼š","ä½ è®¤ä¸ºè¿™å¤„æˆ¿äº§ä¸å¤Ÿå®Œç¾ï¼Œå†³å®šç»§ç»­ç­‰å¾…æ›´å¥½çš„æœºä¼šã€‚",d({}))],E({requiredEvents:["real_estate_opportunity"]}),!1,h.STORY,1,"/assets/images/events/real_estate_inspection.jpg"),v("real_estate_expert_advice","ä¸“å®¶å»ºè®®","æˆ¿äº§ä¸“å®¶ä»”ç»†åˆ†æåå‘Šè¯‰ä½ ï¼Œè¿™å¤„æˆ¿äº§ä½ç½®å¾ˆå¥½ï¼Œä½†ç»´ä¿®æˆæœ¬å¯èƒ½æ¯”é¢„æœŸé«˜ã€‚",[l("æ¥å—å»ºè®®å¹¶è´­ä¹°","ä½ æ¥å—ä¸“å®¶å»ºè®®å¹¶å†³å®šè´­ä¹°è¿™å¤„æˆ¿äº§ï¼ŒåŒæ—¶ä¸ºç»´ä¿®é¢„ç•™èµ„é‡‘ã€‚",d({money:-65e3,attributes:{housingValue:85e3}}),e=>e.player.money>=65e3),l("æ”¾å¼ƒè¿™æ¬¡æœºä¼š","ä¸“å®¶çš„åˆ†æè®©ä½ æ„è¯†åˆ°é£é™©ï¼Œä½ å†³å®šæ”¾å¼ƒè¿™æ¬¡è´­æˆ¿æœºä¼šã€‚",d({}))],E({requiredEvents:["real_estate_opportunity"]}),!1,h.STORY,1,"/assets/images/events/real_estate_expert.jpg"),v("housing_market_boom","æˆ¿å¸‚ç¹è£","æœ€è¿‘æˆ¿åœ°äº§å¸‚åœºå¼‚å¸¸ç«çˆ†ï¼Œæˆ¿ä»·æ™®éä¸Šæ¶¨ã€‚ç°åœ¨å¯èƒ½æ˜¯è´­æˆ¿æˆ–å‡ºå”®ç°æœ‰æˆ¿äº§çš„å¥½æ—¶æœºã€‚",[l("æŠ“ç´§è´­æˆ¿","ä½ è®¤ä¸ºæˆ¿ä»·è¿˜ä¼šç»§ç»­ä¸Šæ¶¨ï¼Œå†³å®šè¶ç°åœ¨æŠ“ç´§è´­æˆ¿ã€‚",d({market:{houseMarketModifier:1.1,duration:4}})),l("å‡ºå”®ç°æœ‰æˆ¿äº§","ä½ å†³å®šè¶æˆ¿ä»·é«˜ç‚¹å‡ºå”®ç°æœ‰æˆ¿äº§ï¼Œè·å¾—å¯è§‚åˆ©æ¶¦ã€‚",d({money:e=>(e.player.attributes.housingValue||0)*1.15,attributes:{housingValue:0}}),e=>e.player.attributes.housingValue>0),l("è§‚æœ›å¸‚åœº","ä½ è®¤ä¸ºç›®å‰æˆ¿ä»·è¿‡é«˜ï¼Œå¯èƒ½æ˜¯æ³¡æ²«ï¼Œå†³å®šç»§ç»­è§‚æœ›ã€‚",d({}))],E({probability:.1,minWeek:35}),!0,h.MARKET,1,"/assets/images/events/housing_boom.jpg"),v("housing_market_crash","æˆ¿å¸‚å´©ç›˜","çªå‘ç»æµå±æœºå¯¼è‡´æˆ¿åœ°äº§å¸‚åœºæ€¥å‰§é™æ¸©ï¼Œæˆ¿ä»·å¼€å§‹ä¸‹è·Œã€‚è¿™å¯èƒ½æ˜¯ä½ä»·è´­å…¥çš„æœºä¼šï¼Œä¹Ÿå¯èƒ½å¸¦æ¥é£é™©ã€‚",[l("é€†åŠ¿è´­æˆ¿","ä½ è®¤ä¸ºè¿™æ˜¯éš¾å¾—çš„ä½ä»·è´­æˆ¿æœºä¼šï¼Œå†³å®šé€†åŠ¿è€Œä¸Šã€‚",d({market:{houseMarketModifier:.8,duration:3}})),l("è§‚æœ›å¸‚åœº","ä½ å†³å®šç­‰å¾…å¸‚åœºè¿›ä¸€æ­¥ç¨³å®šåå†åšå†³å®šã€‚",d({market:{houseMarketModifier:.85,duration:2}}))],E({probability:.08,minWeek:40,excludedEvents:["housing_market_boom"]}),!1,h.MARKET,1,"/assets/images/events/housing_crash.jpg"),v("business_partner_proposal","å•†ä¸šåˆä½œæè®®","ä¸€ä½ç»éªŒä¸°å¯Œçš„å•†äººæè®®ä¸ä½ åˆä½œå¼€å±•æ›´å¤§è§„æ¨¡çš„è´¸æ˜“ï¼Œä½†éœ€è¦ä½ æŠ•å…¥ä¸€ç¬”èµ„é‡‘ä½œä¸ºå¯åŠ¨èµ„æœ¬ã€‚",[l("æ¥å—åˆä½œ","ä½ å†³å®šä¸è¿™ä½å•†äººåˆä½œï¼ŒæŠ•å…¥ä¸€ç¬”èµ„é‡‘å¼€å±•å¤§è§„æ¨¡è´¸æ˜“ã€‚",d({money:-1e4,nextEvent:"business_partnership_result"}),e=>e.player.money>=1e4),l("å°è§„æ¨¡è¯•æ°´","ä½ å¯¹åˆä½œæŒè°¨æ…æ€åº¦ï¼Œå†³å®šå…ˆå°è§„æ¨¡æŠ•èµ„æµ‹è¯•ã€‚",d({money:-3e3,nextEvent:"business_partnership_small_result"}),e=>e.player.money>=3e3),l("æ‹’ç»åˆä½œ","ä½ å¯¹è¿™ä¸ªåˆä½œæè®®æŒæ€€ç–‘æ€åº¦ï¼Œå†³å®šå©‰æ‹’ã€‚",d({}))],E({probability:.1,minWeek:30,playerMoney:{min:1e4},attributes:{businessSkill:{min:5}}}),!1,h.STORY,1,"/assets/images/events/business_partner.jpg"),v("business_partnership_result","å•†ä¸šåˆä½œç»“æœ","å‡ å‘¨è¿‡å»äº†ï¼Œä½ ä¸å•†ä¸šä¼™ä¼´çš„åˆä½œé¡¹ç›®æœ‰äº†ç»“æœ...",[l("æŸ¥çœ‹ç»“æœ","ä½ æœŸå¾…åœ°æŸ¥çœ‹åˆä½œçš„æˆæœã€‚",d({money:e=>{const t=e.player.attributes.businessSkill||0,r=15e3,i=t*1e3;return r+i},attributes:{businessSkill:2}}))],E({requiredEvents:["business_partner_proposal"]}),!1,h.STORY,1,"/assets/images/events/partnership_result.jpg"),v("business_partnership_small_result","å°è§„æ¨¡åˆä½œç»“æœ","å‡ å‘¨è¿‡å»äº†ï¼Œä½ çš„å°è§„æ¨¡åˆä½œé¡¹ç›®æœ‰äº†ç»“æœ...",[l("æŸ¥çœ‹ç»“æœ","ä½ æŸ¥çœ‹å°è§„æ¨¡åˆä½œçš„æˆæœã€‚",d({money:e=>{const t=e.player.attributes.businessSkill||0,r=4500,i=t*300;return r+i},attributes:{businessSkill:1}}))],E({requiredEvents:["business_partner_proposal"]}),!1,h.STORY,1,"/assets/images/events/partnership_result.jpg"),v("final_opportunity","æœ€ç»ˆæœºä¼š","æ¸¸æˆæ¥è¿‘å°¾å£°ï¼Œå¸‚åœºå‡ºç°äº†ä¸€æ¬¡éš¾å¾—çš„ä»·æ ¼æ³¢åŠ¨ï¼Œè¿™å¯èƒ½æ˜¯ä½ æœ€åçš„å‘è´¢æœºä¼šï¼",[l("å…¨åŠ›æŠ•å…¥","ä½ å†³å®šå°†å¤§éƒ¨åˆ†èµ„é‡‘æŠ•å…¥åˆ°è¿™æ¬¡æœºä¼šä¸­ï¼Œå¸Œæœ›èƒ½å®ç°æœ€åçš„ç¿»ç›˜ã€‚",d({market:{globalPriceModifier:.6,duration:1},nextEvent:"final_market_surge"})),l("è°¨æ…æŠ•èµ„","ä½ å†³å®šè°¨æ…æŠ•èµ„ï¼Œé¿å…åœ¨æœ€åå…³å¤´å†’è¿‡å¤§é£é™©ã€‚",d({market:{globalPriceModifier:.8,duration:1}}))],E({minWeek:45,probability:.5}),!1,h.STORY,2,"/assets/images/events/final_opportunity.jpg"),v("final_market_surge","æœ€ç»ˆå¸‚åœºå¤§æ¶¨","å°±åœ¨æ¸¸æˆå³å°†ç»“æŸå‰ï¼Œå¸‚åœºå‡ºç°äº†æˆå‰§æ€§çš„ä»·æ ¼ä¸Šæ¶¨ï¼è¿™æ˜¯æœ€åçš„å˜ç°æœºä¼šã€‚",[l("å…¨éƒ¨å–å‡º","ä½ å†³å®šè¶è¿™æ¬¡ä»·æ ¼ä¸Šæ¶¨å…¨éƒ¨å–å‡ºåº“å­˜ï¼Œæœ€å¤§åŒ–ä½ çš„åˆ©æ¶¦ã€‚",d({market:{globalPriceModifier:2,duration:1}})),l("éƒ¨åˆ†å–å‡º","ä½ å†³å®šå–å‡ºéƒ¨åˆ†åº“å­˜ï¼Œä¿ç•™ä¸€äº›ä»¥é˜²åå¸‚ç»§ç»­ä¸Šæ¶¨ã€‚",d({market:{globalPriceModifier:1.7,duration:1}}))],E({requiredEvents:["final_opportunity"],minWeek:48}),!1,h.STORY,1,"/assets/images/events/market_surge.jpg"),v("property_expo","æˆ¿äº§å±•è§ˆä¼š","åŸå¸‚ä¸­å¿ƒæ­£åœ¨ä¸¾åŠä¸€åœºå¤§å‹æˆ¿äº§å±•è§ˆä¼šï¼Œå„ä¸ªå¼€å‘å•†éƒ½å¸¦æ¥äº†ä»–ä»¬æœ€æ–°çš„æ¥¼ç›˜é¡¹ç›®ã€‚è¿™æ˜¯äº†è§£å¸‚åœºåŠ¨æ€å’Œè·å–ä¼˜æƒ ä¿¡æ¯çš„å¥½æœºä¼šã€‚",[l("å‚è§‚å±•è§ˆä¼š","ä½ å†³å®šèŠ±æ—¶é—´å‚è§‚æˆ¿äº§å±•è§ˆä¼šï¼Œäº†è§£å¸‚åœºæœ€æ–°åŠ¨æ€ã€‚",d({money:-200,nextEvent:"property_expo_discover"}),e=>e.player.money>=200),l("ä¸ä¸­ä»‹äº¤è°ˆ","ä½ å†³å®šåªä¸å‡ ä½æˆ¿äº§ä¸­ä»‹äº¤è°ˆï¼Œä¸èŠ±å¤ªå¤šæ—¶é—´ã€‚",d({nextEvent:"property_broker_info"})),l("å¿½ç•¥è¿™ä¸ªæ´»åŠ¨","ä½ ç°åœ¨æ²¡æœ‰è´­æˆ¿è®¡åˆ’ï¼Œå†³å®šå¿½ç•¥è¿™æ¬¡å±•è§ˆä¼šã€‚",d({}))],E({probability:.15,minWeek:15,playerMoney:{min:3e4}}),!1,h.STORY,1,"/assets/images/events/property_expo.jpg"),v("property_expo_discover","å±•ä¼šå‘ç°","åœ¨å±•è§ˆä¼šä¸Šï¼Œä½ å‘ç°ä¸€ä¸ªæ­£åœ¨é¢„å”®çš„æ–°æ¥¼ç›˜ï¼Œå¼€å‘å•†æä¾›äº†ç‹¬ç‰¹çš„æŠ˜æ‰£æ–¹æ¡ˆã€‚é”€å”®äººå‘˜å‘Šè¯‰ä½ ï¼Œå¦‚æœç°åœ¨é¢„è®¢ï¼Œå¯ä»¥è·å¾—æ¯”å¸‚åœºä»·ä½15%çš„ä¼˜æƒ ã€‚",[l("é¢„ä»˜å®šé‡‘","ä½ å†³å®šæŠ“ä½è¿™ä¸ªæœºä¼šï¼Œé¢„ä»˜10%çš„å®šé‡‘é”å®šè¿™ä¸ªä¼˜æƒ ã€‚",d({money:e=>-1e4,nextEvent:"property_investment_result"}),e=>e.player.money>=1e4),l("è®°å½•ä¿¡æ¯","ä½ è®°ä¸‹äº†è¿™ä¸ªæ¥¼ç›˜çš„ä¿¡æ¯ï¼Œä½†å†³å®šå…ˆä¸ä»˜å®šé‡‘ï¼Œå›å»å†è€ƒè™‘ã€‚",d({nextEvent:"property_later_decision"})),l("å¯»æ‰¾å…¶ä»–æœºä¼š","ä½ å¯¹è¿™ä¸ªæ¥¼ç›˜ä¸å¤ªæ„Ÿå…´è¶£ï¼Œå†³å®šç»§ç»­å¯»æ‰¾å…¶ä»–æœºä¼šã€‚",d({}))],E({requiredEvents:["property_expo"]}),!1,h.STORY,1,"/assets/images/events/property_discover.jpg"),v("property_investment_result","æˆ¿äº§æŠ•èµ„ç»“æœ","å‡ å‘¨åï¼Œä½ æ”¶åˆ°å¼€å‘å•†çš„é€šçŸ¥ï¼Œä½ é¢„è®¢çš„æ¥¼ç›˜é¡¹ç›®è¿›å±•é¡ºåˆ©ï¼Œå·²ç»å¼€å§‹æ­£å¼å»ºè®¾ã€‚æ ¹æ®æœ€æ–°çš„å¸‚åœºè¯„ä¼°ï¼Œç±»ä¼¼æˆ¿äº§çš„ä»·å€¼å·²ç»ä¸Šæ¶¨äº†ã€‚",[l("ç»§ç»­æŒæœ‰","ä½ å†³å®šç»§ç»­æŒæœ‰è¿™é¡¹æŠ•èµ„ï¼ŒæœŸå¾…æˆ¿äº§å®Œå·¥åçš„å‡å€¼ã€‚",d({attributes:{housingInvestment:1e4,propertyValue:1e5},nextEvent:"property_completion_notice"})),l("è½¬è®©æŠ•èµ„","ä½ å†³å®šè¶ç€å¸‚åœºä¸Šæ¶¨ï¼Œå°†ä½ çš„é¢„è´­æƒè½¬è®©ç»™å…¶ä»–ä¹°å®¶ï¼Œè·å–å¿«é€Ÿåˆ©æ¶¦ã€‚",d({money:13e3,attributes:{housingInvestment:0,propertyValue:0}}))],E({requiredEvents:["property_expo_discover"]}),!1,h.STORY,1,"/assets/images/events/property_investment.jpg"),v("property_completion_notice","æˆ¿äº§å®Œå·¥é€šçŸ¥","ä½ æ”¶åˆ°äº†å¼€å‘å•†çš„é€šçŸ¥ï¼Œä½ æŠ•èµ„çš„æˆ¿äº§é¡¹ç›®å·²ç»å®Œå·¥ï¼Œç°åœ¨ä»·å€¼çº¦120,000å…ƒã€‚ä½ å¯ä»¥é€‰æ‹©æ”¯ä»˜å‰©ä½™çš„è´­æˆ¿æ¬¾å®Œæˆè´­ä¹°ï¼Œæˆ–è€…å‡ºå”®ä½ çš„é¢„è´­æƒã€‚",[l("å®Œæˆè´­ä¹°","ä½ å†³å®šæ”¯ä»˜å‰©ä½™çš„è´­æˆ¿æ¬¾ï¼Œå®Œæˆè¿™å¤„æˆ¿äº§çš„è´­ä¹°ã€‚",d({money:-9e4,attributes:{housingInvestment:0,propertyValue:12e4,hasHouse:!0},nextEvent:"new_house_celebration"}),e=>e.player.money>=9e4),l("å‡ºå”®é¢„è´­æƒ","ä½ å†³å®šå‡ºå”®ä½ çš„é¢„è´­æƒï¼Œè·å–æŠ•èµ„å›æŠ¥ã€‚",d({money:25e3,attributes:{housingInvestment:0,propertyValue:0}})),l("ç»§ç»­ç­‰å¾…","ä½ è®¤ä¸ºæˆ¿äº§ä»·å€¼è¿˜ä¼šä¸Šæ¶¨ï¼Œå†³å®šç»§ç»­æŒæœ‰ï¼Œä½†æš‚ä¸ä»˜æ¬¾ã€‚",d({nextEvent:"property_market_change"}))],E({requiredEvents:["property_investment_result"],minWeek:35}),!1,h.STORY,1,"/assets/images/events/property_completion.jpg"),v("property_market_change","æˆ¿äº§å¸‚åœºå˜åŒ–","ç”±äºå¸‚åœºæ¡ä»¶å˜åŒ–ï¼Œä½ æŒæœ‰çš„æˆ¿äº§é¢„è´­æƒä»·å€¼å‡ºç°äº†æ³¢åŠ¨ã€‚",[l("æŸ¥çœ‹å¸‚åœºå˜åŒ–","ä½ å¯†åˆ‡å…³æ³¨å¸‚åœºåŠ¨æ€ï¼ŒæŸ¥çœ‹ä½ çš„æŠ•èµ„å—åˆ°äº†ä»€ä¹ˆå½±å“ã€‚",d({attributes:{propertyValue:Math.random()>.5?13e4:11e4}}))],E({requiredEvents:["property_completion_notice"]}),!1,h.MARKET,1,"/assets/images/events/market_change.jpg"),v("new_house_celebration","æ–°æˆ¿åº†ç¥","ä½ ç»ˆäºæ‹¥æœ‰äº†è‡ªå·±çš„æˆ¿äº§ï¼è¿™æ˜¯äººç”Ÿçš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚æœ‹å‹ä»¬æè®®ä¸¾åŠä¸€ä¸ªå°å‹èšä¼šæ¥åº†ç¥è¿™ä¸€æ—¶åˆ»ã€‚",[l("ä¸¾åŠåº†ç¥æ´¾å¯¹","ä½ å†³å®šä¸¾åŠä¸€ä¸ªåº†ç¥æ´¾å¯¹ï¼Œé‚€è¯·æœ‹å‹ä»¬ä¸€èµ·åˆ†äº«è¿™ä¸ªå–œæ‚¦æ—¶åˆ»ã€‚",d({money:-2e3,attributes:{happiness:5,socialNetwork:2}}),e=>e.player.money>=2e3),l("ç®€å•åº†ç¥","ä½ å†³å®šç®€å•åœ°è¯·å‡ ä¸ªå¥½å‹åƒé¡¿é¥­åº†ç¥ä¸€ä¸‹ã€‚",d({money:-500,attributes:{happiness:3}}),e=>e.player.money>=500),l("ç‹¬è‡ªæ¬£èµ","ä½ å†³å®šç‹¬è‡ªä¸€äººå¥½å¥½æ¬£èµä½ çš„æ–°å®¶ï¼Œäº«å—è¿™ä»½æˆå°±æ„Ÿã€‚",d({attributes:{happiness:2}}))],E({requiredEvents:["property_completion_notice"]}),!1,h.PERSONAL,1,"/assets/images/events/house_celebration.jpg"),v("property_broker_info","æˆ¿äº§ä¸­ä»‹ä¿¡æ¯","ä¸æˆ¿äº§ä¸­ä»‹äº¤è°ˆåï¼Œä½ è·å¾—äº†ä¸€äº›å…³äºå½“å‰æˆ¿å¸‚çš„å†…éƒ¨ä¿¡æ¯ã€‚ä¸­ä»‹è¡¨ç¤ºï¼ŒæŸäº›ç‰¹å®šåŒºåŸŸçš„æˆ¿äº§å¯èƒ½å³å°†å‡å€¼ã€‚",[l("æ·±å…¥äº†è§£","ä½ å†³å®šä¸ä¸­ä»‹è¿›ä¸€æ­¥äº¤æµï¼Œäº†è§£æ›´å¤šç»†èŠ‚ã€‚",d({money:-500,nextEvent:"property_insider_tip"}),e=>e.player.money>=500),l("ä¿æŒå…³æ³¨","ä½ å¯¹è¿™äº›ä¿¡æ¯è¡¨ç¤ºæ„Ÿè°¢ï¼Œä½†å†³å®šæš‚æ—¶åªæ˜¯ä¿æŒå…³æ³¨ã€‚",d({}))],E({requiredEvents:["property_expo"]}),!1,h.STORY,1,"/assets/images/events/broker_info.jpg"),v("property_insider_tip","å†…éƒ¨æ¶ˆæ¯","æ”¯ä»˜å’¨è¯¢è´¹åï¼Œä¸­ä»‹å‘ä½ é€éœ²äº†ä¸€ä¸ªå†…éƒ¨æ¶ˆæ¯ï¼šåŸå¸‚è§„åˆ’éƒ¨é—¨å³å°†å®£å¸ƒåœ¨æŸåŒºåŸŸå»ºè®¾æ–°çš„åœ°é“çº¿ï¼Œè¿™å¾ˆå¯èƒ½å¯¼è‡´è¯¥åŒºåŸŸæˆ¿ä»·ä¸Šæ¶¨ã€‚",[l("æŠ•èµ„è¯¥åŒºåŸŸæˆ¿äº§","ä½ å†³å®šç›¸ä¿¡è¿™ä¸ªæ¶ˆæ¯ï¼ŒæŠ•èµ„è¯¥åŒºåŸŸçš„æˆ¿äº§ã€‚",d({money:-3e4,nextEvent:"property_insider_result"}),e=>e.player.money>=3e4),l("è°¨æ…è§‚æœ›","ä½ å¯¹è¿™ä¸ªæ¶ˆæ¯æŒè°¨æ…æ€åº¦ï¼Œå†³å®šå…ˆè§‚å¯Ÿä¸€æ®µæ—¶é—´ã€‚",d({nextEvent:"property_missed_opportunity"}))],E({requiredEvents:["property_broker_info"]}),!1,h.STORY,1,"/assets/images/events/insider_tip.jpg"),v("property_insider_result","å†…éƒ¨æ¶ˆæ¯ç»“æœ","å‡ å‘¨åï¼ŒåŸå¸‚è§„åˆ’éƒ¨é—¨æœç„¶å®£å¸ƒäº†æ–°åœ°é“çº¿çš„å»ºè®¾è®¡åˆ’ï¼Œä½ æŠ•èµ„çš„åŒºåŸŸæˆ¿äº§ä»·å€¼å¼€å§‹ä¸Šæ¶¨ï¼",[l("ç»§ç»­æŒæœ‰","ä½ å†³å®šç»§ç»­æŒæœ‰è¿™é¡¹æŠ•èµ„ï¼ŒæœŸå¾…æ›´å¤§çš„å‡å€¼ç©ºé—´ã€‚",d({attributes:{propertyValue:45e3}})),l("ç«‹å³å‡ºå”®","ä½ å†³å®šè¶ç€æ¶ˆæ¯å…¬å¸ƒåçš„ä»·æ ¼ä¸Šæ¶¨ç«‹å³å‡ºå”®è·åˆ©ã€‚",d({money:4e4,attributes:{propertyValue:0}}))],E({requiredEvents:["property_insider_tip"]}),!1,h.STORY,1,"/assets/images/events/insider_result.jpg"),v("property_missed_opportunity","é”™å¤±æœºä¼š","åŸå¸‚è§„åˆ’éƒ¨é—¨å®£å¸ƒäº†æ–°åœ°é“çº¿çš„å»ºè®¾è®¡åˆ’ï¼Œä¸­ä»‹æåˆ°çš„åŒºåŸŸæˆ¿ä»·æœç„¶ä¸Šæ¶¨äº†ã€‚ä½ æœ‰äº›é—æ†¾æ²¡æœ‰æŠŠæ¡è¿™ä¸ªæŠ•èµ„æœºä¼šã€‚",[l("å¯»æ‰¾æ–°æœºä¼š","é”™è¿‡äº†è¿™æ¬¡æœºä¼šï¼Œä½†ä½ å†³å®šç»§ç»­å¯»æ‰¾æ–°çš„æŠ•èµ„æœºä¼šã€‚",d({nextEvent:"property_new_opportunity"})),l("æ¥å—æ•™è®­","ä½ æ¥å—è¿™ä¸ªæ•™è®­ï¼Œå†³å®šä»¥ååœ¨æœ‰å†…éƒ¨æ¶ˆæ¯æ—¶æ›´åŠ æœæ–­ã€‚",d({attributes:{businessSkill:1}}))],E({requiredEvents:["property_insider_tip"]}),!1,h.STORY,1,"/assets/images/events/missed_opportunity.jpg"),v("property_new_opportunity","æ–°çš„æˆ¿äº§æœºä¼š","å°½ç®¡é”™è¿‡äº†ä¹‹å‰çš„æœºä¼šï¼Œä½†ä½ å¾ˆå¿«å‘ç°äº†å¦ä¸€ä¸ªæ½œåœ¨çš„æˆ¿äº§æŠ•èµ„æœºä¼šã€‚ä¸€å¤„ä½ç½®è¾ƒå¥½ä½†ç•¥æ˜¾è€æ—§çš„æˆ¿äº§æ­£åœ¨å‡ºå”®ï¼Œä»·æ ¼ç›¸å¯¹è¾ƒä½ã€‚",[l("è´­ä¹°å¹¶ç¿»æ–°","ä½ å†³å®šè´­ä¹°è¿™å¤„æˆ¿äº§å¹¶è¿›è¡Œç¿»æ–°ï¼Œæå‡å…¶ä»·å€¼ã€‚",d({money:-4e4,attributes:{propertyValue:4e4},nextEvent:"property_renovation_results"}),e=>e.player.money>=4e4),l("ä»…è´­ä¹°ä¸ç¿»æ–°","ä½ å†³å®šè´­ä¹°è¿™å¤„æˆ¿äº§ï¼Œä½†æš‚ä¸è¿›è¡Œç¿»æ–°ã€‚",d({money:-35e3,attributes:{propertyValue:35e3}}),e=>e.player.money>=35e3),l("æ”¾å¼ƒè¿™ä¸ªæœºä¼š","ç»è¿‡è¯„ä¼°ï¼Œä½ è®¤ä¸ºè¿™ä¸ªæœºä¼šé£é™©å¤ªå¤§ï¼Œå†³å®šæ”¾å¼ƒã€‚",d({}))],E({requiredEvents:["property_missed_opportunity"]}),!1,h.STORY,1,"/assets/images/events/new_opportunity.jpg"),v("property_renovation_results","æˆ¿äº§ç¿»æ–°ç»“æœ","ç»è¿‡ä¸€æ®µæ—¶é—´çš„ç¿»æ–°ï¼Œä½ çš„æˆ¿äº§ç„•ç„¶ä¸€æ–°ã€‚å‘¨è¾¹é‚»å±…å’Œæˆ¿äº§è¯„ä¼°å¸ˆéƒ½å¯¹ä½ çš„ç¿»æ–°å·¥ä½œè¡¨ç¤ºèµèµã€‚",[l("æŸ¥çœ‹æˆ¿äº§ä¼°å€¼","ä½ è¯·æˆ¿äº§è¯„ä¼°å¸ˆå¯¹ç¿»æ–°åçš„æˆ¿äº§è¿›è¡Œæ­£å¼ä¼°å€¼ã€‚",d({money:-500,attributes:{propertyValue:55e3}}),e=>e.player.money>=500),l("æŒ‚ç‰Œå‡ºå”®","ä½ å†³å®šå°†ç¿»æ–°åçš„æˆ¿äº§ç«‹å³æŒ‚ç‰Œå‡ºå”®ã€‚",d({nextEvent:"property_sale_result"})),l("ç»§ç»­æŒæœ‰","ä½ å†³å®šæš‚æ—¶ç»§ç»­æŒæœ‰è¿™å¤„æˆ¿äº§ï¼Œè§‚å¯Ÿå¸‚åœºå˜åŒ–ã€‚",d({}))],E({requiredEvents:["property_new_opportunity"]}),!1,h.STORY,1,"/assets/images/events/renovation_results.jpg"),v("property_sale_result","æˆ¿äº§å‡ºå”®ç»“æœ","ç»è¿‡å‡ å‘¨çš„æŒ‚ç‰Œï¼Œä½ çš„æˆ¿äº§ç»ˆäºæ‰¾åˆ°äº†ä¹°å®¶ã€‚ä¹°å®¶å¯¹æˆ¿å­çš„çŠ¶å†µéå¸¸æ»¡æ„ï¼Œæ„¿æ„æ”¯ä»˜ä¸€ä¸ªä¸é”™çš„ä»·æ ¼ã€‚",[l("æ¥å—æŠ¥ä»·","ä½ å†³å®šæ¥å—ä¹°å®¶çš„æŠ¥ä»·ï¼Œå®Œæˆæˆ¿äº§äº¤æ˜“ã€‚",d({money:6e4,attributes:{propertyValue:0,businessSkill:2}})),l("ç»§ç»­ç­‰å¾…æ›´é«˜æŠ¥ä»·","ä½ è®¤ä¸ºæˆ¿äº§ä»·å€¼æ›´é«˜ï¼Œå†³å®šæ‹’ç»å½“å‰æŠ¥ä»·ï¼Œç»§ç»­ç­‰å¾…ã€‚",d({nextEvent:"property_price_negotiation"}))],E({requiredEvents:["property_renovation_results"]}),!1,h.STORY,1,"/assets/images/events/sale_result.jpg"),v("property_price_negotiation","æˆ¿ä»·è°ˆåˆ¤","åœ¨æ‹’ç»äº†ç¬¬ä¸€ä½ä¹°å®¶çš„æŠ¥ä»·åï¼Œåˆæœ‰æ–°ä¹°å®¶å¯¹ä½ çš„æˆ¿äº§è¡¨ç¤ºäº†å…´è¶£ï¼ŒåŒæ–¹å¼€å§‹äº†ä»·æ ¼è°ˆåˆ¤ã€‚",[l("åšæŒè¦ä»·","ä½ åšæŒè‡ªå·±çš„å®šä»·ï¼Œè¡¨ç¤ºè¿™æ˜¯æœ€ç»ˆä»·æ ¼ã€‚",d({money:Math.random()>.5?65e3:0,attributes:Math.random()>.5?{propertyValue:0,businessSkill:3}:{businessSkill:1}})),l("é€‚å½“è®©æ­¥","ä½ å†³å®šåœ¨ä»·æ ¼ä¸Šé€‚å½“è®©æ­¥ï¼Œä»¥ç¡®ä¿äº¤æ˜“æˆåŠŸã€‚",d({money:58e3,attributes:{propertyValue:0,businessSkill:1}}))],E({requiredEvents:["property_sale_result"]}),!1,h.STORY,1,"/assets/images/events/price_negotiation.jpg"),v("property_later_decision","å»¶è¿Ÿè´­æˆ¿å†³å®š","åœ¨è®°å½•äº†æ¥¼ç›˜ä¿¡æ¯åï¼Œä½ ä¸€ç›´åœ¨è€ƒè™‘æ˜¯å¦åº”è¯¥æŠ•èµ„è¿™ä¸ªé¡¹ç›®ã€‚æœ€è¿‘ï¼Œä½ æ³¨æ„åˆ°è¯¥é¡¹ç›®çš„å¸‚åœºåå“å¾ˆå¥½ï¼Œé”€å”®è¿›å±•è¿…é€Ÿã€‚",[l("ç°åœ¨æŠ•èµ„","ä½ å†³å®šä¸å†çŠ¹è±«ï¼Œç«‹å³æŠ•èµ„è¿™ä¸ªé¡¹ç›®ï¼Œå°½ç®¡ä»·æ ¼å·²ç»ç•¥æœ‰ä¸Šæ¶¨ã€‚",d({money:-12e3,nextEvent:"property_investment_result"}),e=>e.player.money>=12e3),l("æ”¾å¼ƒè¿™ä¸ªé¡¹ç›®","ä½ å†³å®šæ”¾å¼ƒè¿™ä¸ªé¡¹ç›®ï¼Œç»§ç»­å¯»æ‰¾å…¶ä»–æŠ•èµ„æœºä¼šã€‚",d({}))],E({requiredEvents:["property_expo_discover"]}),!1,h.STORY,1,"/assets/images/events/later_decision.jpg"),v("bag_expansion_opportunity","èƒŒåŒ…æ‰©å±•æœºä¼š","ä½ é‡åˆ°ä¸€ä¸ªæ—…è¡Œç”¨å“åº—ï¼Œåº—ä¸»æ­£åœ¨å‡ºå”®ä¸€æ¬¾ç‰¹åˆ¶çš„é«˜å®¹é‡èƒŒåŒ…ï¼Œçœ‹èµ·æ¥å¾ˆå®ç”¨ã€‚",[l("è´­ä¹°é«˜çº§èƒŒåŒ…","ä½ è´­ä¹°äº†é«˜çº§èƒŒåŒ…ï¼Œç°åœ¨ä½ å¯ä»¥æºå¸¦æ›´å¤šç‰©å“äº†ã€‚",d({money:-5e3,capacity:20}),e=>e.player.money>=5e3),l("è´­ä¹°æ™®é€šèƒŒåŒ…","ä½ è´­ä¹°äº†ä¸€ä¸ªæ™®é€šèƒŒåŒ…ï¼Œç•¥å¾®å¢åŠ äº†æºå¸¦å®¹é‡ã€‚",d({money:-2e3,capacity:10}),e=>e.player.money>=2e3),l("æ”¾å¼ƒè´­ä¹°","ä½ å†³å®šæš‚æ—¶ä¸è´­ä¹°æ–°èƒŒåŒ…ã€‚",d({}))],E({probability:.8,playerMoney:{min:3e3}}),!1,h.RANDOM,2,"/assets/images/events/bag_expansion.jpg"),v("market_price_surge","å¥¢ä¾ˆå“ä¸æ”¶è—å“ä»·æ ¼é£™å‡","æœ€æ–°è´¢ç»æŠ¥é“ï¼šéšç€å¯Œè£•é˜¶å±‚æ¶ˆè´¹å›æš–ï¼Œé«˜ç«¯å•†åŸçš„å¥¢ä¾ˆå“å’Œåœ°ä¸‹é»‘å¸‚çš„ç¨€æœ‰æ”¶è—å“ä»·æ ¼å¤§å¹…ä¸Šæ¶¨ï¼Œå…¶ä¸­å°¤ä»¥åè¡¨å’Œå¤è‘£æ¶¨å¹…æœ€å¤§ã€‚",[l("è°ƒæ•´æŠ•èµ„ç­–ç•¥","ä½ ä»”ç»†åˆ†æäº†ä»·æ ¼æ³¢åŠ¨è¶‹åŠ¿ï¼Œå†³å®šè°ƒæ•´ä½ çš„äº¤æ˜“ç­–ç•¥ï¼Œé‡ç‚¹å…³æ³¨é«˜ç«¯å•†å“ã€‚",d({market:{globalPriceModifier:1.05,locationModifiers:{premium_mall:1.15,black_market:1.2},locationProductModifiers:{premium_mall:{401:1.5},black_market:{503:1.6}},duration:2}})),l("å‰å¾€é«˜ç«¯å¸‚åœº","ä½ å†³å®šç«‹å³å‰å¾€é«˜ç«¯å•†åŸå’Œåœ°ä¸‹é»‘å¸‚ï¼Œå¸Œæœ›èƒ½åœ¨ä»·æ ¼è¿›ä¸€æ­¥ä¸Šæ¶¨å‰é‡‡è´­ä¸€äº›æ½œåŠ›å•†å“ã€‚",d({forceLocationChange:!0,targetLocation:"premium_mall",market:{locationProductModifiers:{premium_mall:{401:1.3},black_market:{503:1.4}},duration:1}}))],E({probability:.3,minWeek:8}),!0,h.MARKET,1,"/assets/images/events/price_surge.jpg"),v("market_price_drop","å¸‚åœºä»·æ ¼ä¸‹è·Œ","å…¨çƒç»æµå‡ºç°æ³¢åŠ¨ï¼Œå¯¼è‡´å¤šä¸ªå¸‚åœºçš„å•†å“ä»·æ ¼å‡ºç°ä¸‹è·Œè¶‹åŠ¿ã€‚",[l("è§‚å¯Ÿå¸‚åœº","ä½ å†³å®šè§‚å¯Ÿå¸‚åœºåŠ¨å‘ï¼Œå¯»æ‰¾ä½ä»·è´­å…¥çš„æœºä¼šã€‚",d({market:{globalPriceModifier:.85,duration:1}}))],E({probability:.7}),!0,h.MARKET,1,"/assets/images/events/price_drop.jpg"),v("property_investment_chance","æˆ¿äº§æŠ•èµ„æœºä¼š","ä½ å¬è¯´ä¸€ä¸ªæ–°å…´åŒºåŸŸæ­£åœ¨å¼€å‘ï¼Œç°åœ¨è´­ä¹°æˆ¿äº§å¯èƒ½ä¼šæœ‰ä¸é”™çš„å‡å€¼ç©ºé—´ã€‚",[l("æŠ•èµ„æˆ¿äº§","ä½ å†³å®šæŠ•èµ„è¿™ä¸ªæ–°å…´åŒºåŸŸçš„æˆ¿äº§é¡¹ç›®ã€‚",d({money:-3e4,attributes:{housingInvestment:3e4,propertyValue:3e4},nextEvent:"property_investment_result"}),e=>e.player.money>=3e4),l("è°¨æ…è§‚æœ›","ä½ è§‰å¾—ç›®å‰æ—¶æœºä¸æˆç†Ÿï¼Œå†³å®šç»§ç»­è§‚æœ›ã€‚",d({}))],E({minWeek:10,playerMoney:{min:3e4}}),!1,h.STORY,1,"/assets/images/events/property_investment.jpg"),v("financial_advisor","ç†è´¢é¡¾é—®","ä½ é‡åˆ°äº†ä¸€ä½ä¸“ä¸šçš„ç†è´¢é¡¾é—®ï¼Œä»–æ„¿æ„ä¸ºä½ æä¾›ä¸€äº›æŠ•èµ„å»ºè®®ã€‚",[l("å’¨è¯¢å»ºè®®","ä½ æ”¯ä»˜å’¨è¯¢è´¹ï¼Œè·å¾—äº†ä¸€äº›å…³äºå½“å‰å¸‚åœºçš„ä¸“ä¸šå»ºè®®ã€‚",d({money:-1e3,market:{productModifiers:{apartment:1.05,second_hand:.95,highend:1.1},duration:1},attributes:{realEstateInsight:!0,realEstateAdvice:{apartment:"+5%",second_hand:"-5%",highend:"+10%"}}}),e=>e.player.money>=1e3),l("å§”æ‰˜æŠ•èµ„","ä½ å†³å®šå§”æ‰˜ä»–è¿›è¡Œä¸€äº›å°é¢æŠ•èµ„ã€‚",d({money:-3e3,nextEvent:"financial_advisor_result"}),e=>e.player.money>=3e3),l("å©‰æ‹’","ä½ ç¤¼è²Œåœ°æ‹’ç»äº†ä»–çš„å»ºè®®ã€‚",d({}))],E({probability:.6,minWeek:5}),!0,h.RANDOM,1,"/assets/images/events/financial_advisor.jpg"),v("financial_advisor_result","æŠ•èµ„ç»“æœ","ä½ ä¹‹å‰å§”æ‰˜ç†è´¢é¡¾é—®è¿›è¡Œçš„æŠ•èµ„æœ‰äº†ç»“æœã€‚",[l("æŸ¥çœ‹ç»“æœ",Math.random()<.7?"ä½ çš„æŠ•èµ„å–å¾—äº†ä¸é”™çš„å›æŠ¥ï¼Œè·å¾—äº†4000å…ƒã€‚":"å¾ˆé—æ†¾ï¼Œç”±äºå¸‚åœºæ³¢åŠ¨ï¼Œä½ çš„æŠ•èµ„å‡ºç°äº†äºæŸï¼Œåªæ”¶å›äº†2000å…ƒã€‚",d({money:Math.random()<.7?4e3:2e3}))],E({requiredEvents:["financial_advisor"]}),!1,h.STORY,1,"/assets/images/events/investment_result.jpg"),v({id:"supply_chain_disruption",title:"å…¨çƒä¾›åº”é“¾ä¸­æ–­å±æœº",description:"çªå‘æ–°é—»ï¼šå…¨çƒè´¸æ˜“é­é‡ä¸¥é‡ä¾›åº”é“¾ä¸­æ–­ï¼å„åœ°åŒºä¸åŒå•†å“ä»·æ ¼å‡ºç°å‰§çƒˆæ³¢åŠ¨ï¼Œéƒ¨åˆ†å•†å“çŸ­ç¼ºæ¶¨ä»·ï¼Œéƒ¨åˆ†å•†å“ç§¯å‹é™ä»·ã€‚æ­¤æ¬¡å±æœºé¢„è®¡å°†å¯¹å¸‚åœºäº§ç”Ÿæ·±è¿œå½±å“ã€‚",type:h.MARKET,options:[l("åœ¨å¤§å®—å¸‚åœºå›¤ç§¯åŸºæœ¬ç‰©èµ„","ä½ é¢„åˆ¤åˆ°åŸºæœ¬ç”Ÿæ´»ç‰©èµ„å°†ä¼šçŸ­ç¼ºï¼Œå†³å®šå‰å¾€å¤§å®—å•†å“äº¤æ˜“æ‰€å›¤ç§¯å¿…éœ€å“ã€‚",{market:{globalPriceModifier:1.05,locationProductModifiers:{commodity_market:{202:1.6,203:1.5,101:1.4},electronics_hub:{301:.7,305:.75},premium_mall:{404:.8}},duration:4},forceLocationChange:!0,targetLocation:"commodity_market"}),l("æŠ•èµ„å—å½±å“å•†å“","ä½ è®¤ä¸ºè¿™æ˜¯æŠ•èµ„ä½ä»·ç”µå­äº§å“çš„å¥½æœºä¼šï¼Œå†³å®šå‰å¾€ç”µå­ç§‘æŠ€åŸå¤§é‡è´­å…¥ã€‚",{market:{locationModifiers:{electronics_hub:.85},locationProductModifiers:{electronics_hub:{301:.6,305:.65},commodity_market:{202:1.45,203:1.4}},duration:3},forceLocationChange:!0,targetLocation:"electronics_hub"}),l("å¯»æ‰¾é»‘å¸‚ç¨€ç¼ºèµ„æº","ä½ çŒœæµ‹æŸäº›ç‰¹æ®Šå•†å“å¯èƒ½åœ¨é»‘å¸‚å˜å¾—æ›´åŠ ç¨€ç¼ºä¸”ä»·å€¼ä¸Šå‡ï¼Œå†³å®šå‰å¾€åœ°ä¸‹é»‘å¸‚æ¢ç´¢æœºä¼šã€‚",{market:{locationModifiers:{black_market:1.2},locationProductModifiers:{black_market:{502:1.8,503:1.9},second_hand_market:{107:.7,106:.75,108:.72,109:.68}},duration:3},forceLocationChange:!0,targetLocation:"black_market"}),l("ä¿æŒè§‚æœ›","ä½ å†³å®šæš‚æ—¶ä¸ä»‹å…¥è¿™æ¬¡æ··ä¹±çš„å¸‚åœºæ³¢åŠ¨ï¼Œç­‰å¾…å½¢åŠ¿æ›´åŠ æ˜æœ—ã€‚",{market:{globalPriceModifier:1.02,duration:2}})],conditions:{probability:.15,minWeek:15},repeatable:!1,weight:3}),v({id:"market_contrast_event",title:"åŸå¸‚åŒºåŸŸå‘å±•ä¸å‡",description:"æœ€æ–°åŸå¸‚è§„åˆ’è°ƒæ•´å¯¼è‡´ç”µå­ç§‘æŠ€åŸè·å¾—å¤§é‡æŠ•èµ„å’Œå®¢æµï¼Œè€Œåœ°ä¸‹é»‘å¸‚å´å› ç®¡æ§åŠ å¼ºè€Œå®¢æµé”å‡ã€‚è¿™ç§å‘å±•ä¸å‡è¡¡å¼•å‘äº†æ˜æ˜¾çš„å¸‚åœºå·®å¼‚ã€‚",type:h.MARKET,options:[l("åˆ†æå¸‚åœºæœºä¼š","ä½ ä»”ç»†åˆ†æäº†åŸå¸‚ä¸åŒåŒºåŸŸçš„å‘å±•å˜åŒ–ï¼Œå¯»æ‰¾å…¶ä¸­çš„äº¤æ˜“æœºä¼šã€‚",{market:{locationModifiers:{electronics_hub:.8,black_market:1.4},duration:5}})],conditions:{probability:.2,minWeek:12},repeatable:!0,weight:2})];let je=[];const Be=[],Ye=[],at=[],ct=[],lt=[],ut=[];function ar(){Be.length>0||nr.forEach(e=>{const t=e.options.map(i=>i instanceof ze?i:new ze(i)),r=new qe({...e,options:t,imageUrl:e.imageUrl||(typeof e[8]=="string"?e[8]:null)});switch(r.type){case h.TUTORIAL:Be.push(r);break;case h.RANDOM:Ye.push(r);break;case h.LOCATION:at.push(r);break;case h.MARKET:ct.push(r);break;case h.PERSONAL:lt.push(r);break;case h.STORY:ut.push(r);break;default:Ye.push(r)}})}function cr(){if(ar(),je.length>0)return je;const e=[];return e.push(...Be),e.push(...Ye),e.push(...at),e.push(...ct),e.push(...lt),e.push(...ut),e.push(v({id:"location_inflation_electronics_hub",title:"ç”µå­ç§‘æŠ€åŸèŠ¯ç‰‡çŸ­ç¼º",description:"æœ€æ–°æ¶ˆæ¯ï¼šç”µå­ç§‘æŠ€åŸçš„ä¸»è¦èŠ¯ç‰‡ä¾›åº”å•†å·¥å‚åœäº§ï¼Œå¯¼è‡´è¯¥åœ°åŒºç”µå­äº§å“æ•´ä½“æ¶¨ä»·ã€‚åˆ†æå¸ˆé¢„è®¡è¿™ç§æƒ…å†µå°†æŒç»­æ•°å‘¨ã€‚",type:h.MARKET,options:[l("äº†è§£æƒ…å†µ","ä½ è®°ä¸‹äº†è¿™ä¸ªä¿¡æ¯ï¼Œè¿™å¯èƒ½å½±å“ä½ åœ¨ç”µå­ç§‘æŠ€åŸçš„äº¤æ˜“ç­–ç•¥ã€‚",{market:{locationModifiers:{electronics_hub:1.3},duration:4}})],conditions:{probability:.3,minWeek:5},repeatable:!0,weight:2}),v({id:"premium_mall_luxury_watch_discount",title:"é«˜ç«¯å•†åŸåè¡¨ä¿ƒé”€",description:"é«˜ç«¯å•†åŸçš„åè¡¨ä¸“æŸœå¼€å§‹å¤§è§„æ¨¡ä¿ƒé”€æ´»åŠ¨ï¼Œæ‰€æœ‰å“ç‰Œæ‰‹è¡¨éƒ½æœ‰ç‰¹åˆ«æŠ˜æ‰£ã€‚è¿™æ˜¯è´­ä¹°å¥¢ä¾ˆæ‰‹è¡¨çš„å¥½æœºä¼šï¼",type:h.MARKET,options:[l("è®°ä¸‹ä¿¡æ¯","ä½ è®°ä¸‹äº†è¿™ä¸ªä¿ƒé”€ä¿¡æ¯ï¼Œå¯ä»¥è€ƒè™‘å»é«˜ç«¯å•†åŸè´­ä¹°æ‰‹è¡¨ã€‚",{market:{locationProductModifiers:{premium_mall:{401:.6}},duration:2}})],conditions:{probability:.3,minWeek:3},repeatable:!0,weight:1}),v({id:"nationwide_paper_shortage",title:"å…¨å›½æ€§çº¸å¼ çŸ­ç¼º",description:"ç”±äºç¯ä¿æ”¿ç­–æ”¶ç´§å’ŒåŸæ–™ä»·æ ¼ä¸Šæ¶¨ï¼Œå…¨å›½èŒƒå›´å†…å‡ºç°çº¸å¼ çŸ­ç¼ºç°è±¡ã€‚å¤§å®—å•†å“äº¤æ˜“æ‰€å’ŒäºŒæ‰‹å¸‚åœºçš„å«ç”Ÿçº¸ä»·æ ¼é£™å‡ï¼Œè€Œå…¶ä»–åœ°åŒºå—å½±å“è¾ƒå°ã€‚",type:h.MARKET,options:[l("åˆ†æå½±å“","ä½ åˆ†æäº†è¿™æ¬¡çº¸å¼ çŸ­ç¼ºå¯¹å„ä¸ªå¸‚åœºçš„å½±å“ï¼Œå¹¶è°ƒæ•´äº†ä½ çš„äº¤æ˜“ç­–ç•¥ã€‚",{market:{locationProductModifiers:{commodity_market:{101:1.7},second_hand_market:{101:1.5}},duration:3}})],conditions:{probability:.25,minWeek:8},repeatable:!0,weight:2}),v({id:"market_contrast_event",title:"åŸå¸‚åŒºåŸŸå‘å±•ä¸å‡",description:"æœ€æ–°åŸå¸‚è§„åˆ’è°ƒæ•´å¯¼è‡´ç”µå­ç§‘æŠ€åŸè·å¾—å¤§é‡æŠ•èµ„å’Œå®¢æµï¼Œè€Œåœ°ä¸‹é»‘å¸‚å´å› ç®¡æ§åŠ å¼ºè€Œå®¢æµé”å‡ã€‚è¿™ç§å‘å±•ä¸å‡è¡¡å¼•å‘äº†æ˜æ˜¾çš„å¸‚åœºå·®å¼‚ã€‚",type:h.MARKET,options:[l("åˆ†æå¸‚åœºæœºä¼š","ä½ ä»”ç»†åˆ†æäº†åŸå¸‚ä¸åŒåŒºåŸŸçš„å‘å±•å˜åŒ–ï¼Œå¯»æ‰¾å…¶ä¸­çš„äº¤æ˜“æœºä¼šã€‚",{market:{locationModifiers:{electronics_hub:.8,black_market:1.4},duration:5}})],conditions:{probability:.2,minWeek:12},repeatable:!0,weight:2}),v({id:"supply_chain_disruption",title:"å…¨çƒä¾›åº”é“¾ä¸­æ–­å±æœº",description:"çªå‘æ–°é—»ï¼šå…¨çƒè´¸æ˜“é­é‡ä¸¥é‡ä¾›åº”é“¾ä¸­æ–­ï¼å„åœ°åŒºä¸åŒå•†å“ä»·æ ¼å‡ºç°å‰§çƒˆæ³¢åŠ¨ï¼Œéƒ¨åˆ†å•†å“çŸ­ç¼ºæ¶¨ä»·ï¼Œéƒ¨åˆ†å•†å“ç§¯å‹é™ä»·ã€‚æ­¤æ¬¡å±æœºé¢„è®¡å°†å¯¹å¸‚åœºäº§ç”Ÿæ·±è¿œå½±å“ã€‚",type:h.MARKET,options:[l("åœ¨å¤§å®—å¸‚åœºå›¤ç§¯åŸºæœ¬ç‰©èµ„","ä½ é¢„åˆ¤åˆ°åŸºæœ¬ç”Ÿæ´»ç‰©èµ„å°†ä¼šçŸ­ç¼ºï¼Œå†³å®šå‰å¾€å¤§å®—å•†å“äº¤æ˜“æ‰€å›¤ç§¯å¿…éœ€å“ã€‚",{market:{globalPriceModifier:1.05,locationProductModifiers:{commodity_market:{202:1.6,203:1.5,101:1.4},electronics_hub:{301:.7,305:.75},premium_mall:{404:.8}},duration:4},forceLocationChange:!0,targetLocation:"commodity_market"}),l("æŠ•èµ„å—å½±å“å•†å“","ä½ è®¤ä¸ºè¿™æ˜¯æŠ•èµ„ä½ä»·ç”µå­äº§å“çš„å¥½æœºä¼šï¼Œå†³å®šå‰å¾€ç”µå­ç§‘æŠ€åŸå¤§é‡è´­å…¥ã€‚",{market:{locationModifiers:{electronics_hub:.85},locationProductModifiers:{electronics_hub:{301:.6,305:.65},commodity_market:{202:1.45,203:1.4}},duration:3},forceLocationChange:!0,targetLocation:"electronics_hub"}),l("å¯»æ‰¾é»‘å¸‚ç¨€ç¼ºèµ„æº","ä½ çŒœæµ‹æŸäº›ç‰¹æ®Šå•†å“å¯èƒ½åœ¨é»‘å¸‚å˜å¾—æ›´åŠ ç¨€ç¼ºä¸”ä»·å€¼ä¸Šå‡ï¼Œå†³å®šå‰å¾€åœ°ä¸‹é»‘å¸‚æ¢ç´¢æœºä¼šã€‚",{market:{locationModifiers:{black_market:1.2},locationProductModifiers:{black_market:{502:1.8,503:1.9},second_hand_market:{107:.7,106:.75}},duration:3},forceLocationChange:!0,targetLocation:"black_market"}),l("ä¿æŒè§‚æœ›","ä½ å†³å®šæš‚æ—¶ä¸ä»‹å…¥è¿™æ¬¡æ··ä¹±çš„å¸‚åœºæ³¢åŠ¨ï¼Œç­‰å¾…å½¢åŠ¿æ›´åŠ æ˜æœ—ã€‚",{market:{globalPriceModifier:1.02,duration:2}})],conditions:{probability:.15,minWeek:15},repeatable:!1,weight:3})),je=e,e}class lr{constructor(){this.events={},this.onceEvents={}}on(t,r){return this.events[t]||(this.events[t]=[]),this.events[t].push(r),()=>this.off(t,r)}once(t,r){return this.onceEvents[t]||(this.onceEvents[t]=[]),this.onceEvents[t].push(r),()=>{if(this.onceEvents[t]){const i=this.onceEvents[t].indexOf(r);i!==-1&&this.onceEvents[t].splice(i,1)}}}off(t,r){if(this.events[t]){const i=this.events[t].indexOf(r);i!==-1&&this.events[t].splice(i,1)}}emit(t,r){if(this.events[t]&&this.events[t].forEach(i=>{try{i(r)}catch(s){R(s,`EventEmitter.emit(${t})`,L.SYSTEM,_.WARNING),console.error(`Error in event listener for ${t}:`,s)}}),this.onceEvents[t]){const i=[...this.onceEvents[t]];this.onceEvents[t]=[],i.forEach(s=>{try{s(r)}catch(o){R(o,`EventEmitter.emit.once(${t})`,L.SYSTEM,_.WARNING),console.error(`Error in once event listener for ${t}:`,o)}})}}clear(){this.events={},this.onceEvents={}}clearEvent(t){t&&(this.events[t]=[],this.onceEvents[t]=[])}}const ne=new lr,Se={EASY:"easy",NORMAL:"normal",HARD:"hard"},et={[Se.EASY]:{player:{initialMoney:8e3,initialDebt:1e3,initialCapacity:150,debtInterestRate:.004,debtGracePeriod:4},market:{priceTrendStrength:.8,priceVolatility:.8,specialProductDiscount:.25,trendContinuationChance:.8},events:{positiveEventChance:.7,eventFrequency:.3,earlyGameEventMultiplier:.7,lateGameEventMultiplier:1.1},houses:{housePriceMultipliers:{apartment:.9,house:.9,villa:.85,mansion:.85}},gameGoals:{requiredNetWorth:35e4,targetWeeks:52,debtRatio:.5}},[Se.NORMAL]:{player:{initialMoney:5e3,initialDebt:2e3,initialCapacity:100,debtInterestRate:.005,debtGracePeriod:3},market:{priceTrendStrength:1,priceVolatility:1,specialProductDiscount:.15,trendContinuationChance:.75},events:{positiveEventChance:.5,eventFrequency:.4,earlyGameEventMultiplier:.8,lateGameEventMultiplier:1.2},houses:{housePriceMultipliers:{apartment:1,house:1,villa:1,mansion:1}},gameGoals:{requiredNetWorth:4e5,targetWeeks:52,debtRatio:.4}},[Se.HARD]:{player:{initialMoney:3500,initialDebt:3e3,initialCapacity:80,debtInterestRate:.006,debtGracePeriod:2},market:{priceTrendStrength:1.2,priceVolatility:1.3,specialProductDiscount:.1,trendContinuationChance:.7},events:{positiveEventChance:.4,eventFrequency:.5,earlyGameEventMultiplier:.9,lateGameEventMultiplier:1.3},houses:{housePriceMultipliers:{apartment:1.1,house:1.15,villa:1.2,mansion:1.25}},gameGoals:{requiredNetWorth:45e4,targetWeeks:52,debtRatio:.35}}};function ur(e=Se.NORMAL){return et[e]||et[Se.NORMAL]}function dr(e,t=52){const r=e/t;return r<.2?{phase:"early",eventMultiplier:.8,priceVolatilityMultiplier:.9}:r<.4?{phase:"early_mid",eventMultiplier:.9,priceVolatilityMultiplier:1}:r<.6?{phase:"mid",eventMultiplier:1,priceVolatilityMultiplier:1}:r<.8?{phase:"mid_late",eventMultiplier:1.1,priceVolatilityMultiplier:1.1}:{phase:"late",eventMultiplier:1.2,priceVolatilityMultiplier:1.2}}const ae={EVENT_TRIGGERED:"event:triggered",EVENT_COMPLETED:"event:completed",EVENT_OPTION_SELECTED:"event:option_selected",EVENT_EFFECTS_APPLIED:"event:effects_applied"},ge={POSITIVE:"positive",NEGATIVE:"negative",NEUTRAL:"neutral"},Y={EARLY:"early",MID:"mid",LATE:"late"};class mr{constructor(t){this.events=t||[],this.triggeredEvents=new Set,this.activeEvents=[],this.eventHistory=[],this.cooldowns={},this.difficultyLevel="normal"}setDifficulty(t){this.difficultyLevel=t}generateStageAppropriateEvent(t){var A,C,F;console.log("å°è¯•ç”Ÿæˆé˜¶æ®µé€‚å½“çš„äº‹ä»¶ï¼Œå½“å‰å‘¨æ•°:",t.currentWeek);const{currentWeek:r,maxWeeks:i=52}=t,s=r/i;let o;s<.3?o=Y.EARLY:s<.7?o=Y.MID:o=Y.LATE,console.log("å½“å‰æ¸¸æˆé˜¶æ®µ:",o,"è¿›åº¦:",s);const n=ur(this.difficultyLevel),a=dr(r,i),c=n.events.eventFrequency*1.8,u=a.eventMultiplier*1.3,g=Math.min(.95,c*u);console.log("äº‹ä»¶è§¦å‘æ¦‚ç‡è®¡ç®—:",{baseEventChance:c,stageMultiplier:u,finalEventChance:g});const m=Math.random(),p=m<=g;if(console.log(`éšæœºå€¼: ${m}, æ˜¯å¦è§¦å‘äº‹ä»¶: ${p}`),!p)return null;let f=n.events.positiveEventChance;o===Y.EARLY?f*=1.3:o===Y.LATE&&(f*=.8);const y=(A=t.currentLocation)==null?void 0:A.id;if(y){const N=this.eventHistory.filter(V=>{var q,ue;const ee=this.getEventById(V.id);return(ue=(q=ee==null?void 0:ee.conditions)==null?void 0:q.locations)==null?void 0:ue.includes(y)});if(N.length>3){const V=Math.min(.8,Math.pow(.9,N.length-3));eventProbability*=V}}t.player.money<5e3?f*=1.2:t.player.money>1e5&&(f*=.9);let k=1;const I=((C=t.player.attributes)==null?void 0:C.hasHouse)||!1,b=((F=t.player.attributes)==null?void 0:F.propertyValue)||0;!I&&b<1e3&&r>20?k=1.5:(I||b>5e4)&&(k=.7);const S=Math.random()<f?ge.POSITIVE:ge.NEGATIVE;console.log("äº‹ä»¶ç±»å‹ç¡®å®š:",{positiveChance:f,eventEffectType:S});const x=this.events.filter(N=>this.isEventInCooldown(N.id,r)||N.repeatable===!1&&this.triggeredEvents.has(N.id)||S===ge.POSITIVE&&N.effectType===ge.NEGATIVE||S===ge.NEGATIVE&&N.effectType===ge.POSITIVE||N.gameStage&&(N.gameStage===Y.EARLY&&o!==Y.EARLY||N.gameStage===Y.MID&&o!==Y.MID||N.gameStage===Y.LATE&&o!==Y.LATE)||N.id.startsWith("property_")&&Math.random()>k?!1:this.checkEventConditions(N,t));if(console.log(`ç­›é€‰åçš„ç¬¦åˆæ¡ä»¶äº‹ä»¶æ•°é‡: ${x.length}`),x.length===0)return null;const T=this.selectEventByWeight(x,s);return console.log("é€‰æ‹©çš„äº‹ä»¶:",T?T.id:"null"),T}checkForEvents(t,r=null){console.log("äº‹ä»¶ç³»ç»Ÿ - æ£€æŸ¥æ˜¯å¦è§¦å‘äº‹ä»¶, å½“å‰å‘¨æ•°:",t.currentWeek),console.log("äº‹ä»¶ç³»ç»Ÿ - å½“å‰åœ°ç‚¹:",t.currentLocation?t.currentLocation.id:"æœªçŸ¥");let i=.6;t.currentLocation&&t.currentLocation.eventProbability&&(i=t.currentLocation.eventProbability*1.5,console.log(`äº‹ä»¶ç³»ç»Ÿ - å½“å‰åœ°ç‚¹äº‹ä»¶è§¦å‘æ¦‚ç‡: ${i}`));const s=Math.min(1,(t.currentWeek||1)/52),o=s*.2;i+=o,i=Math.min(.95,i);const n=Math.random();if(console.log(`äº‹ä»¶ç³»ç»Ÿ - äº‹ä»¶éšæœºæ£€å®š: ${n.toFixed(2)} vs ${i.toFixed(2)} (è§¦å‘é˜ˆå€¼)`),r){const c=this.getEligibleEvents(t,r);if(console.log(`äº‹ä»¶ç³»ç»Ÿ - æ‰¾åˆ° ${c.length} ä¸ªç¬¦åˆæ¡ä»¶çš„ ${r} ç±»å‹äº‹ä»¶`),c.length===0)return null;const u=this.selectEventByWeight(c,s);return u&&(console.log("äº‹ä»¶ç³»ç»Ÿ - å·²é€‰æ‹©äº‹ä»¶:",u.id,u.title),this.recordEvent(u.id,t.currentWeek),ne.emit(ae.EVENT_TRIGGERED,{event:u,week:t.currentWeek})),u}let a;if(n<i&&this.events.length>0){const c=this.getEligibleEvents(t);if(console.log(`äº‹ä»¶ç³»ç»Ÿ - æ‰¾åˆ° ${c.length} ä¸ªç¬¦åˆæ¡ä»¶çš„äº‹ä»¶`),c.length>0)a=this.selectEventByWeight(c,s),console.log("äº‹ä»¶ç³»ç»Ÿ - é€‰æ‹©äº‹ä»¶:",a?a.id:"æ— ");else return console.log("äº‹ä»¶ç³»ç»Ÿ - æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„äº‹ä»¶"),null}else return console.log("äº‹ä»¶ç³»ç»Ÿ - éšæœºæ£€å®šæœªé€šè¿‡ï¼Œæœ¬å‘¨ä¸è§¦å‘äº‹ä»¶"),null;return a?(console.log("äº‹ä»¶ç³»ç»Ÿ - ç”Ÿæˆäº‹ä»¶æˆåŠŸ:",a.id,a.title),this.recordEvent(a.id,t.currentWeek),ne.emit(ae.EVENT_TRIGGERED,{event:a,week:t.currentWeek})):console.log("äº‹ä»¶ç³»ç»Ÿ - æ²¡æœ‰ç”Ÿæˆäº‹ä»¶"),a}getEligibleEvents(t,r=null){return this.events.filter(i=>r&&i.type!==r||this.isEventInCooldown(i.id,t.currentWeek)||i.repeatable===!1&&this.triggeredEvents.has(i.id)||this.eventHistory.filter(o=>o.id===i.id&&t.currentWeek-o.week<=10).length>=2&&Math.random()>.3?!1:this.checkEventConditions(i,t))}checkEventConditions(t,r){var s;const i=t.conditions||{};if(i.minWeek&&r.currentWeek<i.minWeek||i.maxWeek&&r.currentWeek>i.maxWeek||i.locations&&r.currentLocation&&!i.locations.includes(r.currentLocation.id))return!1;if(i.playerMoney){const{min:o,max:n}=i.playerMoney;if(o!==void 0&&r.player.money<o||n!==void 0&&r.player.money>n)return!1}if(i.playerDebt){const{min:o,max:n}=i.playerDebt;if(o!==void 0&&r.player.debt<o||n!==void 0&&r.player.debt>n)return!1}if(i.inventoryItems)for(const o of i.inventoryItems){const n=r.player.inventory.find(c=>c.productId===o.productId),a=n?n.quantity:0;if(o.minQuantity!==void 0&&a<o.minQuantity||o.maxQuantity!==void 0&&a>o.maxQuantity)return!1}if(i.attributes)for(const[o,{min:n,max:a}]of Object.entries(i.attributes)){const c=((s=r.player.attributes)==null?void 0:s[o])||0;if(n!==void 0&&c<n||a!==void 0&&c>a)return!1}if(i.requiredEvents){for(const o of i.requiredEvents)if(!this.triggeredEvents.has(o))return!1}if(i.excludedEvents){for(const o of i.excludedEvents)if(this.triggeredEvents.has(o))return!1}if(i.customCondition&&!i.customCondition(r))return!1;if(i.probability!==void 0){let o=i.probability;if(this.triggeredEvents.has(t.id)||(o=Math.min(.95,o*1.5)),Math.random()>o)return!1}return!0}isEventInCooldown(t,r){return this.cooldowns[t]?this.cooldowns[t]>r:!1}setEventCooldown(t,r,i=5){this.cooldowns[t]=r+i}recordEvent(t,r){this.triggeredEvents.add(t),this.eventHistory.push({id:t,week:r,timestamp:new Date().toISOString()});const i=this.getEventById(t);let s;switch(i==null?void 0:i.type){case h.PERSONAL:s=6;break;case h.MARKET:s=3;break;case h.LOCATION:s=2;break;default:s=4}i&&!i.repeatable&&(s=999),this.setEventCooldown(t,r,s)}selectEventByWeight(t,r=.5){if(!t||t.length===0)return null;let i=0;const s=t.map(n=>{let a=n.weight||1;if(n.type===h.STORY?a*=1.2:n.type===h.MARKET&&(a*=1.1),n.id.startsWith("property_")&&r>.4&&(a*=1+r),n.options&&n.options.some(u=>u.effects&&u.effects.nextEvent)&&(a*=1.3),n.id==="meet_mucs")return 0;this.triggeredEvents.has(n.id)?a*=.2:a*=2;const c=this.eventHistory.filter(u=>u.id===n.id).length;if(c>0){if(!n.repeatable)return 0;const m=Math.max(.2,Math.pow(.5,c));a*=m}return console.log(`äº‹ä»¶æƒé‡è®¡ç®— - ${n.id}: ${a.toFixed(2)}`),i+=a,a});if(i<=0)return null;let o=Math.random()*i;for(let n=0;n<t.length;n++)if(o-=s[n],o<=0)return t[n];return t[0]}getEventById(t){const r=this.events.find(i=>i.id===t);return r?this.prepareEvent(r):null}triggerSpecificEvent(t,r){const i=this.getEventById(t);return i?(this.recordEvent(t,r.currentWeek),ne.emit(ae.EVENT_TRIGGERED,{event:i,week:r.currentWeek,isSpecific:!0}),i):null}prepareEvent(t){if(!t)return null;const r={...t};return r.options&&(r.options=r.options.map(i=>(typeof i.text=="function"?i.displayText=i.text():i.displayText=i.text,i))),r}updateActiveEvents(){this.activeEvents=this.activeEvents.filter(r=>!r.expired);const t=Date.now();return this.activeEvents.forEach(r=>{r.expiryTime&&t>r.expiryTime&&(r.expired=!0)}),this.activeEvents}getActiveMarketModifiers(){this.updateActiveEvents();const t={globalPriceModifier:1,categoryModifiers:{},productModifiers:{},specialProducts:[]};return this.activeEvents.forEach(r=>{r.expired||(r.globalPriceModifier&&(t.globalPriceModifier*=r.globalPriceModifier),r.categoryModifiers&&Object.entries(r.categoryModifiers).forEach(([i,s])=>{t.categoryModifiers[i]=(t.categoryModifiers[i]||1)*s}),r.productModifiers&&Object.entries(r.productModifiers).forEach(([i,s])=>{t.productModifiers[i]=(t.productModifiers[i]||1)*s}),r.specialProducts&&(t.specialProducts=[...t.specialProducts,...r.specialProducts]))}),t}applyEventEffects(t,r){var s;const i={appliedEffects:[],failedEffects:[]};if(console.log("åº”ç”¨äº‹ä»¶æ•ˆæœ:",r),r.money!==void 0){const o=r.money;if(o>-1&&o<1&&o!==0){const n=o*t.player.money;if(o>0)t.player.money+=n,i.appliedEffects.push({type:"money",value:n,isPercentage:!0,percentage:o*100,success:!0});else if(t.player.money+n<0){const a=t.player.money;t.player.money=0,i.appliedEffects.push({type:"money",value:-a,isPercentage:!0,percentage:Math.abs(o)*100,success:!0})}else t.player.money+=n,i.appliedEffects.push({type:"money",value:n,isPercentage:!0,percentage:Math.abs(o)*100,success:!0})}else o>0?(t.player.money+=o,i.appliedEffects.push({type:"money",value:o,success:!0})):o<0&&(t.player.money+o<0?(console.warn("EventSystem - é‡‘é’±ä¸è¶³ï¼Œæ— æ³•æ‰£æ¬¾",{required:Math.abs(o),available:t.player.money}),i.failedEffects.push({type:"money",value:o,reason:"insufficient_funds"})):(t.player.money+=o,i.appliedEffects.push({type:"money",value:o,success:!0})))}if(r.debt!==void 0){const o=r.debt;if(o>0)t.player.debt+=o,i.appliedEffects.push({type:"debt",value:o,success:!0});else if(o<0)if(o>-1&&o<0){const n=Math.abs(o)*t.player.debt,a=Math.min(t.player.debt,n);t.player.debt-=a,i.appliedEffects.push({type:"debt",value:-a,isPercentage:!0,percentage:Math.abs(o)*100,success:!0})}else{const n=Math.min(t.player.debt,Math.abs(o));t.player.debt-=n,i.appliedEffects.push({type:"debt",value:-n,success:!0})}}if(r.items&&r.items.forEach(o=>{if(o.quantity>0){console.log("EventSystem - å¤„ç†ç‰©å“æ·»åŠ :",{productId:o.productId,quantity:o.quantity,price:o.price||0,gameStateProducts:t.products?`åŒ…å«${t.products.length}ä¸ªäº§å“`:"æ— äº§å“åˆ—è¡¨"});const n=Number(o.productId),a=String(o.productId);let c=null;if(t.products&&(c=t.products.find(u=>u.id===o.productId),!c&&!isNaN(n)&&(c=t.products.find(u=>u.id===n)),c||(c=t.products.find(u=>String(u.id)===a))),console.log("EventSystem - æ‰¾åˆ°äº§å“:",c?{id:c.id,name:c.name,category:c.category}:"null"),c){const u=c.size*o.quantity;t.player.inventoryUsed+u<=t.player.capacity?(console.log("EventSystem - æ·»åŠ ç‰©å“æ•ˆæœ:",{type:"item_add",productId:c.id,quantity:o.quantity,price:o.price||0}),i.appliedEffects.push({type:"item_add",productId:c.id,quantity:o.quantity,price:o.price||0,success:!0})):i.failedEffects.push({type:"item_add",productId:o.productId,quantity:o.quantity,reason:"inventory_full"})}else i.failedEffects.push({type:"item_add",productId:o.productId,quantity:o.quantity,reason:"product_not_found"})}else o.quantity<0&&(o.productId?i.appliedEffects.push({type:"item_remove",productId:o.productId,quantity:Math.abs(o.quantity),success:!0}):o.category&&i.appliedEffects.push({type:"item_remove_category",category:o.category,quantity:Math.abs(o.quantity),success:!0}))}),r.capacity&&(t.player.capacity+=r.capacity,i.appliedEffects.push({type:"capacity",value:r.capacity,success:!0})),r.attributes&&Object.keys(r.attributes).length>0){t.player.attributes||(t.player.attributes={});for(const[o,n]of Object.entries(r.attributes)){const a=t.player.attributes[o]||0;t.player.attributes[o]=n,i.appliedEffects.push({type:"attribute",attribute:o,oldValue:a,newValue:n,success:!0})}}if(r.market){const o={...r.market,startTime:Date.now(),expiryTime:r.market.duration?Date.now()+r.market.duration*7*24*60*60*1e3:Date.now()+12096e5,expired:!1};if(this.activeEvents.push(o),t.market&&t.market.productPrices){if(o.globalPriceModifier){console.log(`åº”ç”¨å…¨å±€ä»·æ ¼ä¿®æ­£: ${o.globalPriceModifier}`);for(const[n,a]of Object.entries(t.market.productPrices))t.market.productPrices[n]*=o.globalPriceModifier}if(o.categoryModifiers)for(const[n,a]of Object.entries(o.categoryModifiers)){console.log(`åº”ç”¨ç±»åˆ« ${n} ä»·æ ¼ä¿®æ­£: ${a}`);const c=((s=t.products)==null?void 0:s.filter(u=>u.category===n))||[];for(const u of c)t.market.productPrices[u.id]&&(t.market.productPrices[u.id]*=a)}if(o.productModifiers)for(const[n,a]of Object.entries(o.productModifiers))console.log(`åº”ç”¨äº§å“ ${n} ä»·æ ¼ä¿®æ­£: ${a}`),t.market.productPrices[n]&&(t.market.productPrices[n]*=a)}i.appliedEffects.some(n=>n.type==="market")||i.appliedEffects.push({type:"market",effect:{globalPriceModifier:o.globalPriceModifier,categoryModifiers:o.categoryModifiers,productModifiers:o.productModifiers,locationModifiers:o.locationModifiers,locationProductModifiers:o.locationProductModifiers,duration:o.duration},success:!0})}return r.nextEvent&&i.appliedEffects.push({type:"next_event",eventId:r.nextEvent,success:!0}),r.locationChange&&i.appliedEffects.push({type:"location_change",locationId:r.locationChange,success:!0}),ne.emit(ae.EVENT_EFFECTS_APPLIED,{effects:i.appliedEffects,failedEffects:i.failedEffects}),i}reset(){this.triggeredEvents.clear(),this.activeEvents=[],this.eventHistory=[],this.cooldowns={}}getSaveState(){return{triggeredEvents:Array.from(this.triggeredEvents),activeEvents:this.activeEvents,eventHistory:this.eventHistory,cooldowns:this.cooldowns}}loadFromSaveState(t){t&&(this.triggeredEvents=new Set(t.triggeredEvents||[]),this.activeEvents=t.activeEvents||[],this.eventHistory=t.eventHistory||[],this.cooldowns=t.cooldowns||{})}}const pr=()=>{const e=G(),{addToInventory:t,removeFromInventory:r,findByProductId:i}=ot(),s=(a,c,u)=>{console.log(`EventItemHandler - å¼€å§‹æ·»åŠ ç‰©å“ - å‚æ•°: productId=${a}, quantity=${c}, price=${u}`),console.log("EventItemHandler - å½“å‰playerStoreçŠ¶æ€:",{money:e.money,inventoryUsed:e.inventoryUsed,capacity:e.capacity,inventoryCount:e.inventory.length});let g=a;typeof a=="string"&&!isNaN(Number(a))&&(g=Number(a)),console.log(`EventItemHandler - å¤„ç†åçš„productId: ${g} (ç±»å‹: ${typeof g})`);const m=Dt(g);if(console.log("EventItemHandler - è·å–åˆ°çš„äº§å“å¯¹è±¡:",m?{id:m.id,name:m.name,basePrice:m.basePrice,size:m.size,category:m.category}:"null"),!m){const y=_e();console.log(`EventItemHandler - å°è¯•ä»${y.length}ä¸ªäº§å“ä¸­æŸ¥æ‰¾IDä¸º${g}çš„äº§å“`);const k=y.find(I=>I.id===g||I.id===Number(g)||String(I.id)===String(g));return k?(console.log("EventItemHandler - é€šè¿‡æ›¿ä»£æ–¹æ³•æ‰¾åˆ°äº§å“:",{id:k.id,name:k.name}),s(k.id,c,u)):(console.error("EventItemHandler - æ‰¾ä¸åˆ°äº§å“:",a),{success:!1,reason:"product_not_found"})}if(e.inventoryUsed+c>e.capacity)return console.error(`EventItemHandler - èƒŒåŒ…å®¹é‡ä¸è¶³: å½“å‰å·²ç”¨=${e.inventoryUsed}, éœ€è¦=${c}, æ€»å®¹é‡=${e.capacity}`),{success:!1,reason:"inventory_full"};const p={id:m.id,name:m.name,category:m.category,size:m.size||1,basePrice:m.basePrice};console.log(`EventItemHandler - è°ƒç”¨addToInventory: product=${p.name}, quantity=${c}, price=${u}`);const f=t(p,c,u);if(console.log("EventItemHandler - addToInventoryè¿”å›ç»“æœ:",f),!f.success){console.log("EventItemHandler - addToInventoryå¤±è´¥ï¼Œå°è¯•ç›´æ¥æ·»åŠ ç‰©å“");const y={productId:m.id,name:m.name,quantity:c,purchasePrice:u,totalValue:u*c,size:1},k=e.addInventoryItem(y);if(console.log("EventItemHandler - ç›´æ¥æ·»åŠ ç‰©å“ç»“æœ:",k),k)return{success:!0}}return console.log("EventItemHandler - æ·»åŠ åplayerStoreçŠ¶æ€:",{money:e.money,inventoryUsed:e.inventoryUsed,capacity:e.capacity,inventoryCount:e.inventory.length,inventory:e.inventory.map(y=>({productId:y.productId,name:y.name,quantity:y.quantity}))}),f.success?console.log(`EventItemHandler - æˆåŠŸæ·»åŠ ç‰©å“: ${m.name} x ${c}`):console.error(`EventItemHandler - æ·»åŠ ç‰©å“å¤±è´¥: ${f.message}`),f};return{addItem:s,removeItem:(a,c)=>{const u=e.inventory.findIndex(p=>p.productId==a);if(u===-1)return console.error("EventItemHandler - èƒŒåŒ…ä¸­æ‰¾ä¸åˆ°äº§å“:",a),{success:!1,reason:"product_not_found"};const g=e.inventory[u];if(g.quantity<c)return console.error("EventItemHandler - ç‰©å“æ•°é‡ä¸è¶³"),{success:!1,reason:"insufficient_items"};const m=r(u,c);return m.success?console.log(`EventItemHandler - æˆåŠŸç§»é™¤ç‰©å“: ${g.name} x ${c}`):console.error(`EventItemHandler - ç§»é™¤ç‰©å“å¤±è´¥: ${m.message}`),m},removeItemByCategory:(a,c)=>{const u=_e(),g=e.inventory.filter(y=>{const k=u.find(I=>I.id==y.productId);return k&&k.category===a});if(g.length===0)return console.error("EventItemHandler - èƒŒåŒ…ä¸­æ‰¾ä¸åˆ°è¯¥ç±»åˆ«çš„äº§å“:",a),{success:!1,reason:"category_not_found"};const m=g[0],p=e.inventory.indexOf(m);if(m.quantity<c)return console.error("EventItemHandler - ç‰©å“æ•°é‡ä¸è¶³"),{success:!1,reason:"insufficient_items"};const f=r(p,c);return f.success?console.log(`EventItemHandler - æˆåŠŸç§»é™¤ç±»åˆ«ç‰©å“: ${m.name} x ${c}`):console.error(`EventItemHandler - ç§»é™¤ç±»åˆ«ç‰©å“å¤±è´¥: ${f.message}`),f}}},Z=ce("event",{state:()=>({activeEvents:[],activeEvent:null,forceLocationChange:!1,targetLocation:null,nextEventId:null,triggeredEvents:[],eventSystem:null}),actions:{initializeEvents(){return console.log("EventStore - åˆå§‹åŒ–äº‹ä»¶ç³»ç»Ÿ"),new Promise(e=>{setTimeout(()=>{this.initEventSystem(),console.log("EventStore - äº‹ä»¶ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ"),e()},300)})},initEventSystem(){this.eventSystem=new mr(cr()),this.activeEvents=[],this.activeEvent=null,this.forceLocationChange=!1,this.targetLocation=null,this.nextEventId=null,this.triggeredEvents=[],this.setupEventListeners()},setupEventListeners(){ne.on(ae.EVENT_TRIGGERED,e=>{this.activeEvent=e.event}),ne.on(ae.EVENT_COMPLETED,e=>{this.activeEvent=null,e.nextEventId&&(this.nextEventId=e.nextEventId)}),ne.on(ae.EVENT_EFFECTS_APPLIED,e=>{const t=e.effects.find(i=>i.type==="location_change");t&&(this.forceLocationChange=!0,this.targetLocation=t.locationId);const r=e.effects.find(i=>i.type==="next_event");r&&(this.nextEventId=r.eventId)})},resetEvents(){this.eventSystem?this.eventSystem.reset():this.initEventSystem(),this.activeEvents=[],this.activeEvent=null,this.forceLocationChange=!1,this.targetLocation=null,this.nextEventId=null,this.triggeredEvents=[]},generateRandomEvent(e,t,r){if(console.log("EventStore - å°è¯•ç”Ÿæˆéšæœºäº‹ä»¶, å½“å‰å‘¨æ•°:",e),this.activeEvent!==null)return console.log("EventStore - å·²æœ‰å¾…å¤„ç†äº‹ä»¶ï¼Œè·³è¿‡ç”Ÿæˆ:",this.activeEvent.id),null;if(this.nextEventId){console.log("EventStore - æ£€æµ‹åˆ°é¢„è®¾çš„ä¸‹ä¸€ä¸ªäº‹ä»¶:",this.nextEventId);const i=this.eventSystem.getEventById(this.nextEventId);if(this.nextEventId=null,i)return console.log("EventStore - è§¦å‘é¢„è®¾äº‹ä»¶:",i.id,i.title),this.triggeredEvents.push({id:i.id,week:e}),this.activeEvent=i,i}console.log("EventStore - åˆ›å»ºæ¸¸æˆçŠ¶æ€å¯¹è±¡"),console.log("EventStore - playerData:",t?"å·²æä¾›":"æœªæä¾›"),console.log("EventStore - marketData:",r?"å·²æä¾›":"æœªæä¾›");try{const i={currentWeek:e,player:t,market:r,currentLocation:r.currentLocation};if(console.log("EventStore - æ¸¸æˆçŠ¶æ€å¯¹è±¡åˆ›å»ºæˆåŠŸ"),console.log("EventStore - å½“å‰åœ°ç‚¹:",i.currentLocation?i.currentLocation.id:"æœªçŸ¥"),Math.random()<.15){console.log("EventStore - å°è¯•è§¦å‘å½©è›‹äº‹ä»¶");const c=this.eventSystem.getEventById("meet_mucs");if(c&&this.eventSystem.checkEventConditions(c,i))return console.log("EventStore - æˆåŠŸè§¦å‘å½©è›‹äº‹ä»¶:",c.id,c.title),this.triggeredEvents.push({id:c.id,week:e}),this.activeEvent=c,c}const n=Math.min(.3,e*.01);console.log("EventStore - è°ƒç”¨äº‹ä»¶ç³»ç»Ÿæ£€æŸ¥äº‹ä»¶ï¼Œé¢å¤–æ¦‚ç‡:",n);let a=this.eventSystem.checkForEvents(i);return!a&&Math.random()<n&&(console.log("EventStore - åº”ç”¨é¢å¤–æ¦‚ç‡ï¼Œå¼ºåˆ¶å°è¯•ç”Ÿæˆäº‹ä»¶"),a=this.eventSystem.generateStageAppropriateEvent(i)),a?(console.log("EventStore - æˆåŠŸç”Ÿæˆäº‹ä»¶:",a.id,a.title),this.triggeredEvents.push({id:a.id,week:e}),this.activeEvent=a,a):(console.log("EventStore - æ²¡æœ‰ç”Ÿæˆäº‹ä»¶"),null)}catch(i){return R(i,"EventState.generateRandomEvent",L.GAME_LOGIC,_.ERROR),console.error("EventStore - ç”Ÿæˆéšæœºäº‹ä»¶æ—¶å‡ºé”™:",i),null}},triggerSpecificEvent(e,t,r){const i={currentWeek:t.statistics.weekCount,player:t,market:r,currentLocation:r.currentLocation},s=this.eventSystem.triggerSpecificEvent(e,i);return s?(this.triggeredEvents.push({id:s.id,week:t.statistics.weekCount}),s):null},triggerTutorialEvent(e){const t=e.startsWith("tutorial_")?e:`tutorial_${e}`,r=this.eventSystem.getEventById(t);return r?(this.activeEvent=r,r):null},triggerEvent(e){var t;try{if(e.startsWith("tutorial_"))return!!this.triggerTutorialEvent(e);{const r=(t=this.eventSystem)==null?void 0:t.getEventById(e);if(r)return this.activeEvent=r,!0}return!1}catch(r){return R(r,"EventState.triggerEvent",L.GAME_LOGIC,_.WARNING),console.error("è§¦å‘äº‹ä»¶å¤±è´¥:",r),!1}},handleEventOption(e,t,r){var n;if(!this.activeEvent||!e)return{success:!1,message:"æ— æ•ˆçš„äº‹ä»¶æˆ–é€‰é¡¹",appliedEffects:[]};console.log("EventState - å¤„ç†äº‹ä»¶é€‰é¡¹:",e),console.log("EventState - å½“å‰äº‹ä»¶:",this.activeEvent.id);const i={currentWeek:t.statistics.weekCount,player:t,market:r,currentLocation:r.currentLocation,products:r.products};console.log("EventState - åˆ›å»ºçš„gameStateå¯¹è±¡:",{currentWeek:i.currentWeek,playerMoney:i.player.money,marketData:r?"å­˜åœ¨":"ä¸å­˜åœ¨",currentLocation:i.currentLocation?i.currentLocation:"æ— åœ°ç‚¹",productsCount:i.products?i.products.length:0});let s;try{if(s=this.eventSystem.applyEventEffects(i,e.effects),console.log("EventState - äº‹ä»¶æ•ˆæœåº”ç”¨ç»“æœ:",s),s&&s.appliedEffects){const{addItem:a,removeItem:c,removeItemByCategory:u}=pr(),g=s.appliedEffects.filter(f=>f.type==="item_add");console.log("EventState - ç‰©å“æ·»åŠ æ•ˆæœæ•°é‡:",g.length,g),console.log("EventState - æ·»åŠ ç‰©å“å‰çš„ç©å®¶åº“å­˜:",JSON.stringify({inventory:t.inventory,inventoryUsed:t.inventoryUsed,capacity:t.capacity}));for(const f of g){console.log("EventState - å°è¯•æ·»åŠ ç‰©å“:",f.productId,f.quantity,f.price);const y=a(f.productId,f.quantity,f.price||0);if(!y.success){console.error("EventState - æ·»åŠ ç‰©å“å¤±è´¥:",y);const k=s.appliedEffects.indexOf(f);k!==-1&&s.appliedEffects.splice(k,1),s.failedEffects||(s.failedEffects=[]),s.failedEffects.push({...f,success:!1,reason:y.reason||"unknown_error"})}}const m=s.appliedEffects.filter(f=>f.type==="item_remove");for(const f of m){console.log("EventState - ç§»é™¤ç‰©å“:",f.productId,f.quantity);const y=c(f.productId,f.quantity);if(!y.success){console.error("EventState - ç§»é™¤ç‰©å“å¤±è´¥:",y);const k=s.appliedEffects.indexOf(f);k!==-1&&s.appliedEffects.splice(k,1),s.failedEffects||(s.failedEffects=[]),s.failedEffects.push({...f,success:!1,reason:y.reason||"unknown_error"})}}const p=s.appliedEffects.filter(f=>f.type==="item_remove_category");for(const f of p){console.log("EventState - æŒ‰ç±»åˆ«ç§»é™¤ç‰©å“:",f.category,f.quantity);const y=u(f.category,f.quantity);if(y.success)f.type="item_remove",f.productId=(n=y.product)==null?void 0:n.productId;else{console.error("EventState - æŒ‰ç±»åˆ«ç§»é™¤ç‰©å“å¤±è´¥:",y);const k=s.appliedEffects.indexOf(f);k!==-1&&s.appliedEffects.splice(k,1),s.failedEffects||(s.failedEffects=[]),s.failedEffects.push({...f,success:!1,reason:y.reason||"unknown_error"})}}}}catch(a){console.error("EventState - åº”ç”¨äº‹ä»¶æ•ˆæœæ—¶å‡ºé”™:",a),R(a,"EventState.handleEventOption",L.GAME_LOGIC,_.ERROR),s={success:!1,message:"åº”ç”¨äº‹ä»¶æ•ˆæœæ—¶å‡ºé”™",appliedEffects:[]}}const o=s||{success:!0,appliedEffects:[]};if(typeof o.success>"u"&&(o.success=!0),o.appliedEffects||(o.appliedEffects=[]),e.effects&&e.effects.nextEvent&&(this.nextEventId=e.effects.nextEvent,console.log("EventState - è®¾ç½®ä¸‹ä¸€ä¸ªäº‹ä»¶:",this.nextEventId)),e.effects&&e.effects.forceLocationChange&&(this.forceLocationChange=!0,this.targetLocation=e.effects.targetLocation,console.log("EventState - è®¾ç½®å¼ºåˆ¶åœ°ç‚¹å˜æ›´:",this.targetLocation)),e.effects&&e.effects.capacity&&e.effects.capacity>0&&(console.log("EventState - èƒŒåŒ…å®¹é‡å¢åŠ :",e.effects.capacity),t.capacity=t.capacity+e.effects.capacity,o.appliedEffects.some(a=>a.type==="capacity")||o.appliedEffects.push({type:"capacity",value:e.effects.capacity,success:!0})),e.effects&&e.effects.attributes){console.log("EventState - ç©å®¶å±æ€§å˜åŒ–:",e.effects.attributes),t.attributes||(t.attributes={});for(const[a,c]of Object.entries(e.effects.attributes)){const u=t.attributes[a];t.attributes[a]=c,o.appliedEffects.push({type:"attribute",attribute:a,oldValue:u,newValue:c,success:!0})}}return r&&o.appliedEffects&&o.appliedEffects.filter(c=>c.type==="market").length>0&&(console.log("EventState - åº”ç”¨å¸‚åœºæ•ˆæœåˆ°å¸‚åœºæ•°æ®"),typeof r.calculateAllPrices=="function"?r.calculateAllPrices():typeof r.updatePrices=="function"&&r.updatePrices()),ne.emit(ae.EVENT_COMPLETED,{eventId:this.activeEvent.id,optionId:e.id,nextEventId:this.nextEventId,effects:o.appliedEffects}),this.activeEvent=null,o},getActiveMarketModifiers(){return this.eventSystem?this.eventSystem.getActiveMarketModifiers():{}},clearForceLocationChange(){this.forceLocationChange=!1,this.targetLocation=null},clearNextEvent(){this.nextEventId=null}},getters:{currentEvent(e){return e.activeEvent},needsLocationChange(e){return e.forceLocationChange},targetLocationId(e){return e.targetLocation},eventStatistics(e){if(!e.eventSystem)return{total:0,byType:{}};const t=e.triggeredEvents.length,r={};return e.triggeredEvents.forEach(i=>{const s=e.eventSystem.getEventById(i.id);if(s){const o=s.type||"unknown";r[o]=(r[o]||0)+1}}),{total:t,byType:r}}}}),Ar=()=>{const e=Z(),t=G(),r=B(),i=m=>{const p={money:t.money,debt:t.debt,inventory:t.inventory,statistics:t.statistics,purchasedHouses:t.purchasedHouses},f={marketModifiers:r.marketModifiers,currentLocation:r.currentLocation?r.currentLocation.id:null,productPrices:r.productPrices,products:r.products};return e.generateRandomEvent(m,p,f)},s=m=>{const p=e.currentEvent;if(!p)return{success:!1,message:"æ²¡æœ‰æ´»è·ƒäº‹ä»¶"};let f=m;if(typeof m=="number"){if(m<0||m>=p.options.length)return{success:!1,message:"æ— æ•ˆçš„é€‰é¡¹ç´¢å¼•"};f=p.options[m]}if(!f)return console.warn("EventActions - æ— æ³•å¤„ç†ç©ºé€‰é¡¹"),{success:!1,message:"æ— æ•ˆçš„é€‰é¡¹"};try{console.log("EventActions - å¤„ç†é€‰é¡¹:",f);const y=f.effects||{},k=t,I={...r,products:r.products};console.log("EventActions - ä¼ é€’çš„marketData:",{hasProducts:!!I.products,productsCount:I.products?I.products.length:0,currentLocation:I.currentLocation,hasLocations:!!I.locations,locationsCount:I.locations?I.locations.length:0});const b={money:t.money,debt:t.debt,capacity:t.capacity,inventoryUsed:t.inventoryUsed,inventoryCount:t.inventory.length};console.log("EventActions - å¤„ç†é€‰é¡¹å‰çŠ¶æ€:",b);const S=e.handleEventOption(f,k,I),x={money:t.money,debt:t.debt,capacity:t.capacity,inventoryUsed:t.inventoryUsed,inventoryCount:t.inventory.length};console.log("EventActions - å¤„ç†é€‰é¡¹åçŠ¶æ€:",x);const T={money:x.money-b.money,debt:x.debt-b.debt,capacity:x.capacity-b.capacity,inventoryUsed:x.inventoryUsed-b.inventoryUsed,inventoryCount:x.inventoryCount-b.inventoryCount};console.log("EventActions - çŠ¶æ€å˜åŒ–:",T);const A=S||{success:!0};if(A.success!==!1){if(A.success=!0,A.appliedEffects||(A.appliedEffects=[]),S&&S.failedEffects&&!A.failedEffects&&(A.failedEffects=S.failedEffects),T.money!==0&&!A.appliedEffects.some(C=>C.type==="money")&&A.appliedEffects.push({type:"money",value:T.money,success:!0}),T.debt!==0&&!A.appliedEffects.some(C=>C.type==="debt")&&A.appliedEffects.push({type:"debt",value:T.debt,success:!0}),T.capacity!==0&&!A.appliedEffects.some(C=>C.type==="capacity")&&A.appliedEffects.push({type:"capacity",value:T.capacity,success:!0}),y.market&&!A.appliedEffects.some(C=>C.type==="market")){const C={type:"market",effect:{...y.market},success:!0};(y.market.globalPriceModifier||y.market.categoryModifiers||y.market.productModifiers||y.market.locationModifiers||y.market.locationProductModifiers)&&A.appliedEffects.push(C)}if(A.effects&&A.effects.locationChanged&&e.needsLocationChange){const C=e.targetLocationId;C&&(r.changeLocation(C),e.clearForceLocationChange(),A.appliedEffects.push({type:"info",description:`å·²å‰å¾€${o(C)}`,success:!0}))}A.appliedEffects.length===0&&A.appliedEffects.push({type:"info",description:"é€‰é¡¹å·²æ‰§è¡Œï¼Œä½†æ²¡æœ‰äº§ç”Ÿç›´æ¥æ•ˆæœ",success:!0})}return A}catch(y){return console.error("EventActions - å¤„ç†é€‰é¡¹å‡ºé”™:",y),{success:!1,message:"å¤„ç†é€‰é¡¹æ—¶å‡ºé”™: "+(y.message||"æœªçŸ¥é”™è¯¯"),appliedEffects:[{type:"error",description:"å¤„ç†é€‰é¡¹å¤±è´¥: "+(y.message||"æœªçŸ¥é”™è¯¯"),success:!1}]}}},o=m=>({commodity_market:"å¤§å®—å•†å“å¸‚åœº",second_hand_market:"äºŒæ‰‹å¸‚åœº",premium_mall:"é«˜ç«¯å•†åœº",electronics_hub:"ç”µå­äº§å“ä¸­å¿ƒ",black_market:"é»‘å¸‚"})[m]||m;return{generateRandomEvent:i,handleEventOption:s,triggerSpecificEvent:m=>{const p={money:t.money,debt:t.debt,inventory:t.inventory,statistics:t.statistics,purchasedHouses:t.purchasedHouses},f={marketModifiers:r.marketModifiers,currentLocation:r.currentLocation?r.currentLocation.id:null,productPrices:r.productPrices,products:r.products};return e.triggerSpecificEvent(m,p,f)},triggerTutorialEvent:m=>e.triggerTutorialEvent(m),getCurrentEvent:()=>e.currentEvent,hasPendingEvent:()=>e.currentEvent!==null,getEventStatistics:()=>e.eventStatistics}},K=ce("gameCore",{state:()=>({currentWeek:1,maxWeeks:52,gameStarted:!1,gamePaused:!1,gameOver:!1,victoryAchieved:!1,gameResult:null,notifications:[],initialized:!1,gameGoals:{requiredNetWorth:4e5,targetWeeks:30}}),actions:{async startNewGame(e){console.log("GameCore - å¼€å§‹æ–°æ¸¸æˆ:",e),this.currentWeek=1,this.gameStarted=!0,this.gamePaused=!1,this.gameOver=!1,this.victoryAchieved=!1,this.gameResult=null;try{const t=G(),r=B(),i=Z();await t.initializePlayer(e),!t.name&&e&&(t.name=e),r.initializeMarket().then(()=>{r.updateLocationProducts(),console.log("GameCore - å¸‚åœºå•†å“å·²æ›´æ–°")}),i.resetEvents(),i.activeEvent=null,i.activeEvents=[],localStorage.setItem("lastPlayerName",e),console.log("GameCore - æ¸¸æˆåˆå§‹åŒ–å®Œæˆ")}catch(t){throw R(t,"gameState (gameCore)",L.UNKNOWN,_.ERROR),console.error("GameCore - åˆå§‹åŒ–æ¸¸æˆæ¨¡å—æ—¶å‡ºé”™:",t),t}},advanceWeek(){if(this.currentWeek<=this.maxWeeks&&!this.gameOver){this.currentWeek++,console.log(`GameCore - è¿›å…¥ç¬¬ ${this.currentWeek} å‘¨`);const e=G(),t=B(),r=Z();console.log("GameCore - æ›´æ–°ç©å®¶çŠ¶æ€"),e.updateWeeklyPlayerState(this.currentWeek),console.log("GameCore - æ›´æ–°å¸‚åœºçŠ¶æ€"),t.updateMarketState(this.currentWeek),console.log("GameCore - å‡†å¤‡ç”Ÿæˆéšæœºäº‹ä»¶");const i={money:e.money,debt:e.debt,inventory:e.inventory,statistics:e.statistics,purchasedHouses:e.purchasedHouses,name:e.name,capacity:e.capacity,inventoryUsed:e.inventoryUsed};console.log("GameCore - å·²å‡†å¤‡ç©å®¶æ•°æ®:",{money:i.money,debt:i.debt,inventoryCount:i.inventory.length});const s={marketModifiers:t.marketModifiers,currentLocation:t.currentLocation,productPrices:t.productPrices,products:t.products,locations:t.locations};console.log("GameCore - å·²å‡†å¤‡å¸‚åœºæ•°æ®:",{currentLocationId:s.currentLocation?s.currentLocation.id:"æœªè®¾ç½®",productCount:s.products.length,locationCount:s.locations.length}),console.log("GameCore - è°ƒç”¨äº‹ä»¶ç”Ÿæˆå‡½æ•°");let o=r.generateRandomEvent(this.currentWeek,i,s);return!o&&this.currentWeek%3===0&&(console.log("GameCore - ç¬¬ä¸€æ¬¡æœªç”Ÿæˆäº‹ä»¶ï¼Œå°è¯•ç¬¬äºŒæ¬¡ç”Ÿæˆ"),o=r.generateRandomEvent(this.currentWeek,i,s)),o?(console.log("GameCore - æˆåŠŸç”Ÿæˆéšæœºäº‹ä»¶:",o.id,o.title),r.activeEvents.includes(o)||(r.activeEvents.push(o),console.log("GameCore - äº‹ä»¶å·²åŠ å…¥æ´»è·ƒé˜Ÿåˆ—, å½“å‰é˜Ÿåˆ—é•¿åº¦:",r.activeEvents.length))):console.log("GameCore - æœ¬å‘¨æœªè§¦å‘äº‹ä»¶"),this.checkGameEnd(),!0}else{if(this.maxWeeks===52&&this.currentWeek>this.maxWeeks)this.gameOver=!0;else{this.currentWeek++;const e=G(),t=B(),r=Z();e.updateWeeklyPlayerState(this.currentWeek),t.updateMarketState(this.currentWeek);const i={money:e.money,debt:e.debt,inventory:e.inventory,statistics:e.statistics,purchasedHouses:e.purchasedHouses,name:e.name,capacity:e.capacity,inventoryUsed:e.inventoryUsed},s={marketModifiers:t.marketModifiers,currentLocation:t.currentLocation,productPrices:t.productPrices,products:t.products,locations:t.locations};let o=r.generateRandomEvent(this.currentWeek,i,s);return!o&&this.currentWeek%3===0&&(o=r.generateRandomEvent(this.currentWeek,i,s)),o&&(r.activeEvents.includes(o)||r.activeEvents.push(o)),this.checkGameEnd(),!0}return!1}},hasAffordableProducts(e=!0){const t=G(),r=B(),i=e?t.money+t.bankDeposit:t.money;if(t.inventoryUsed>0)return!0;for(const s of r.locations){const o=r.getLocationAvailableProducts(s);for(const n of o){if(!r.products.find(u=>u.id===n))continue;if(r.getCurrentProductPrice(n)<=i)return!0}}return!1},checkGameEnd(){if(this.gameOver)return;if(this.currentWeek>this.maxWeeks){this.endGameWithTimeLimit();return}const t=G().netWorth;if(t>=1e6&&!this.victoryAchieved){this.achieveVictory();return}if(this.currentWeek>1&&t<0&&!this.hasAffordableProducts(!0)){this.endGame("bankruptcy");return}},endGameWithTimeLimit(){var r,i,s,o,n,a,c;const e=G(),t=e.purchasedHouses&&e.purchasedHouses.length>0;if(console.log("æ¸¸æˆæ—¶é—´é™åˆ¶è¾¾åˆ° - endGameWithTimeLimit",{victoryAchieved:this.victoryAchieved,hasHouses:t,purchasedHouses:(r=e.purchasedHouses)==null?void 0:r.length,netWorth:e.netWorth}),this.victoryAchieved||t){const u=this.calculateGameScore("victoryTimeLimit"),g=this.calculateRank(u),m=this.calculateScoreDetails("victoryTimeLimit");if(console.log("æ—¶é—´é™åˆ¶èƒœåˆ© - ç›´æ¥è®¡ç®—å¾—åˆ†",{finalScore:u,rank:g}),this.gameResult={reason:"victoryTimeLimit",week:this.maxWeeks,weeksPassed:this.maxWeeks,score:u,achievementName:null,victoryAchieved:!0,firstVictoryWeek:((i=this.gameResult)==null?void 0:i.firstVictoryWeek)||this.currentWeek,firstVictoryHouse:((s=this.gameResult)==null?void 0:s.firstVictoryHouse)||null,finalMoney:e.money,finalAssets:e.netWorth,debt:e.debt,tradeStats:{totalTrades:((o=e.statistics)==null?void 0:o.transactionCount)||0,totalProfit:((n=e.statistics)==null?void 0:n.totalProfit)||0,averageProfit:((a=e.statistics)==null?void 0:a.transactionCount)>0?(((c=e.statistics)==null?void 0:c.totalProfit)||0)/e.statistics.transactionCount:0},scoreDetails:{score:u,rank:g,details:m},endReason:"victoryTimeLimit"},this.gameOver=!0,e.purchasedHouses.length>0){this.gameResult.allPurchasedHouses=e.purchasedHouses,this.gameResult.houseCount=e.purchasedHouses.length;let p=e.purchasedHouses[0],f=e.purchasedHouses[0];e.purchasedHouses.forEach(y=>{y.purchasePrice>p.purchasePrice&&(p=y),(y.level>f.level||y.level===f.level&&y.purchasePrice>f.purchasePrice)&&(f=y)}),this.gameResult.mostExpensiveHouse=p,this.gameResult.highestLevelHouse=f}console.log("æ—¶é—´é™åˆ¶èƒœåˆ© - æ¸¸æˆç»“æœå¯¹è±¡å·²åˆ›å»º",{score:this.gameResult.score,scoreDetails:this.gameResult.scoreDetails})}else this.endGame("timeLimit")},achieveVictory(){const e=G();this.gameResult={reason:"victory",week:this.currentWeek,score:this.calculateGameScore("victory"),continuedPlay:!0,firstVictoryWeek:this.currentWeek,firstVictoryHouse:e.mostExpensiveHouse},e.addMoney(5e4),this.addNotification("reward","ä½œä¸ºè´­ä¹°è±ªå®…çš„å¥–åŠ±ï¼Œæ‚¨è·å¾—äº†é¢å¤–çš„50,000å…ƒï¼")},achieveVictoryWithHouse(e){var a,c,u,g;this.victoryAchieved=!0;const t=G();console.log("è´­æˆ¿èƒœåˆ© - å¼€å§‹è®¡ç®—ç»“æœ",{houseCount:t.purchasedHouses.length,netWorth:t.netWorth}),e&&(e.image?e.image.startsWith("./")?e.image=e.image.replace("./","/"):e.image.startsWith("/")||(e.image=`/${e.image}`):e.image="/resources/assets/images/house_1.jpeg"),t.purchasedHouses.some(m=>m.houseId===e.id||m.id===e.id)||console.warn("æˆ¿å±‹è´­ä¹°è®°å½•ä¸ä¸€è‡´ï¼Œè¿™ç§æƒ…å†µä¸åº”è¯¥å‡ºç°");const i=this.calculateGameScore("houseVictory"),s=this.calculateRank(i),o=this.calculateScoreDetails("houseVictory");console.log("è´­æˆ¿èƒœåˆ© - è®¡ç®—å¾—åˆ†ç»“æœ",{finalScore:i,scoreRank:s,details:o});const n={...e};(!n.image||n.image.includes("NaN"))&&(console.warn("æˆ¿å±‹å›¾ç‰‡è·¯å¾„æ— æ•ˆï¼Œä½¿ç”¨é»˜è®¤å€¼"),n.image="/resources/assets/images/house_1.jpeg"),this.gameResult={reason:"houseVictory",week:this.currentWeek,weeksPassed:this.currentWeek,score:i,victoryAchieved:!0,firstVictoryWeek:this.currentWeek,firstVictoryHouse:n,canContinue:!0,finalMoney:t.money,finalAssets:t.netWorth,debt:t.debt,purchasedHouse:n,tradeStats:{totalTrades:((a=t.statistics)==null?void 0:a.transactionCount)||0,totalProfit:((c=t.statistics)==null?void 0:c.totalProfit)||0,averageProfit:((u=t.statistics)==null?void 0:u.transactionCount)>0?(((g=t.statistics)==null?void 0:g.totalProfit)||0)/t.statistics.transactionCount:0},scoreDetails:{score:i,rank:s,details:o},endReason:"houseVictory"},this.gameOver=!0,console.log("è´­æˆ¿èƒœåˆ© - æ¸¸æˆç»“æœå¯¹è±¡åˆ›å»ºå®Œæˆ",{score:this.gameResult.score,scoreDetails:this.gameResult.scoreDetails})},continueGame(){this.gameOver=!1,this.victoryAchieved=!0},endGame(e,t=null){var n,a,c,u,g,m,p,f;this.gameOver=!0,this.victoryAchieved&&e!=="victory"&&e!=="victoryTimeLimit"&&(e="victoryOther");const r=G();console.log("æ¸¸æˆç»“æŸ - endGame",{reason:e,week:this.currentWeek,netWorth:r.netWorth,houseCount:((n=r.purchasedHouses)==null?void 0:n.length)||0});const i=this.calculateGameScore(e),s=this.calculateRank(i),o=this.calculateScoreDetails(e);console.log("endGameå¾—åˆ†è®¡ç®—å®Œæˆ",{score:i,rank:s,details:o}),this.gameResult={reason:e,week:e==="timeLimit"?this.maxWeeks:this.currentWeek,weeksPassed:e==="timeLimit"?this.maxWeeks:this.currentWeek,score:i,achievementName:t,victoryAchieved:this.victoryAchieved,firstVictoryWeek:((a=this.gameResult)==null?void 0:a.firstVictoryWeek)||null,firstVictoryHouse:((c=this.gameResult)==null?void 0:c.firstVictoryHouse)||null,finalMoney:r.money,finalAssets:r.netWorth,debt:r.debt,tradeStats:{totalTrades:((u=r.statistics)==null?void 0:u.transactionCount)||0,totalProfit:((g=r.statistics)==null?void 0:g.totalProfit)||0,averageProfit:((m=r.statistics)==null?void 0:m.transactionCount)>0?(((p=r.statistics)==null?void 0:p.totalProfit)||0)/r.statistics.transactionCount:0},scoreDetails:{score:i,rank:s,details:o},endReason:e,data:{debt:r.debt,firstVictoryWeek:((f=this.gameResult)==null?void 0:f.firstVictoryWeek)||this.currentWeek}},console.log("æ¸¸æˆç»“æœå¯¹è±¡å·²åˆ›å»º",{score:this.gameResult.score,scoreInDetails:this.gameResult.scoreDetails.score})},calculateGameScore(e){var r,i;const t=G();try{console.log("è®¡ç®—æ¸¸æˆå¾—åˆ† - åŸå§‹æ•°æ®",{netWorth:t.netWorth,money:t.money,debt:t.debt,week:this.currentWeek,endReason:e,purchasedHouses:((r=t.purchasedHouses)==null?void 0:r.length)||0});let s=t.netWorth;(isNaN(s)||s===void 0)&&(console.warn("è®¡ç®—æ¸¸æˆå¾—åˆ† - å‡€èµ„äº§æ— æ•ˆï¼Œä½¿ç”¨å¤‡ç”¨è®¡ç®—"),s=(t.money||0)-(t.debt||0)),s=Math.max(1e3,s);const o=s/1e3;let n=1;switch(e){case"victory":case"houseVictory":n=1.5;break;case"victoryTimeLimit":n=2;break;case"bankruptcy":n=.5;break;case"achievement":n=1.2;break;default:n=1;break}let a=1;if(e.includes("victory")){const p=Math.max(1,this.currentWeek);a=Math.max(.5,1+10/p)}let u=1;const g=((i=t.purchasedHouses)==null?void 0:i.length)||0;g>0&&(u=1+g*.2);let m=o*n*a*u;return m=Math.max(1,Math.floor(m)),console.log("è®¡ç®—æ¸¸æˆå¾—åˆ† - æœ€ç»ˆç»“æœ",{baseScore:o,multiplier:n,speedMultiplier:a,houseBonus:u,totalScore:m}),m}catch(s){return console.error("è®¡ç®—æ¸¸æˆå¾—åˆ†æ—¶å‘ç”Ÿé”™è¯¯:",s),Math.max(1,Math.floor(t.netWorth/1e3))}},calculateRank(e){return e>=1e6?"S":e>=5e5?"A":e>=2e5?"B":e>=1e5?"C":"D"},calculateScoreDetails(e){var t,r,i;try{const s=G();console.log("è®¡ç®—å¾—åˆ†æ˜ç»† - å¼€å§‹",{endReason:e,playerNetWorth:s.netWorth});let o=0;try{o=Math.max(0,Math.floor(s.netWorth/800)),console.log("èµ„äº§å¾—åˆ†è®¡ç®—",{netWorth:s.netWorth,assetsScore:o})}catch(m){console.error("èµ„äº§å¾—åˆ†è®¡ç®—é”™è¯¯:",m),o=100}let n=0;try{if(e.includes("victory")){const m=Math.max(1,this.currentWeek);n=Math.round(5e5/m),console.log("æ—¶é—´æ•ˆç‡å¾—åˆ†è®¡ç®—",{week:m,timeScore:n})}}catch(m){console.error("æ—¶é—´æ•ˆç‡å¾—åˆ†è®¡ç®—é”™è¯¯:",m),n=50}let a=0;try{if(s.purchasedHouses&&s.purchasedHouses.length>0){let m=0;s.purchasedHouses.forEach(p=>{const f=p.purchasePrice||p.price||0;m+=f}),a=Math.floor(m/5e3),s.purchasedHouses.length>1&&(a*=1+(s.purchasedHouses.length-1)*.2),console.log("æˆ¿äº§å¾—åˆ†è®¡ç®—",{houseCount:s.purchasedHouses.length,totalHouseValue:m,houseScore:a})}}catch(m){console.error("æˆ¿äº§å¾—åˆ†è®¡ç®—é”™è¯¯:",m),a=100}let c=0;try{const m=((t=s.statistics)==null?void 0:t.totalProfit)||0,p=((r=s.statistics)==null?void 0:r.transactionCount)||0;p>0&&(c=Math.floor(m/1e3),p>10&&(c*=1+(p-10)*.02)),console.log("äº¤æ˜“å¾—åˆ†è®¡ç®—",{tradeCount:p,totalProfit:m,tradeScore:c})}catch(m){console.error("äº¤æ˜“å¾—åˆ†è®¡ç®—é”™è¯¯:",m),c=50}let u=0;try{const m=((i=s.statistics)==null?void 0:i.totalInterestEarned)||0;m>0?u=Math.floor(m/500):u=Math.floor(s.bankDeposit/1e4),console.log("é“¶è¡Œå¾—åˆ†è®¡ç®—",{totalInterest:m,bankDeposit:s.bankDeposit,bankScore:u})}catch(m){console.error("é“¶è¡Œå¾—åˆ†è®¡ç®—é”™è¯¯:",m),u=10}const g=o+n+a+c+u;return console.log("å¾—åˆ†æ˜ç»†æ€»ç»“",{assetsScore:o,timeScore:n,houseScore:a,tradeScore:c,bankScore:u,totalScore:g}),{assetsScore:o,timeScore:n,houseScore:a,tradeScore:c,bankScore:u,totalScore:g}}catch(s){return console.error("è®¡ç®—å¾—åˆ†æ˜ç»†æ—¶å‡ºé”™:",s),{assetsScore:100,timeScore:50,houseScore:100,tradeScore:50,bankScore:10,totalScore:310}}},addNotification(e,t){this.notifications.push({id:Date.now(),type:e,message:t,timestamp:new Date().toISOString()}),this.notifications.length>10&&this.notifications.shift()},pauseGame(){this.gameStarted&&!this.gameOver&&(this.gamePaused=!0)},resumeGame(){this.gamePaused=!1},manualEndGame(){const e=G();let t="playerChoice";e.purchasedHouses&&e.purchasedHouses.length>0&&(t="victory",this.victoryAchieved||(this.victoryAchieved=!0,this.gameResult={firstVictoryWeek:this.currentWeek,firstVictoryHouse:e.purchasedHouses[e.purchasedHouses.length-1]})),this.endGame(t)},triggerSpecificEvent(e){console.log("GameCore - å°è¯•è§¦å‘ç‰¹å®šäº‹ä»¶:",e);try{const t=Z(),r=G(),i=B(),s={money:r.money,debt:r.debt,inventory:r.inventory,statistics:r.statistics,purchasedHouses:r.purchasedHouses,name:r.name,capacity:r.capacity,inventoryUsed:r.inventoryUsed},o={marketModifiers:i.marketModifiers,currentLocation:i.currentLocation,productPrices:i.productPrices,products:i.products,locations:i.locations},n=t.triggerSpecificEvent(e,s,o);return n?(console.log("GameCore - æˆåŠŸè§¦å‘ç‰¹å®šäº‹ä»¶:",n.id,n.title),this.activeEvents.includes(n)||(this.activeEvents.push(n),console.log("GameCore - äº‹ä»¶å·²æ·»åŠ åˆ°æ´»è·ƒé˜Ÿåˆ—, å½“å‰é˜Ÿåˆ—é•¿åº¦:",this.activeEvents.length)),n):(console.warn("GameCore - è§¦å‘ç‰¹å®šäº‹ä»¶å¤±è´¥:",e),null)}catch(t){return R(t,"gameState.triggerSpecificEvent",L.GAME_LOGIC,_.ERROR),console.error("GameCore - è§¦å‘ç‰¹å®šäº‹ä»¶æ—¶å‡ºé”™:",t),null}},initializeGameCore(){return new Promise(e=>{console.log("GameCore - åˆå§‹åŒ–æ¸¸æˆæ ¸å¿ƒ"),setTimeout(()=>{this.initialized=!0,console.log("GameCore - æ¸¸æˆæ ¸å¿ƒåˆå§‹åŒ–å®Œæˆ"),e()},300)})},updateGameState(){console.log("GameCore - æ›´æ–°æ¸¸æˆçŠ¶æ€"),this.gameStarted&&!this.gameOver&&this.checkGameEnd(),this.notifications.length>10&&(this.notifications=this.notifications.slice(-10))}},getters:{gameProgress(){if(this.maxWeeks>52)return Math.min(5,this.currentWeek/1e3*100);const e=(this.currentWeek-1)/this.maxWeeks*100;return Math.max(0,Math.min(100,e))},isGameActive(){return this.gameStarted&&!this.gameOver&&!this.gamePaused},remainingWeeks(){if(this.maxWeeks>52)return"âˆ";const e=this.maxWeeks-this.currentWeek+1;return Math.max(0,e)},isEndlessMode(){return this.maxWeeks>52}}}),Rr=Object.freeze(Object.defineProperty({__proto__:null,useGameCoreStore:K},Symbol.toStringTag,{value:"Module"}));function Fe(e){const t=[];if(!e||typeof e!="object")return{isValid:!1,issues:["å­˜æ¡£æ•°æ®æ— æ•ˆæˆ–å·²æŸå"]};e.version||t.push("ç¼ºå°‘ç‰ˆæœ¬ä¿¡æ¯");const r=["gameCore","player","market","event"];for(const i of r)e[i]||t.push(`ç¼ºå°‘${i}éƒ¨åˆ†`);if(e.gameCore&&(typeof e.gameCore.currentWeek!="number"&&t.push("æ¸¸æˆå‘¨æ•°æ— æ•ˆ"),typeof e.gameCore.maxWeeks!="number"&&t.push("æœ€å¤§å‘¨æ•°æ— æ•ˆ"),e.gameCore.currentWeek>e.gameCore.maxWeeks&&t.push("æ¸¸æˆå‘¨æ•°è¶…è¿‡æœ€å¤§å‘¨æ•°")),e.player)if(typeof e.player.name!="string"&&t.push("ç©å®¶åç§°æ— æ•ˆ"),typeof e.player.money!="number"&&t.push("ç©å®¶é‡‘é’±æ— æ•ˆ"),e.player.money<0&&t.push("ç©å®¶é‡‘é’±ä¸ºè´Ÿæ•°"),Array.isArray(e.player.inventory)||t.push("åº“å­˜æ•°æ®æ— æ•ˆ"),Array.isArray(e.player.purchasedHouses)||t.push("æˆ¿äº§æ•°æ®æ— æ•ˆ"),!e.player.statistics||typeof e.player.statistics!="object")t.push("ç©å®¶ç»Ÿè®¡æ•°æ®æ— æ•ˆ");else{const i=["weekCount","transactionCount","totalProfit","maxMoney"];for(const s of i)typeof e.player.statistics[s]!="number"&&t.push(`ç»Ÿè®¡æ•°æ® ${s} æ— æ•ˆæˆ–ç¼ºå¤±`)}return e.market&&(Array.isArray(e.market.locations)||t.push("åœ°ç‚¹æ•°æ®æ— æ•ˆ"),(!e.market.productPrices||typeof e.market.productPrices!="object")&&t.push("ä»·æ ¼æ•°æ®æ— æ•ˆ"),Array.isArray(e.market.products)&&e.market.products.length!==new Set(e.market.products).size&&t.push("äº§å“æ•°æ®åŒ…å«é‡å¤é¡¹")),e.event&&(e.event.activeEvent&&typeof e.event.activeEvent!="object"&&t.push("æ´»åŠ¨äº‹ä»¶æ•°æ®æ— æ•ˆ"),Array.isArray(e.event.triggeredEvents)||t.push("è§¦å‘äº‹ä»¶è®°å½•æ— æ•ˆ")),{isValid:t.length===0,issues:t}}function tt(e,t=null){const r=e||{};let i=[];t||(t=fr(),i.push("ä½¿ç”¨é»˜è®¤æ¨¡æ¿æ•°æ®")),r.version=r.version||"0.1.1",r.timestamp=r.timestamp||new Date().toISOString(),i.push(`è®¾ç½®ç‰ˆæœ¬ä¸º: ${r.version}`),r.gameCore=r.gameCore||{},r.player=r.player||{},r.market=r.market||{},r.event=r.event||{},r.gameCore.currentWeek=J(r.gameCore.currentWeek,1),r.gameCore.maxWeeks=J(r.gameCore.maxWeeks,52),r.gameCore.gameStarted=Ve(r.gameCore.gameStarted,!0),r.gameCore.gamePaused=Ve(r.gameCore.gamePaused,!1),r.gameCore.gameOver=Ve(r.gameCore.gameOver,!1),r.gameCore.notifications=Array.isArray(r.gameCore.notifications)?r.gameCore.notifications:[],r.gameCore.gameGoals=r.gameCore.gameGoals||{requiredNetWorth:4e5,targetWeeks:30,debtRatio:.4},r.gameCore.currentWeek>r.gameCore.maxWeeks&&(r.gameCore.currentWeek=r.gameCore.maxWeeks,i.push("ä¿®å¤: è°ƒæ•´å½“å‰å‘¨æ•°ä¸è¶…è¿‡æœ€å¤§å‘¨æ•°")),r.player.name=r.player.name||"ç©å®¶",r.player.money=J(r.player.money,5e3),r.player.money<0&&(r.player.money=0,i.push("ä¿®å¤: é‡ç½®è´Ÿæ•°é‡‘é’±ä¸º0")),r.player.debt=J(r.player.debt,2e3),r.player.capacity=J(r.player.capacity,100),r.player.inventoryUsed=J(r.player.inventoryUsed,0),r.player.inventory=Array.isArray(r.player.inventory)?r.player.inventory:[],r.player.purchasedHouses=Array.isArray(r.player.purchasedHouses)?r.player.purchasedHouses:[];const s=r.player.inventory.reduce((o,n)=>o+(n.quantity||0),0);if(r.player.inventoryUsed!==s&&(r.player.inventoryUsed=s,i.push("ä¿®å¤: è°ƒæ•´åº“å­˜ä½¿ç”¨é‡ä»¥åŒ¹é…å®é™…åº“å­˜")),r.player.statistics=r.player.statistics||{},r.player.statistics.weekCount=J(r.player.statistics.weekCount,r.gameCore.currentWeek),r.player.statistics.transactionCount=J(r.player.statistics.transactionCount,0),r.player.statistics.totalProfit=J(r.player.statistics.totalProfit,0),r.player.statistics.maxMoney=J(r.player.statistics.maxMoney,Math.max(r.player.money,5e3)),r.player.purchasedHouses.length>0&&(!r.player.statistics.housePurchases||r.player.statistics.housePurchases.length===0)?(r.player.statistics.housePurchases=r.player.purchasedHouses.map(o=>({houseId:o.houseId,name:o.name||`${o.level}çº§æˆ¿äº§`,level:o.level||1,price:o.purchasePrice,week:o.purchaseWeek||r.gameCore.currentWeek})),i.push("ä¿®å¤: é‡å»ºæˆ¿å±‹è´­ä¹°è®°å½•")):r.player.statistics.housePurchases||(r.player.statistics.housePurchases=[]),r.player.purchasedHouses.length>0&&r.player.statistics.firstHousePurchaseWeek===null){const o=[...r.player.purchasedHouses].sort((n,a)=>(n.purchaseWeek||1/0)-(a.purchaseWeek||1/0))[0];r.player.statistics.firstHousePurchaseWeek=o.purchaseWeek||Math.max(1,r.gameCore.currentWeek-1),i.push("ä¿®å¤: è®¾ç½®é¦–æ¬¡è´­æˆ¿å‘¨æ•°")}if((!Array.isArray(r.market.locations)||r.market.locations.length===0)&&(r.market.locations=t.market&&Array.isArray(t.market.locations)?[...t.market.locations]:[],r.market.locations.length>0&&i.push("ä¿®å¤: ä»æ¨¡æ¿æ¢å¤åœ°ç‚¹æ•°æ®")),r.market.productPrices=r.market.productPrices||{},t&&t.market&&t.market.productPrices){let o=0;for(const n in t.market.productPrices)r.market.productPrices[n]||(r.market.productPrices[n]=t.market.productPrices[n],o++);o>0&&i.push(`ä¿®å¤: ä»æ¨¡æ¿æ¢å¤${o}ä¸ªäº§å“ä»·æ ¼æ•°æ®`)}return Array.isArray(r.event.triggeredEvents)||(r.event.triggeredEvents=[],i.push("ä¿®å¤: åˆå§‹åŒ–è§¦å‘äº‹ä»¶è®°å½•")),console.log("å­˜æ¡£ä¿®å¤æ—¥å¿—:",i),{data:r,repairLog:i}}function fr(){return{version:"0.1.0",gameCore:{currentWeek:1,maxWeeks:52,gameStarted:!0,gamePaused:!1,gameOver:!1},player:{name:"ç©å®¶",money:5e3,debt:2e3,capacity:100,inventory:[],purchasedHouses:[]},market:{locations:[{id:"location1",name:"å¸‚ä¸­å¿ƒ",specialProducts:["product1","product2"]},{id:"location2",name:"éƒŠåŒº",specialProducts:["product3","product4"]},{id:"location3",name:"å•†ä¸šåŒº",specialProducts:["product5","product6"]},{id:"location4",name:"ä½å®…åŒº",specialProducts:["product7","product8"]},{id:"location5",name:"å·¥ä¸šåŒº",specialProducts:["product9","product10"]}],productPrices:{}},event:{activeEvent:null,triggeredEvents:[]}}}function J(e,t){const r=Number(e);return isNaN(r)?t:r}function Ve(e,t){return typeof e=="boolean"?e:t}function gr(e,t="0.1.1"){if(!e)return null;if(e.version||(e.version="0.1.0"),e.version===t)return e;let r={...e};return e.version==="0.1.0"&&t==="0.1.1"&&(r.gameState||(r.gameState={})),r.version=t,r}class dt{async getData(t){throw new Error("StorageService.getData must be implemented by subclass")}async setData(t,r){throw new Error("StorageService.setData must be implemented by subclass")}async removeData(t){throw new Error("StorageService.removeData must be implemented by subclass")}async clearAll(){throw new Error("StorageService.clearAll must be implemented by subclass")}}class hr extends dt{constructor(t="game_"){super(),this.prefix=t}getFullKey(t){return`${this.prefix}${t}`}async getData(t){try{const r=this.getFullKey(t),i=localStorage.getItem(r);return i?JSON.parse(i):null}catch(r){throw R(r,"storageService (persistence)",L.STORAGE,_.ERROR),He(`Failed to get data for key ${t}`,{originalError:r.message})}}_safeStringify(t){try{return JSON.stringify(t)}catch{if(console.warn("æ ‡å‡†åºåˆ—åŒ–å¤±è´¥ï¼Œå°è¯•æ‰‹åŠ¨åºåˆ—åŒ–"),t==null)return JSON.stringify(null);if(typeof t!="object")return JSON.stringify(t);if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)try{const n=t[o];typeof n=="object"&&n!==null?s.push(JSON.parse(this._safeStringify(n))):s.push(n)}catch{s.push(null)}return JSON.stringify(s)}const i={};for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s))try{const o=t[s];typeof o=="object"&&o!==null?i[s]=JSON.parse(this._safeStringify(o)):typeof o=="function"?i[s]="[å‡½æ•°]":i[s]=o}catch{console.warn(`æ— æ³•åºåˆ—åŒ–å±æ€§ ${s}`),i[s]=null}return JSON.stringify(i)}}async setData(t,r){try{console.log(`LocalStorage: ä¿å­˜æ•°æ®åˆ° ${t}`);const i=this.getFullKey(t);let s;try{s=this._safeStringify(r)}catch(o){console.warn("åºåˆ—åŒ–å¤±è´¥ï¼Œä½¿ç”¨åŸºæœ¬æ•°æ®",o),s=JSON.stringify({_simplified:!0,timestamp:new Date().toISOString(),key:t})}return localStorage.setItem(i,s),!0}catch(i){return R(i,"storageService (persistence)",L.STORAGE,_.ERROR),console.error(`ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥: ${t}`,i),!1}}async removeData(t){try{const r=this.getFullKey(t);return localStorage.removeItem(r),!0}catch(r){throw R(r,"storageService (persistence)",L.STORAGE,_.ERROR),He(`Failed to remove data for key ${t}`,{originalError:r.message})}}async clearAll(){try{return Object.keys(localStorage).forEach(t=>{t.startsWith(this.prefix)&&localStorage.removeItem(t)}),!0}catch(t){throw R(t,"storageService (persistence)",L.STORAGE,_.ERROR),He("Failed to clear all data",{originalError:t.message})}}}class yr extends dt{constructor(t="game_"){super(),this.prefix=t,this.isInitialized=!1,this.fallbackStorage=new hr,this.initializeElectronAPI()}async initializeElectronAPI(){try{window.electronAPI&&window.electronAPI.getConfig?(await window.electronAPI.getConfig(),this.isInitialized=!0,console.log("ElectronStorageServiceåˆå§‹åŒ–æˆåŠŸ")):console.warn("Electron APIä¸å¯ç”¨ï¼Œå°†ä½¿ç”¨LocalStorageä½œä¸ºå¤‡ç”¨")}catch(t){R(t,"storageService (persistence)",L.STORAGE,_.ERROR),console.error("åˆå§‹åŒ–ElectronStorageServiceå¤±è´¥:",t)}return this.isInitialized}async getData(t){try{if(!this.isInitialized)return await this.fallbackStorage.getData(t);if(!window.electronAPI||!window.electronAPI.getConfig)throw new Error("Electron APIä¸å¯ç”¨");const r=this.prefix+t,i=await window.electronAPI.getConfig();return i&&i[r]!==void 0?i[r]:null}catch(r){return R(r,"storageService (persistence)",L.UNKNOWN,_.ERROR),console.error(`è·å–æ•°æ®å¤±è´¥ [${t}]:`,r),await this.fallbackStorage.getData(t)}}_safeSerialize(t){try{return console.log("å°è¯•å®‰å…¨åºåˆ—åŒ–æ•°æ®"),JSON.parse(JSON.stringify(t))}catch(r){if(console.warn("æ ‡å‡†JSONåºåˆ—åŒ–å¤±è´¥ï¼Œå°è¯•æ‰‹åŠ¨åºåˆ—åŒ–",r),t==null||typeof t!="object")return t;if(Array.isArray(t))return t.map(s=>this._safeSerialize(s));const i={};for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s))try{i[s]=this._safeSerialize(t[s])}catch(o){console.warn(`æ— æ³•åºåˆ—åŒ–å±æ€§ ${s}:`,o),typeof t[s]=="function"?i[s]="[å‡½æ•°]":typeof t[s]=="object"?i[s]="[å¤æ‚å¯¹è±¡]":i[s]=null}return i}}async setData(t,r){try{console.log(`æ­£åœ¨ä¿å­˜æ•°æ® [${t}]...`);const i=await this.fallbackStorage.setData(t,r);if(console.log(`å¤‡ç”¨å­˜å‚¨ä¿å­˜${i?"æˆåŠŸ":"å¤±è´¥"}`),!this.isInitialized)return console.log("ElectronAPIæœªåˆå§‹åŒ–ï¼Œä»…ä½¿ç”¨å¤‡ç”¨å­˜å‚¨"),i;if(!window.electronAPI||!window.electronAPI.setConfig)throw new Error("Electron APIä¸å¯ç”¨");const s=this._safeSerialize(r);console.log("æ•°æ®å·²å®‰å…¨åºåˆ—åŒ–");const n={[this.prefix+t]:s};return await window.electronAPI.setConfig(n),console.log(`æ•°æ®æˆåŠŸä¿å­˜åˆ° [${t}]`),!0}catch(i){if(R(i,"storageService (persistence)",L.UNKNOWN,_.ERROR),console.error(`è®¾ç½®æ•°æ®å¤±è´¥ [${t}]:`,i),t.includes("Save_")&&window.electronAPI&&window.electronAPI.saveGame)try{console.log("å°è¯•ä½¿ç”¨saveGame APIä¿å­˜...");const s=t.replace(this.prefix,"").replace("Save_",""),o=await window.electronAPI.saveGame({name:s,gameState:r});if(o&&o.success)return console.log("ä½¿ç”¨saveGame APIä¿å­˜æˆåŠŸ"),!0}catch(s){console.error("saveGame APIä¿å­˜å¤±è´¥",s)}return await this.fallbackStorage.setData(t,r)}}async removeData(t){try{if(!this.isInitialized)return await this.fallbackStorage.removeData(t);if(!window.electronAPI||!window.electronAPI.setConfig)throw new Error("Electron APIä¸å¯ç”¨");const i={[this.prefix+t]:void 0};return await window.electronAPI.setConfig(i),!0}catch(r){return R(r,"storageService (persistence)",L.UNKNOWN,_.ERROR),console.error(`åˆ é™¤æ•°æ®å¤±è´¥ [${t}]:`,r),await this.fallbackStorage.removeData(t)}}async clearAll(){try{if(!this.isInitialized)return await this.fallbackStorage.clearAll();if(!window.electronAPI||!window.electronAPI.clearConfig)throw new Error("Electron APIä¸å¯ç”¨");const t=await window.electronAPI.getConfig(),r=Object.keys(t).filter(s=>s.startsWith(this.prefix));if(r.length===0)return!0;const i={};return r.forEach(s=>{i[s]=void 0}),await window.electronAPI.setConfig(i),!0}catch(t){return R(t,"storageService (persistence)",L.UNKNOWN,_.ERROR),console.error("æ¸…é™¤æ‰€æœ‰æ•°æ®å¤±è´¥:",t),await this.fallbackStorage.clearAll()}}}const X=new yr,Ee="saveList",be="houseJourneySave_",Ce=3,vr=5,he="0.1.1",Er=ce("save",{state:()=>({saveList:[],isLoading:!1,lastAutoSaveWeek:0,autoSaveEnabled:!0,saveTemplate:null,lastValidatedSave:null}),actions:{async init(){try{await this.loadSaveList(),this.createSaveTemplate(),this.autoSaveEnabled&&setInterval(()=>{const e=K();e.gameStarted&&!e.gameOver&&!e.gamePaused&&this.checkAutoSave(e.currentWeek)},6e4)}catch(e){R(e,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("åˆå§‹åŒ–å­˜æ¡£ç³»ç»Ÿå¤±è´¥",e)}},createSaveTemplate(){K(),G();const e=B();Z(),this.saveTemplate={version:he,timestamp:new Date().toISOString(),gameCore:{currentWeek:1,maxWeeks:52,gameStarted:!0,gamePaused:!1,gameOver:!1,gameResult:null,notifications:[],gameGoals:{requiredNetWorth:4e5,targetWeeks:30,debtRatio:.4}},player:{name:"ç©å®¶",money:5e3,debt:2e3,capacity:100,inventoryUsed:0,inventory:[],purchasedHouses:[],statistics:{weekCount:1,transactionCount:0,totalProfit:0,maxMoney:5e3,visitedLocations:[]}},market:{locations:e.locations||[],currentLocation:null,productPrices:{},products:[],houses:[],marketModifiers:{}},event:{activeEvent:null,forceLocationChange:!1,targetLocation:null,nextEventId:null,triggeredEvents:[]}}},async loadSaveList(){try{console.log("å°è¯•åŠ è½½å­˜æ¡£åˆ—è¡¨...");const e=await X.getData(Ee);if(!e||!Array.isArray(e)||e.length===0){console.log("å­˜æ¡£åˆ—è¡¨ä¸ºç©ºæˆ–æ— æ•ˆï¼Œå°è¯•ä»æ–‡ä»¶ç³»ç»Ÿè·å–...");try{if(window.electronAPI&&window.electronAPI.listSaves){const t=await window.electronAPI.listSaves();if(t&&t.success&&Array.isArray(t.saves)){console.log("ä»Electron APIè·å–åˆ°",t.saves.length,"ä¸ªå­˜æ¡£");const r=t.saves.map(i=>({id:i.name,name:i.name,isAuto:i.name.startsWith("autosave_")||i.name.includes("è‡ªåŠ¨å­˜æ¡£"),timestamp:i.lastModified?new Date(i.lastModified).getTime():Date.now(),lastModified:i.lastModified}));return this.saveList=r,await X.setData(Ee,r),r}}}catch(t){console.error("ä»Electron APIè·å–å­˜æ¡£åˆ—è¡¨å¤±è´¥",t)}this.saveList=[]}else console.log("æˆåŠŸä»å­˜å‚¨ä¸­åŠ è½½å­˜æ¡£åˆ—è¡¨ï¼Œæ•°é‡:",e.length),this.saveList=e}catch(e){R(e,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("åŠ è½½å­˜æ¡£åˆ—è¡¨å¤±è´¥",e),this.saveList=[]}return this.saveList},async validateSave(e){try{const t=e||this.lastValidatedSave;if(!t)return{success:!1,message:"æœªæŒ‡å®šå­˜æ¡£ID"};const r=await X.getData(`${be}${t}`);if(!r)return{success:!1,message:"å­˜æ¡£ä¸å­˜åœ¨æˆ–å·²æŸå"};const i=Fe(r);return{success:i.isValid,issues:i.issues,saveData:r,canRepair:i.issues.length>0}}catch(t){return R(t,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("éªŒè¯å­˜æ¡£å¤±è´¥",t),{success:!1,message:`éªŒè¯å¤±è´¥: ${t.message}`,error:t}}},async saveGame(e,t=!1){return De(async()=>{const r=K(),i=G(),s=B(),o=Z(),n=ke();let a={version:he,timestamp:new Date().toISOString()};try{console.log("å‡†å¤‡å­˜æ¡£æ•°æ®...");const p=r.gameResult?JSON.parse(JSON.stringify({reason:r.gameResult.reason,week:r.gameResult.week,score:r.gameResult.score,endReason:r.gameResult.endReason,victoryAchieved:r.gameResult.victoryAchieved,firstVictoryWeek:r.gameResult.firstVictoryWeek})):null,f=r.notifications?r.notifications.map(b=>({id:b.id,type:b.type,message:b.message,timestamp:b.timestamp})):[],y=i.inventory?i.inventory.map(b=>({productId:b.productId,name:b.name,quantity:b.quantity,purchasePrice:b.purchasePrice,purchaseWeek:b.purchaseWeek})):[],k=i.purchasedHouses?i.purchasedHouses.map(b=>({houseId:b.houseId,name:b.name,level:b.level,purchasePrice:b.purchasePrice,purchaseWeek:b.purchaseWeek,location:typeof b.location=="string"?b.location:null})):[];let I=null;o.activeEvent&&(I={id:o.activeEvent.id,title:o.activeEvent.title,type:o.activeEvent.type}),a={version:he,timestamp:new Date().toISOString(),gameCore:{currentWeek:r.currentWeek,maxWeeks:r.maxWeeks,gameStarted:r.gameStarted,gamePaused:r.gamePaused,gameOver:r.gameOver,gameResult:p,notifications:f,gameGoals:JSON.parse(JSON.stringify(r.gameGoals||{}))},player:{name:i.name,money:i.money,debt:i.debt,capacity:i.capacity,inventoryUsed:i.inventoryUsed,inventory:y,purchasedHouses:k,statistics:JSON.parse(JSON.stringify(i.statistics||{}))},market:{locations:JSON.parse(JSON.stringify(s.locations||[])),currentLocation:s.currentLocation?s.currentLocation.id:null,productPrices:JSON.parse(JSON.stringify(s.productPrices||{})),products:s.products?s.products.map(b=>typeof b=="object"?b.id:b):[],houses:s.houses?s.houses.map(b=>typeof b=="object"?b.id:b):[],marketModifiers:JSON.parse(JSON.stringify(s.marketModifiers||{}))},event:{activeEvent:I,forceLocationChange:o.forceLocationChange,targetLocation:o.targetLocation,nextEventId:o.nextEventId,triggeredEvents:JSON.parse(JSON.stringify(o.triggeredEvents||[]))}},console.log("å­˜æ¡£æ•°æ®å‡†å¤‡å®Œæˆ")}catch(p){R(p,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("å‡†å¤‡å­˜æ¡£æ•°æ®æ—¶å‡ºé”™:",p),a={version:he,timestamp:new Date().toISOString(),gameCore:{currentWeek:r.currentWeek,maxWeeks:r.maxWeeks,gameStarted:!0,gamePaused:!1,gameOver:r.gameOver},player:{name:i.name,money:i.money,debt:i.debt,capacity:100,inventoryUsed:0,inventory:[],purchasedHouses:[]},market:{currentLocation:null,productPrices:{},products:[],houses:[],marketModifiers:{}},event:{triggeredEvents:[]}},t||n.showToast({type:"warning",message:"å­˜æ¡£æ•°æ®å¤„ç†å‡ºé”™ï¼Œä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬",duration:3e3})}const c=Fe(a);if(!c.isValid){console.warn("ç”Ÿæˆçš„å­˜æ¡£æ•°æ®æœ‰é—®é¢˜ï¼Œå°è¯•ä¿®å¤...",c.issues),t||n.showToast({type:"warning",message:"å­˜æ¡£æ•°æ®æœ‰é—®é¢˜ï¼Œæ­£åœ¨ä¿®å¤...",duration:3e3});const p=tt(a,this.saveTemplate);a=p.data,!t&&p.repairLog.length>0&&(console.info("å­˜æ¡£ä¿®å¤å®Œæˆ",p.repairLog),n.showToast({type:"info",message:`å­˜æ¡£å·²ä¿®å¤ (${p.repairLog.length}é¡¹é—®é¢˜)`,duration:3e3}))}let u,g=!0;if(t)u=`auto_${Date.now()}`,e=`è‡ªåŠ¨å­˜æ¡£ - ç¬¬${r.currentWeek}å‘¨ - ${new Date().toLocaleString()}`;else{const p=this.saveList.find(f=>f.name===e);p?(u=p.id,g=!1):u=`save_${Date.now()}`}const m={id:u,name:e,isAuto:t,timestamp:Date.now(),week:r.currentWeek,playerMoney:i.money,playerDebt:i.debt,location:s.currentLocation?s.currentLocation.name:"æœªçŸ¥ä½ç½®",version:he};try{if(console.log("æ­£åœ¨ä¿å­˜æ¸¸æˆæ•°æ®åˆ°å­˜å‚¨..."),await X.setData(`${be}${u}`,a),console.log("æ¸¸æˆæ•°æ®å·²ä¿å­˜åˆ°å­˜å‚¨"),window.electronAPI&&window.electronAPI.saveGame){console.log("å°è¯•ä½¿ç”¨Electron APIä¿å­˜æ¸¸æˆ...");const p=await window.electronAPI.saveGame({name:e,gameState:a});p&&p.success?console.log("æ¸¸æˆå·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿ:",p.path):console.warn("Electronä¿å­˜å¯èƒ½å¤±è´¥:",(p==null?void 0:p.error)||"æœªçŸ¥é”™è¯¯")}if(console.log("æ›´æ–°å­˜æ¡£åˆ—è¡¨..."),g)this.saveList.unshift(m);else{const p=this.saveList.findIndex(f=>f.id===u);p!==-1&&(this.saveList[p]=m)}}catch(p){if(R(p,"saveSystem (persistence)",L.STORAGE,_.ERROR),console.error("ä¿å­˜æ¸¸æˆæ•°æ®æ—¶å‡ºé”™:",p),window.electronAPI&&window.electronAPI.saveGame){console.log("å°è¯•ä½¿ç”¨å¤‡ç”¨æ–¹æ³•ä¿å­˜æ¸¸æˆ...");const f=await window.electronAPI.saveGame({name:e,gameState:a});if(!f||!f.success)throw p;console.log("å·²ä½¿ç”¨å¤‡ç”¨æ–¹æ³•ä¿å­˜æ¸¸æˆ")}else throw p}if(t){const p=this.saveList.filter(f=>f.isAuto);if(p.length>Ce){const f=p.sort((y,k)=>y.timestamp-k.timestamp).slice(0,p.length-Ce);for(const y of f)await this.deleteSave(y.id,!0)}}return await X.setData(Ee,this.saveList),t||n.showToast({type:"success",message:g?"æ¸¸æˆå·²ä¿å­˜":"å­˜æ¡£å·²æ›´æ–°",duration:2e3}),t&&(this.lastAutoSaveWeek=r.currentWeek),{success:!0,saveId:u,isNewSave:g}},"saveGame",L.STORAGE,_.ERROR)},async loadGame(e){return De(async()=>{const t=K(),r=G(),i=B(),s=Z(),o=ke();try{this.lastValidatedSave=e;const n=await this.validateSave(e);if(n.success)await this.loadStoresFromSaveData(n.saveData);else{o.showToast({type:"warning",message:"å­˜æ¡£å¯èƒ½å·²æŸåï¼Œæ­£åœ¨å°è¯•ä¿®å¤...",duration:3e3});const c=await X.getData(`${be}${e}`);if(!c)return o.showToast({type:"error",message:"å­˜æ¡£æ•°æ®æ— æ³•è¯»å–ï¼Œæ— æ³•ä¿®å¤",duration:5e3}),this.isLoading=!1,{success:!1,message:"å­˜æ¡£æ•°æ®æ— æ³•è¯»å–"};const u=tt(c,this.saveTemplate),g=u.data;if(!Fe(g).isValid)return o.showToast({type:"error",message:"å­˜æ¡£æŸåä¸¥é‡ï¼Œæ— æ³•ä¿®å¤",duration:5e3}),this.isLoading=!1,{success:!1,message:"å­˜æ¡£æ— æ³•ä¿®å¤"};o.showToast({type:"success",message:`å­˜æ¡£å·²æˆåŠŸä¿®å¤ (${u.repairLog.length}é¡¹é—®é¢˜)`,duration:5e3}),await X.setData(`${be}${e}`,g),console.info("å·²ä¿å­˜ä¿®å¤åçš„å­˜æ¡£",g),await this.loadStoresFromSaveData(g)}const a=this.saveList.find(c=>c.id===e);return a&&(a.previewData={purchasedHouses:r.purchasedHouses.length,debt:r.debt,inventory:r.inventory.length,netWorth:r.netWorth},await X.setData(Ee,this.saveList)),this.isLoading=!1,{success:!0,message:"åŠ è½½æˆåŠŸ"}}catch(n){return R(n,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("åŠ è½½æ¸¸æˆå¤±è´¥",n),this.isLoading=!1,o.showToast({type:"error",message:"åŠ è½½å­˜æ¡£å¤±è´¥: "+n.message,duration:5e3}),{success:!1,error:n,message:"åŠ è½½å¤±è´¥: "+n.message}}},"loadGame",L.STORAGE,_.ERROR)},async loadStoresFromSaveData(e){const t=K(),r=G(),i=B(),s=Z();e=gr(e,he),e.gameCore&&(t.currentWeek=e.gameCore.currentWeek||1,t.maxWeeks=e.gameCore.maxWeeks||52,t.gameStarted=!!e.gameCore.gameStarted,t.gamePaused=!!e.gameCore.gamePaused,t.gameOver=!!e.gameCore.gameOver,t.gameResult=e.gameCore.gameResult||null,t.notifications=Array.isArray(e.gameCore.notifications)?e.gameCore.notifications:[],t.gameGoals=e.gameCore.gameGoals||{requiredNetWorth:4e5,targetWeeks:30,debtRatio:.4}),e.player&&(r.name=e.player.name||"ç©å®¶",r.money=e.player.money||5e3,r.debt=e.player.debt||2e3,r.capacity=e.player.capacity||100,r.inventoryUsed=e.player.inventoryUsed||0,r.inventory=Array.isArray(e.player.inventory)?e.player.inventory:[],r.purchasedHouses=Array.isArray(e.player.purchasedHouses)?e.player.purchasedHouses:[],r.statistics=e.player.statistics||{weekCount:e.gameCore.currentWeek||1,transactionCount:0,totalProfit:0,maxMoney:r.money,visitedLocations:[],housePurchases:[],firstHousePurchaseWeek:null}),e.market&&(i.locations=Array.isArray(e.market.locations)?e.market.locations:[],i.productPrices=e.market.productPrices||{},e.market.currentLocation&&i.locations.length>0?i.currentLocation=i.locations.find(o=>o.id===e.market.currentLocation)||i.locations[0]:i.locations.length>0&&(i.currentLocation=i.locations[0]),i.loadProducts(e.market.products||[]),i.loadHouses(e.market.houses||[]),i.marketModifiers=e.market.marketModifiers||{}),e.event&&(s.activeEvent=e.event.activeEvent||null,s.forceLocationChange=!!e.event.forceLocationChange,s.targetLocation=e.event.targetLocation||null,s.nextEventId=e.event.nextEventId||null,s.triggeredEvents=Array.isArray(e.event.triggeredEvents)?e.event.triggeredEvents:[])},async deleteSave(e,t=!1){return De(async()=>{const r=this.saveList.findIndex(i=>i.id===e);try{return await X.removeData(`${be}${e}`),r!==-1&&this.saveList.splice(r,1),await X.setData(Ee,this.saveList),t||ke().showToast({type:"success",message:"å­˜æ¡£å·²åˆ é™¤",duration:2e3}),!0}catch(i){return R(i,"saveSystem (persistence)",L.UNKNOWN,_.ERROR),console.error("åˆ é™¤å­˜æ¡£å¤±è´¥",i),t||ke().showToast({type:"error",message:"åˆ é™¤å­˜æ¡£å¤±è´¥: "+i.message,duration:5e3}),!1}},"deleteSave",L.STORAGE,_.WARNING)},async cleanupOldAutoSaves(){const e=this.saveList.filter(t=>t.isAuto);if(e.length>Ce){e.sort((t,r)=>r.timestamp-t.timestamp);for(let t=Ce;t<e.length;t++)await this.deleteSave(e[t].id,!0)}},async checkAutoSave(e){if(!this.autoSaveEnabled)return;const t=K();!t.gameStarted||t.gameOver||e>this.lastAutoSaveWeek&&e%vr===0&&await this.autoSave()},async autoSave(){const e=K();G();const t=`è‡ªåŠ¨å­˜æ¡£ (ç¬¬${e.currentWeek}å‘¨)`;await this.saveGame(t,!0),console.log(`è‡ªåŠ¨å­˜æ¡£å®Œæˆ: ${t}`)},async triggerImportantActionAutoSave(e){if(!this.autoSaveEnabled)return;const t=K();if(!t.gameStarted||t.gameOver)return;let r="";switch(e){case"house_purchase":r=`è´­æˆ¿å­˜æ¡£ (ç¬¬${t.currentWeek}å‘¨)`;break;case"major_transaction":r=`å¤§é¢äº¤æ˜“å­˜æ¡£ (ç¬¬${t.currentWeek}å‘¨)`;break;case"event_completed":r=`äº‹ä»¶å®Œæˆå­˜æ¡£ (ç¬¬${t.currentWeek}å‘¨)`;break;case"debt_repaid":r=`è¿˜æ¸…å€ºåŠ¡å­˜æ¡£ (ç¬¬${t.currentWeek}å‘¨)`;break;default:r=`é‡è¦æ“ä½œå­˜æ¡£ (ç¬¬${t.currentWeek}å‘¨)`}await this.saveGame(r,!0),console.log(`é‡è¦æ“ä½œè‡ªåŠ¨å­˜æ¡£å®Œæˆ: ${r}`)}},getters:{autoSaves(e){return e.saveList.filter(t=>t.isAuto).sort((t,r)=>r.timestamp-t.timestamp)},manualSaves(e){return e.saveList.filter(t=>!t.isAuto).sort((t,r)=>r.timestamp-t.timestamp)},latestSave(e){return e.saveList.length===0?null:e.saveList.sort((t,r)=>r.timestamp-t.timestamp)[0]}}}),wr=ce("gameCompat",()=>{const e=K(),t=G(),r=B(),i=Z(),s=Er(),o=ot(),n=$(()=>e.currentWeek),a=$(()=>e.maxWeeks),c=$(()=>e.gameStarted),u=$(()=>e.gamePaused),g=$(()=>e.gameOver),m=$(()=>e.gameResult),p=$(()=>e.notifications),f=$(()=>e.gameGoals),y=$(()=>e.gameProgress),k=$(()=>e.isGameActive),I=$(()=>t),b=$(()=>r.locations),S=$(()=>r.currentLocation),x=$(()=>r.productPrices),T=$(()=>r.products),A=$(()=>r.availableProducts),C=$(()=>r.houses),F=$(()=>r.marketModifiers),N=$(()=>i.currentEvent),V=$(()=>i.eventHistory);function ee(M){e.startNewGame(M)}function q(){return e.advanceWeek()}function ue(M){return r.changeLocation(M)}function le(){r.updateProductPrices(e.currentWeek)}function de(){r.updateLocationProducts(e.currentWeek)}function me(){i.generateRandomEvent(e.currentWeek)}function Me(M,w){var pe;const W=String(M),H=r.availableProducts.find(j=>String(j.id)===W);if(!H)return console.log("å•†å“ä¸å­˜åœ¨:",M,"å¯ç”¨å•†å“IDs:",r.availableProducts.map(j=>j.id)),{success:!1,message:"å•†å“ä¸å­˜åœ¨"};const U=(pe=r.productPrices[W])==null?void 0:pe.price;if(!U){console.log("ä»·æ ¼æœªå®šä¹‰:",M,"ä»·æ ¼åˆ—è¡¨keys:",Object.keys(r.productPrices));const j=H.basePrice||0;return j>0?(console.log("ä½¿ç”¨å•†å“åŸºæœ¬ä»·æ ¼:",j),xe(H,j,w)):{success:!1,message:"ä»·æ ¼æœªå®šä¹‰"}}const re=U*w;if(t.money<re)return{success:!1,message:"èµ„é‡‘ä¸è¶³"};const oe=o.addToInventory(H,w,U);return oe.success?(t.money-=re,t.statistics.transactionCount+=1,{success:!0}):oe}function Le(M,w){var Xe;if(!M||w<=0)return{success:!1,message:"æ— æ•ˆçš„å‚æ•°"};const W=String(M),H=t.inventory.find(se=>String(se.productId)===W);if(!H)return console.log("ç‰©å“ä¸å­˜åœ¨äºåº“å­˜ä¸­:",M,"åº“å­˜ç‰©å“IDs:",t.inventory.map(se=>se.productId)),{success:!1,message:"ç‰©å“ä¸å­˜åœ¨"};if(H.quantity<w)return{success:!1,message:"æ•°é‡ä¸è¶³"};const U=((Xe=r.productPrices[W])==null?void 0:Xe.price)||0;if(U<=0){console.log("å½“å‰å¸‚åœºä¸æ”¶è´­æ­¤ç‰©å“:",M,"ä»·æ ¼:",U);const se=r.products.find(mt=>String(mt.id)===W);return se&&se.basePrice>0?(console.log("ä½¿ç”¨å•†å“åŸºæœ¬ä»·æ ¼å‡ºå”®:",se.basePrice),z(H,se.basePrice,w)):{success:!1,message:"å½“å‰å¸‚åœºä¸æ”¶è´­æ­¤ç‰©å“"}}const re=U*w,oe=t.inventory.indexOf(H),j=H.purchasePrice*w,Je=o.removeFromInventory(oe,w);if(!Je.success)return{success:!1,message:"å‡ºå”®å¤±è´¥ï¼š"+Je.message};const Ge=re-j;return t.money+=re,t.statistics.totalProfit+=Ge,t.statistics.transactionCount+=1,{success:!0,income:re,profit:Ge,profitPercent:j>0?(Ge/j*100).toFixed(1):0}}function ye(M,w=!1){return s.saveGame(M,w)}function te(M){return s.loadGame(M)}function ve(){return s.getSaves()}function Ne(){e.checkGameEnd()}function Ie(M){var U;if(!M)return 0;const w=String(M),W=(U=r.productPrices[w])==null?void 0:U.price;if(W!=null)return W;const H=r.products.find(re=>String(re.id)===w);return H&&H.basePrice?H.basePrice:0}function Ae(M){return r.getProductPriceTrend(M)}function Re(M){return M<=0||M>t.money?{success:!1,message:"æ— æ•ˆçš„è¿˜æ¬¾é‡‘é¢"}:(M>t.debt&&(M=t.debt),t.money-=M,t.debt-=M,{success:!0,amountRepaid:M})}function we(M){const w=r.houses.find(W=>W.id===M);return w?t.money<w.price?{success:!1,message:"èµ„é‡‘ä¸è¶³"}:t.purchasedHouses.some(W=>W.houseId===M)?{success:!1,message:"å·²æ‹¥æœ‰æ­¤æˆ¿å±‹"}:(t.money-=w.price,t.purchasedHouses.push({houseId:w.id,name:w.name,purchasePrice:w.price,purchaseDate:new Date().toISOString()}),e.checkGameEnd(),{success:!0}):{success:!1,message:"æˆ¿å±‹ä¸å­˜åœ¨"}}function Oe(M,w){e.addNotification(M,w)}function xe(M,w,W){const H=w*W;if(t.money<H)return{success:!1,message:"èµ„é‡‘ä¸è¶³"};const U=o.addToInventory(M,W,w);return U.success?(t.money-=H,t.statistics.transactionCount+=1,{success:!0}):U}function z(M,w,W){const H=w*W,U=t.inventory.indexOf(M),oe=M.purchasePrice*W,pe=o.removeFromInventory(U,W);if(!pe.success)return{success:!1,message:"å‡ºå”®å¤±è´¥ï¼š"+pe.message};const j=H-oe;return t.money+=H,t.statistics.totalProfit+=j,t.statistics.transactionCount+=1,{success:!0,income:H,profit:j,profitPercent:oe>0?(j/oe*100).toFixed(1):0}}return{currentWeek:n,maxWeeks:a,gameStarted:c,gamePaused:u,gameOver:g,gameResult:m,notifications:p,gameGoals:f,gameProgress:y,isGameActive:k,player:I,locations:b,currentLocation:S,productPrices:x,products:T,availableProducts:A,houses:C,marketModifiers:F,currentEvent:N,eventHistory:V,startNewGame:ee,advanceWeek:q,changeLocation:ue,updateProductPrices:le,updateLocationProducts:de,generateRandomEvent:me,buyProduct:Me,sellProduct:Le,saveGame:ye,loadGame:te,getSaves:ve,checkGameEnd:Ne,getCurrentProductPrice:Ie,getProductPriceTrend:Ae,repayDebt:Re,buyHouse:we,addNotification:Oe}});export{Lr as A,Rr as B,_ as E,P,yt as _,L as a,Ht as b,wr as c,Z as d,ot as e,K as f,G as g,R as h,D as i,Ar as j,B as k,yr as l,ne as m,er as n,Ue as o,Nt as p,Er as q,Pr as r,Jt as s,Ot as t,ke as u,_r as v,Mr as w,Sr as x,Tt as y,Gt as z};
